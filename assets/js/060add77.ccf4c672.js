"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7811],{3905:(e,t,a)=>{a.d(t,{Zo:()=>h,kt:()=>m});var o=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,o,r=function(e,t){if(null==e)return{};var a,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)a=n[o],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)a=n[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=o.createContext({}),c=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},h=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var a=e.components,r=e.mdxType,n=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),u=c(a),p=r,m=u["".concat(l,".").concat(p)]||u[p]||d[p]||n;return a?o.createElement(m,i(i({ref:t},h),{},{components:a})):o.createElement(m,i({ref:t},h))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var n=a.length,i=new Array(n);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<n;c++)i[c]=a[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,a)}p.displayName="MDXCreateElement"},99265:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>n,metadata:()=>s,toc:()=>c});var o=a(87462),r=(a(67294),a(3905));const n={slug:"10-minutes-rugpull",title:"How to Spot a Potential Rug in 10 Minutes",authors:["ayden"],tags:["smart-contract-security","rug-pull","how-to"]},i=void 0,s={permalink:"/hashdit/blog/10-minutes-rugpull",source:"@site/blog/2022-09-24-10mins/2022-09-24-10mins.md",title:"How to Spot a Potential Rug in 10 Minutes",description:"Rugged. Rugged. Rugged.",date:"2022-09-24T00:00:00.000Z",formattedDate:"September 24, 2022",tags:[{label:"smart-contract-security",permalink:"/hashdit/blog/tags/smart-contract-security"},{label:"rug-pull",permalink:"/hashdit/blog/tags/rug-pull"},{label:"how-to",permalink:"/hashdit/blog/tags/how-to"}],readingTime:6.45,hasTruncateMarker:!1,authors:[{name:"Ayden Duan",title:"SCS@HashDit",url:"https://github.com/a4dyn",imageURL:"https://github.com/a4dyn.png",key:"ayden"}],frontMatter:{slug:"10-minutes-rugpull",title:"How to Spot a Potential Rug in 10 Minutes",authors:["ayden"],tags:["smart-contract-security","rug-pull","how-to"]},prevItem:{title:"Top 6 Most Popular Crypto Scams In 2022",permalink:"/hashdit/blog/top-6-crypto-scams-2022"}},l={authorsImageUrls:[void 0]},c=[{value:"Step 1: Verify the contract you are interacting with",id:"step-1-verify-the-contract-you-are-interacting-with",level:3},{value:"Step 2: Check the \u201cowner\u201d of contracts",id:"step-2-check-the-owner-of-contracts",level:3},{value:"Step 3: Check upgradable proxy &amp; Timelock duration",id:"step-3-check-upgradable-proxy--timelock-duration",level:3},{value:"Step 4: Check commonly evil features",id:"step-4-check-commonly-evil-features",level:3}],h={toc:c};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Rugged. Rugged. Rugged."),(0,r.kt)("p",null,"If you are a DeFi investor, you have definitely heard of these words. As newly DeFi projects mushroom to BSC chain each day, not all of them are good \u2014\u2014 be careful, they might steal your investment! According to the 200 most recently launched DeFi project analysis in RugDoc, 28% of them are tagged as \u201cHigh Risk\u201d, which means that they are highly likely to lead to catastrophic losses as they are right now, and 29% of them are marked as \u201cSome Risk\u201d that have ability to perform soft rug, and only 43% of them are \u201cLow Risk\u201d or \u201cNo Risk\u201d."),(0,r.kt)("p",null,"In other words, there is more than 28% probability that you lost all your the investment on DeFi project (if you randomly picked one!). Such lost maybe due to ignorance, credulous, or lack of learning. So, how do you control the risk of investment in DeFi and how to identify whether the project has a high likelihood of screwing you over? This article helps you to spot a potential rug DeFi project by following some simple steps, which only takes around 10 minutes. Remember, scammers are becoming smarter and smarter and they are able to disguise their project to make it look safe. So, even if you find a project with no obvious problem \u2014\u2014 proceed with caution!"),(0,r.kt)("h3",{id:"step-1-verify-the-contract-you-are-interacting-with"},"Step 1: Verify the contract you are interacting with"),(0,r.kt)("p",null,"When we enter a project\u2019s website, they may have a reference to which MasterChef contract you are interacting with. However, it might be a lie! The contract you are actually interacting with may be different to the one they posted on the website. To verify this, the most trustable way is to do a \u201ctest\u201d transaction: "),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-1",src:a(99153).Z,width:"1200",height:"918"})),(0,r.kt)("p",null,"Take MetaMask as an example, the contract you are actually interacting with is shown on the right corner. Copy it with a left click and check whether the contract address is the same as they show to you. Also make sure the contract source code is \u201cverified\u201d by BscScan (check whether there is a green mark above \u201cContract Name\u201d). "),(0,r.kt)("p",null,"(Verified contract has a green mark above \u201cContract Name\u201d)"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-2",src:a(78827).Z,width:"2719",height:"493"})),(0,r.kt)("h3",{id:"step-2-check-the-owner-of-contracts"},"Step 2: Check the \u201cowner\u201d of contracts"),(0,r.kt)("p",null,"In a DeFi project, the MasterChef contract is the one who manages most operations, and you can verify the MasterChef contract by following step 1. However, MasterChef is super-powerful, and should not be owned by a regular address. Honest developers will create a Timelock contract to own the MasterChef, and each write operation by the owner to MasterChef will be delayed for a period of time, giving you time to take your investment out if developers made any mistake. On the other hand, evil scammers try to own the MasterChef themselves \u2014\u2014 so that they can take away your money in a second. Usually, the ownership graph between each contract is shown as follows: "),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-3",src:a(78827).Z,width:"2719",height:"493"})),(0,r.kt)("p",null,"Such verification can be done by reading the contract variable and verifying the addresses on BscScan. Let\u2019s walk through this process with an example of PancakeSwap:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Find the PancakeSwap MasterChef (0x73feaa1ee314f8c655e354234017be2193c9e24e) on BscScan.com, and click on \u201cRead Contract\u201d. ")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-4",src:a(63727).Z,width:"1213",height:"195"})),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Find the \u201cowner\u201d variable of the MasterChef.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-5",src:a(55975).Z,width:"751",height:"159"})),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Click on the address link, and we found that it is a Timelock contract.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-6",src:a(58139).Z,width:"1209",height:"482"})),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Next, find the Token contract in MasterChef, the PancakeSwap token is named \u201ccake\u201d. This might vary from projects. ")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-7",src:a(53089).Z,width:"779",height:"143"})),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"Click on it, and find whether the owner of \u201ccake\u201d is the MasterChef contract we came from. ")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-8",src:a(21185).Z,width:"747",height:"132"})),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"Compare the addresses, they are the same! Meaning that the PancakeSwap project is safe (for now), Hoo-Yeah!")),(0,r.kt)("p",null,"Note: When checking the Timelock and Token contracts, make sure that they are \u201cverified\u201d by BscScan!"),(0,r.kt)("h3",{id:"step-3-check-upgradable-proxy--timelock-duration"},"Step 3: Check upgradable proxy & Timelock duration"),(0,r.kt)("p",null,"If a project\u2019s MasterChef uses \u201cupgradable proxy\u201d (if you don\u2019t know what is an upgradable proxy, Click Here), then its code is totally modifiable by its owners. For such powerful contract like MasterChef, you generally do not want it be easily changed \u2014\u2014 cause the developers may replace the original MasterChef with an evil one. Thus making sure the project\u2019s MasterChef do not use proxy is very important. When you clicking on the \u201cContract\u201d, you do NOT want to see these extra buttons: "),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-9",src:a(59249).Z,width:"1328",height:"204"})),(0,r.kt)("p",null,"The \u201cRead as Proxy\u201d and \u201cWrite as Proxy\u201d means that they are using upgradable proxy to deploy their contracts. It does not always mean the end of the world, but you would better ask the developers why did they do so \u2014\u2014 and they\u2019d better give a reasonable answer."),(0,r.kt)("p",null,"In the previous step, we told you to check the Timelock contract, but we also need to make sure that the Timelock is actually locking some \u201ctime\u201d! To verify this, we go to the \u201cRead Contract\u201d of Timelock: "),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"IMG-10",src:a(3935).Z,width:"1197",height:"1586"})),(0,r.kt)("p",null,"As you can see here, the minimum delay of this Timelock is 21600 seconds, which is 6 hours, and the current delay is set to 21700 seconds. This mean that the developers\u2019 action will be delayed for at least 6 hours before they take actual effects. Generally, you want the minimum delay time to be set above 6 hours \u2014\u2014 to not worry about your investments while you are asleep."),(0,r.kt)("h3",{id:"step-4-check-commonly-evil-features"},"Step 4: Check commonly evil features"),(0,r.kt)("p",null,"There can be lots of evil code hiding inside the contracts, and finding all of them is super time-consuming. Luckily, there are some commonly-used evil features by the scammers, and if you find the project you are about to invest contains one, or multiple of the following code, be careful, you might get rugged!"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"(High Risk) If they have the \u201cmigrate\u201d function in MasterChef. (Except PancakeSwap)"),(0,r.kt)("li",{parentName:"ul"},"(High Risk) Search \u201cfee => 10000\u201d and see if they have any fee up to 100%."),(0,r.kt)("li",{parentName:"ul"},"(High Risk) If they have \u201csetVaultAddress\u201d function in MasterChef."),(0,r.kt)("li",{parentName:"ul"},"(High Risk) Go to their website, check whether \u201cTotal Value Locked\u201d matches the sum up from their Liquidity Pools."),(0,r.kt)("li",{parentName:"ul"},"(Medium Risk) Check whether the number of \u201cpoolLength\u201d in MasterChef matches the actual pool numbers on their website."),(0,r.kt)("li",{parentName:"ul"},"(Medium Risk) If they have \u201cupdateStartBlock\u201d function in MasterChef, it might causes severe bug to the project if not used correctly."),(0,r.kt)("li",{parentName:"ul"},"(Medium Risk) If their code highly matched the Panther project (0x058451c62b96c594ad984370eda8b6fd7197bbd4), then proceed with caution because Panther itself have some \u201crisks\u201d due to operator privileges, and the newly started DeFi project are more tend to abuse them.")),(0,r.kt)("p",null,"Woo-hoo! You luckily find your target DeFi project \u201cpassed\u201d all the steps listed above and is going to dip into it\u2026. Wait a minute! Passing this 10-minute test does not mean that it is totally safe, if you want to invest your lifetime money into it, think twice! As I mentioned above, this guide only helps you to make sure that the project does not do an \u201cobvious rug\u201d, but what if the scammers are smart? Here are some extra assessments you can do to lower your risk:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check the top token holders of the project, they usually are the burn address or the staking contract."),(0,r.kt)("li",{parentName:"ul"},"Look deeper into the code and find if the dev is able to drain funds or unlimitedly emit new tokens to itself."),(0,r.kt)("li",{parentName:"ul"},"Track the transactions and ask dev team for any odd moves you found. Good dev will always give you space to ask questions."),(0,r.kt)("li",{parentName:"ul"},"Search on the twitter & any public rug scanning community about the project, if they have not done the review on it yet, submit a request."),(0,r.kt)("li",{parentName:"ul"},"Find whether the contract code has any audit. They\u2019d better have one or two paid audits to prove their code security."),(0,r.kt)("li",{parentName:"ul"},"Do not put all your eggs in one bucket, and never invest what you can\u2019t lose.")))}u.isMDXComponent=!0},99153:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-30-20-4308a81f76f3bbbb621ce2bb7c7ebb15.png"},78827:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-30-51-3c4c6ed5e2ef7c7235e7d035969e4e15.png"},63727:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-31-58-05521596b606f814498cfd2b8122feec.png"},55975:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-32-53-ae771648436feaaf4d528346c0df147f.png"},58139:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-33-41-969cffba4635ade5f5a769aef650e65e.png"},53089:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-34-41-aff04a1242c1ec719ada2c6ad505fee3.png"},21185:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-35-0-50503266096005efb169c9b0daacb72c.png"},59249:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-35-28-b9f14a2d7a3369cccc9d623b500972f4.png"},3935:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image_23-36-16-d8bfa482bbb1956fe3a75c8b48ca741e.png"}}]);