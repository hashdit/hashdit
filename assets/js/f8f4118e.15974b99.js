"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6437],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(a),u=i,h=d["".concat(l,".").concat(u)]||d[u]||m[u]||o;return a?n.createElement(h,r(r({ref:t},c),{},{components:a})):n.createElement(h,r({ref:t},c))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:i,r[1]=s;for(var p=2;p<o;p++)r[p]=a[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},17781:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var n=a(87462),i=(a(67294),a(3905));const o={slug:"monthly-incident-sharing-may-2024",title:"Monthly Incident Sharing - May 2024",authors:["Sebastian"],tags:["May","Incidents","Sharing",2024]},r=void 0,s={permalink:"/hashdit/blog/monthly-incident-sharing-may-2024",source:"@site/blog/2024-06-04/2024-06-04.md",title:"Monthly Incident Sharing - May 2024",description:"Introduction",date:"2024-06-04T00:00:00.000Z",formattedDate:"June 4, 2024",tags:[{label:"May",permalink:"/hashdit/blog/tags/may"},{label:"Incidents",permalink:"/hashdit/blog/tags/incidents"},{label:"Sharing",permalink:"/hashdit/blog/tags/sharing"},{label:"2024",permalink:"/hashdit/blog/tags/2024"}],readingTime:6.2,hasTruncateMarker:!1,authors:[{name:"Sebastian Lim",title:"SCS@HashDit",url:"https://github.com/slim115",imageURL:"https://github.com/slim115.png",key:"Sebastian"}],frontMatter:{slug:"monthly-incident-sharing-may-2024",title:"Monthly Incident Sharing - May 2024",authors:["Sebastian"],tags:["May","Incidents","Sharing","2024"]},prevItem:{title:"Monthly Incident Sharing - June 2024",permalink:"/hashdit/blog/monthly-incident-sharing-june-2024"},nextItem:{title:"Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain",permalink:"/hashdit/blog/bridge-scan-report"}},l={authorsImageUrls:[void 0]},p=[{value:"Introduction",id:"introduction",level:2},{value:"Top 5 DApps incidents",id:"top-5-dapps-incidents",level:2},{value:"GoGalaGames - $21.7m - Private Key Compromise",id:"gogalagames---217m---private-key-compromise",level:3},{value:"SonneFinance - $20m - Empty Market Attack",id:"sonnefinance---20m---empty-market-attack",level:3},{value:"ALEXLabBTC - $4.3m - Private Key Compromise",id:"alexlabbtc---43m---private-key-compromise",level:3},{value:"Pump.fun - $1.9m - Insider Attack",id:"pumpfun---19m---insider-attack",level:3},{value:"NORMIE - $800k - Price Manipulation",id:"normie---800k---price-manipulation",level:3},{value:"Key lessons for developers",id:"key-lessons-for-developers",level:2}],c={toc:p};function d(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,n.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{align:"justify"},(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this May 2024 edition, the total losses mounted up to $92.3 million, showing a 16% increase compared to May 2023. "),(0,i.kt)("p",null,"In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to."),(0,i.kt)("h2",{id:"top-5-dapps-incidents"},"Top 5 DApps incidents"),(0,i.kt)("h3",{id:"gogalagames---217m---private-key-compromise"},"GoGalaGames - $21.7m - Private Key Compromise"),(0,i.kt)("p",null,"GoGalaGames is a GameFi protocol that allows players to earn cryptocurrencies and non-fungible tokens (NFTs) through gameplay. In this incident, its minting role\u2019s private key was compromised, leading to a mint of 5,000,000,001 GALA tokens, an estimated loss of ~$222m on ETH. Interestingly, only a portion of GALA tokens were swapped for ETH, amounting to an estimate of 5913 ETH or $22m USD."),(0,i.kt)("p",null,"Thankfully, funds have since been returned and sent to an address termed as Gala Fund Recovery. Also, the excess GALA tokens have been burned. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The hacker was able to compromise the private key of the original Minter account. It is unclear if it was an internal or external attack."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0xa6d90abe17d17743a9cecab84bcefb0fd0bbfa0c61bba60fd2f680b0a2f077fe"},"Mint tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-1",src:a(79291).Z,width:"2172",height:"312"})),(0,i.kt)("h3",{id:"sonnefinance---20m---empty-market-attack"},"SonneFinance - $20m - Empty Market Attack"),(0,i.kt)("p",null,"Sonne Finance is a decentralized lending protocol for individuals, institutions and protocols to access financial services. It is a permissionless, open source and Optimistic protocol serving users on Optimism. Users can deposit their assets, use them as collateral and borrow against them. In this attack, the hacker made use of a mislapse in the protocol\u2019s market configuration to execute an empty market attack."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": Sonne was aware of the empty market bug, and planned to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"timelock add a market"),(0,i.kt)("li",{parentName:"ul"},"user add funds"),(0,i.kt)("li",{parentName:"ul"},"timelock open up the market for use.")),(0,i.kt)("p",null,"It would work, as long as the order was followed. However, they scheduled the supportMarket operation independently, instead of using scheduleBatch. Additionally, they opened the EXECUTOR_ROLE to everyone. This essentially allowed anyone to execute the operations in any order."),(0,i.kt)("p",null,"The exploited solVELO market was deployed 4 days ago without any liquidity, and added to the Unitroller 2 days later after timelock. As such, this empty market was abused with direct donation to borrow funds from other markets with liquidity.  "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://optimistic.etherscan.io/tx/0xb43748ed668c1e44cf0a3e829ca0fe24eceaee7d33d06072bb11ca99afa7f448"},"Hack tx 1")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://optimistic.etherscan.io/tx/0x9312ae377d7ebdf3c7c3a86f80514878deb5df51aad38b6191d55db53e42b7f0"},"Hack tx 2")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-2",src:a(5402).Z,width:"2160",height:"754"}),"\n",(0,i.kt)("img",{alt:"IMG-3",src:a(60778).Z,width:"1660",height:"1120"})),(0,i.kt)("h3",{id:"alexlabbtc---43m---private-key-compromise"},"ALEXLabBTC - $4.3m - Private Key Compromise"),(0,i.kt)("p",null,"On May 15, 2024, ALEXLabBTC, a DeFi project, had an unverified contract compromised, after a malicious upgrade. The potential loss was ~$12m, however the attacker was thankfully inexperienced. The attacker was successfully able to transfer around 13.8 million STX (~$2 million) on the Stack BTC layer-2 chain. "),(0,i.kt)("p",null,"However, on BSC where the potential damage was $4.3m, a white hat was able to secure funds, and eventually returned all 100% to the project team. On ETH, the exploiter tried to steal assets notionally worth around $5 million, but failed to do so. ALEX Lab later announced they were able to recover or secure around $4.5 million of those assets (through CEX)."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": Using compromised private keys obtained via a phishing attack. The exploiter was able to upgrade the code to a malicious logic contract and drain some assets from the ALEX protocol."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://bscscan.com/tx/0x47e123af93add709bc2516f6a5db057dfbb1d66a75b693cd7980cd3eb28c7357"},"Hack tx")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.bscscan.com/tx/0x55bb186c80834ffe00ac673b02fb1e70ac4fad56d4407afcf8bf4f1d716f579e"},"Malicious upgrade tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-4",src:a(26276).Z,width:"2310",height:"850"})),(0,i.kt)("h3",{id:"pumpfun---19m---insider-attack"},"Pump.fun - $1.9m - Insider Attack"),(0,i.kt)("p",null,"Pump.fun is a Solana Based Memecoin Launchpad that allows users to deploy their own Solana tokens. The incident involved a former employee gaining pump.fun's admin privileges, resulting in the misappropriation of approximately 12,300 SOL, valued around $1.9 million at the time."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": A former employee, illegitimately taken access of the withdraw authority using their privileged position at the company, used flash loans on a Solana lending protocol."),(0,i.kt)("p",null,"The loans were used to borrow SOL to buy out as many memecoins until they hit 100% on their bonding curves, which allowed the exploiter to gain liquidity to repay the flash loans. This affected roughly $1.9 million out of a total of $45 million in liquidity within the bonding curve contracts during a specific timeframe."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://solscan.io/tx/4i1BarkRVtU1RU7eaaTBKrbeDPPVD2D2LcyGFWu1tqCJUsGfkQc61YfsCWz1mQdhknjvP862EoGhs8dgpCVShoED"},"Hack tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-5",src:a(48403).Z,width:"1328",height:"894"})),(0,i.kt)("h3",{id:"normie---800k---price-manipulation"},"NORMIE - $800k - Price Manipulation"),(0,i.kt)("p",null,"On the 26th of May, 2024, the Base network suffered a damaging exploit targeted at the memecoin, NORMIE. Due to a vulnerability in the smart contract, there was an unfortunate loss of approximately 224.98 ETH."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The fundamental catalyst for the exploit was a flaw in the smart contract logic. This flaw granted the attacker the capability to trick the contract into acknowledging their address as a privileged one. This deceptive maneuver allowed them to mint tokens without authorization, circumventing crucial security measures, and consequently leading to a significant financial loss."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://basescan.org/tx/0xa618933a0e0ffd0b9f4f0835cc94e523d0941032821692c01aa96cd6f80fc3fd"},"Hack tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-6",src:a(93258).Z,width:"1314",height:"280"}),"\n",(0,i.kt)("img",{alt:"IMG-7",src:a(53377).Z,width:"1294",height:"370"})),(0,i.kt)("h2",{id:"key-lessons-for-developers"},"Key lessons for developers"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In light of potential insider compromises, it's crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Preference for certain platforms:")," Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Use of numbers:")," Both email addresses and Github usernames often contain numerical sequences. It's suspected they use this as a method for tracking the identities they impersonate.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Asian identities:")," There's a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Prominent educational background:")," The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Codebase theft:")," While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Multiple applications:")," They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Premature expertise:")," They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"To guard against price manipulation, it's essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here's how:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Set Boundaries:")," Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Fallback Oracle:")," Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Keys should be properly secured, are rotated regularly and have some level of decentralization. Adopt a ",(0,i.kt)("strong",{parentName:"p"},"zero-trust")," model. ")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"For projects utilizing lending protocols:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"When deploying a new market (especially for Compound / Aave v2 forks), ensure that it is first ",(0,i.kt)("strong",{parentName:"li"},"initialized with 0 Collateral Factor")," and ",(0,i.kt)("strong",{parentName:"li"},"deploy with small deposit to lock dead shares"),"."),(0,i.kt)("li",{parentName:"ul"},"Disallow deposits when the pool price is out of the base range of liquidity."),(0,i.kt)("li",{parentName:"ul"},"Increase precision on price change thresholds and deposit ratios."),(0,i.kt)("li",{parentName:"ul"},"For those allowing single-sided pool deposits, add a conditional statement to ",(0,i.kt)("strong",{parentName:"li"},"prevent deposits of any ratio of assets")," so long as vault is single-sided.")))),(0,i.kt)("p",null,"Feel free to contact us at ",(0,i.kt)("a",{parentName:"p",href:"mailto:support@hashdit.io"},"support@hashdit.io")," for any support needed! Stay safe!")))}d.isMDXComponent=!0},79291:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/1-f8343487a70d36fd7127bbcea4718661.png"},5402:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/2-10733d4f188adf37459b33ca33ed5b39.png"},60778:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/3-ff9fb31399ddb561be7a1e48584e9f55.png"},26276:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/4-dfaeb441be11b8e35fea3a17dbb0c864.png"},48403:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/5-a450da23c0d270fb4f461760884dcff8.png"},93258:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/6-9d28598704993ee0a39445212b1799bc.png"},53377:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/7-7686de921cb59a4c11cf6e2651ac067f.png"}}]);