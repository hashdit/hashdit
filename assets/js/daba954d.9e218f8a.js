"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6247],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(a),h=i,m=u["".concat(l,".").concat(h)]||u[h]||d[h]||o;return a?n.createElement(m,r(r({ref:t},c),{},{components:a})):n.createElement(m,r({ref:t},c))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:i,r[1]=s;for(var p=2;p<o;p++)r[p]=a[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},39947:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var n=a(87462),i=(a(67294),a(3905));const o={slug:"monthly-incident-sharing-june-2024",title:"Monthly Incident Sharing - June 2024",authors:["Sebastian"],tags:["June","Incidents","Sharing",2024]},r=void 0,s={permalink:"/hashdit/blog/monthly-incident-sharing-june-2024",source:"@site/blog/2024-07-17/2024-07-17.md",title:"Monthly Incident Sharing - June 2024",description:"Introduction",date:"2024-07-17T00:00:00.000Z",formattedDate:"July 17, 2024",tags:[{label:"June",permalink:"/hashdit/blog/tags/june"},{label:"Incidents",permalink:"/hashdit/blog/tags/incidents"},{label:"Sharing",permalink:"/hashdit/blog/tags/sharing"},{label:"2024",permalink:"/hashdit/blog/tags/2024"}],readingTime:7.01,hasTruncateMarker:!1,authors:[{name:"Sebastian Lim",title:"SCS@HashDit",url:"https://github.com/slim115",imageURL:"https://github.com/slim115.png",key:"Sebastian"}],frontMatter:{slug:"monthly-incident-sharing-june-2024",title:"Monthly Incident Sharing - June 2024",authors:["Sebastian"],tags:["June","Incidents","Sharing","2024"]},nextItem:{title:"Monthly Incident Sharing - May 2024",permalink:"/hashdit/blog/monthly-incident-sharing-may-2024"}},l={authorsImageUrls:[void 0]},p=[{value:"Introduction",id:"introduction",level:2},{value:"Top 5 DApps incidents",id:"top-5-dapps-incidents",level:2},{value:"Uwulend - $23.7m - Price Manipulation",id:"uwulend---237m---price-manipulation",level:3},{value:"Velocore - $6.8m - Lack of validation",id:"velocore---68m---lack-of-validation",level:3},{value:"Loopring - $5m - Social Engineering",id:"loopring---5m---social-engineering",level:3},{value:"Bazaar - $1.4m - Lack of Validation",id:"bazaar---14m---lack-of-validation",level:3},{value:"Holograph - $1.3m - Insider Attack",id:"holograph---13m---insider-attack",level:3},{value:"Key lessons for developers",id:"key-lessons-for-developers",level:2}],c={toc:p};function u(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,n.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{align:"justify"},(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this June 2024 edition, the total losses amounted to $56.4 million, showing a 276% increase compared to June 2023 ($15 million). "),(0,i.kt)("p",null,"In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to."),(0,i.kt)("h2",{id:"top-5-dapps-incidents"},"Top 5 DApps incidents"),(0,i.kt)("h3",{id:"uwulend---237m---price-manipulation"},"Uwulend - $23.7m - Price Manipulation"),(0,i.kt)("p",null,"Chain: Ethereum"),(0,i.kt)("p",null,"Uwulend is a DeFi protocol where users can participate as depositors, borrowers or LP stakers. Depositors provide liquidity to the market to earn a passive income, while borrowers are able to borrow in an overcollateralized (perpetually) fashion. On June 10 2024, in this incident, the Market contracts used an unreliable averaged-out oracle which resulted in an initial compromise of $20 million."),(0,i.kt)("p",null,"After the project paused and unpaused the protocol, they were once again exploited for another $3.7 million just 3 days later."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The price oracle used took 11 different prices, and used the median price as the price oracle. However, 5 of these prices were spot prices and directly under the control of the attacker. This meant that only one EMA price needed to be manipulated."),(0,i.kt)("p",null,"The second issue is that the input prices are in USDE, but the oracle output is in sUSDE, which currently trades around 1.08. The oracle converts between them with an owner controlled conversion factor. This conversion was set to 1.03 three months ago, and has been steadily more wrong over time as the price of sUSDE goes up with yield."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0x242a0fb4fde9de0dc2fd42e8db743cbc197ffa2bf6a036ba0bba303df296408b"},"Hack tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-1",src:a(70156).Z,width:"1544",height:"932"}),"\n",(0,i.kt)("img",{alt:"IMG-2",src:a(91527).Z,width:"1548",height:"494"})),(0,i.kt)("h3",{id:"velocore---68m---lack-of-validation"},"Velocore - $6.8m - Lack of validation"),(0,i.kt)("p",null,"Chain: Linea & Zksync"),(0,i.kt)("p",null,"On the 2nd of June, 2024, Velocore is a Layer-2 protocol that leverages ZK technology to enhance Ethereum scalability. Due to a Lack of validation vulnerability in the smart contract, Velocore experienced a security breach on June 2nd, 2024, resulting in financial losses approximating $6.8 million in ETH."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The root cause of this compromise was due to vulnerabilities within the Balancer-style CPMM pool contract, specifically the \u2018velocore__execute\u2019 function. The vulnerability here is that ",(0,i.kt)("inlineCode",{parentName:"p"},"effectiveFee1e9")," was allowed to exceed 100% - that is 1e18 (take note of the \u2018unchecked\u2019 block). This resulted in an underflow, changing a withdrawal into a large deposit."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://bscscan.com/tx/0x47e123af93add709bc2516f6a5db057dfbb1d66a75b693cd7980cd3eb28c7357"},"Hack tx")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.bscscan.com/tx/0x55bb186c80834ffe00ac673b02fb1e70ac4fad56d4407afcf8bf4f1d716f579e"},"Malicious upgrade tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-3",src:a(67378).Z,width:"1528",height:"414"}),"\n",(0,i.kt)("img",{alt:"IMG-4",src:a(83830).Z,width:"1546",height:"278"})),(0,i.kt)("h3",{id:"loopring---5m---social-engineering"},"Loopring - $5m - Social Engineering"),(0,i.kt)("p",null,"Chain: Ethereum"),(0,i.kt)("p",null,"Loopring is a zkRollup Layer 2. It allows for high-throughput, low-cost trading and payment on Ethereum. On June 9, 2024, in this attack, some Loopring Smart Wallets were targeted in a security breach. Subsequently, the attacker transferred assets out of the affected wallets. This resulted in a loss of approximately $5 million across the wallets."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The attack succeeded by compromising Loopring's 2FA service, allowing the hacker to impersonate the wallet owner (by obtaining the right signature) and gain approval for the Recovery from the Official Guardian."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0xf0a02e3dc32e380f5fbc832981963277f7b2ce9345040ddf1f3016724b84e251"},"Hack tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-5",src:a(98291).Z,width:"1534",height:"876"})),(0,i.kt)("h3",{id:"bazaar---14m---lack-of-validation"},"Bazaar - $1.4m - Lack of Validation"),(0,i.kt)("p",null,"Chain: Blast"),(0,i.kt)("p",null,"On June 10, 2024, Bazaar, a DeFi project, had its BazaarVaultBlast contract compromised, resulting in a loss of ~$1.4 million. In this attack, there was a lack of validation issue which allowed anyone to withdraw funds from the vulnerable contract."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The vulnerable function exitPool() did not validate its caller, which means that a malicious actor could invoke this method and parse another user\u2019s balance to withdraw their funds to himself."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blastscan.io/tx/0x7fdd140f7631f62d62f7256ee4a38af51a4723ad5d66adc9b9685bf78f750f2d"},"Hack tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-6",src:a(53836).Z,width:"1530",height:"660"})),(0,i.kt)("h3",{id:"holograph---13m---insider-attack"},"Holograph - $1.3m - Insider Attack"),(0,i.kt)("p",null,"Chain: Ethereum"),(0,i.kt)("p",null,"Holograph is an omnichain tokenization protocol, enabling asset issuers to mint natively composable omnichain tokens. On June 13, 2024, the incident involved a misused HLG created on Mantle that was activated through Layerzero bridge. There was a Falsified packet that was executed on Mantle which resulted in a large mint of 1 billion HLG tokens on Ethereum, valued around $1.3 million at the time."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": It was a private key compromise that was later on confirmed by Holograph, this was an insider attack. A former contractor exploited Holograph Protocol to mint additional HLG. The malicious actor deployed an unverified contract on Mantle, which was used to mint additional HLG."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0x0cc143ccf3316d47b36a2e45577922f4ebe2374966bb22c1e9cf49c747d46396"},"Large mint tx")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://explorer.mantle.xyz/tx/0x845dafdac3d55238e8cf005ae2daaac5f651ff4b3eaf56945377a7f6c8366449"},"Mantle packet tx")),(0,i.kt)("p",null,"Transaction snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-7",src:a(6811).Z,width:"1528",height:"948"})),(0,i.kt)("h2",{id:"key-lessons-for-developers"},"Key lessons for developers"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In light of potential insider compromises, it's crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Preference for certain platforms:")," Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Use of numbers:")," Both email addresses and Github usernames often contain numerical sequences. It's suspected they use this as a method for tracking the identities they impersonate.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Asian identities:")," There's a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Prominent educational background:")," The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Codebase theft:")," While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Multiple applications:")," They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Premature expertise:")," They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"To guard against price manipulation, it's essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here's how:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Set Boundaries:")," Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Fallback Oracle:")," Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Input validation is a crucial process - it's essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Calldata Parameters:")," Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"User Approvals:")," During the process where the protocol contract manages users' approvals, meticulous input checks are paramount to prevent potential malicious activities.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Here are five key tips to protect against social engineering attacks that compromise 2FA for Web3 protocol teams:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Educate and Train Team Members")," "),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Awareness Programs"),": Regularly conduct training sessions to educate team members about the various types of social engineering attacks, such as phishing, vishing (voice phishing), and smishing (SMS phishing).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Simulated Attacks"),": Perform simulated social engineering attacks to test and improve the team's response to real threats.")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Use Strong 2FA Mechanisms")," "),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Hardware Tokens"),": Encourage the use of hardware-based 2FA tokens (e.g., YubiKey) instead of SMS-based 2FA, which is more susceptible to SIM swapping attacks.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"App-Based 2FA"),": If hardware tokens are not feasible, use app-based 2FA solutions like Google Authenticator or Authy, which are more secure than SMS."))))))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"* **Monitor and Respond to Suspicious Activity** \n\n    * **Anomaly Detection**: Implement systems to detect and alert on unusual login attempts or behavior that could indicate a compromised account.\n\n    * **Immediate Response**: Have a clear incident response plan in place to quickly address and mitigate any suspected social engineering attacks.\n\n* **Secure Communication Channels** \n\n    * **Encrypted Communication**: Use encrypted communication channels for sensitive information and authentication processes.\n\n    * **Verification Protocols**: Establish protocols for verifying the identity of individuals before sharing sensitive information or performing critical actions.\n\n* **Limit Access and Permissions** \n\n    * **Role-Based Access Control (RBAC)**: Implement RBAC to ensure that team members only have access to the information and systems necessary for their role.\n\n    * **Regular Audits**: Conduct regular audits of access permissions to ensure they are up-to-date and appropriate.\n")),(0,i.kt)("p",null,"Feel free to contact us at ",(0,i.kt)("a",{parentName:"p",href:"mailto:support@hashdit.io"},"support@hashdit.io")," for any support needed! Stay safe!")))}u.isMDXComponent=!0},70156:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/1-521d400b06eb25a80b027e079131f900.png"},91527:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/2-e9e353765ca1157e84369ad14d35c857.png"},98291:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/3-8d76f9de0fa69e36494aaed992946d18.png"},53836:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/4-98059fd9b431f8f4353aec2aa9755ae4.png"},6811:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/5-a80dd64e6f4b8191d0af5338b04f7fdc.png"},67378:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/6-6d6192dc3c4971ece4857bc657dca424.png"},83830:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/7-dd63cc89045ad53f9372f219bc262f16.png"}}]);