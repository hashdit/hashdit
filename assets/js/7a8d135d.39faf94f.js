"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2274],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(a),h=i,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||r;return a?n.createElement(m,o(o({ref:t},p),{},{components:a})):n.createElement(m,o({ref:t},p))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},89626:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=a(87462),i=(a(67294),a(3905));const r={slug:"monthly-incident-sharing-july-2024",title:"Monthly Incident Sharing - July 2024",authors:["Sebastian"],tags:["July","Incidents","Sharing",2024]},o=void 0,s={permalink:"/hashdit/blog/monthly-incident-sharing-july-2024",source:"@site/blog/2024-08-07/2024-08-7.md",title:"Monthly Incident Sharing - July 2024",description:"Introduction",date:"2024-08-07T00:00:00.000Z",formattedDate:"August 7, 2024",tags:[{label:"July",permalink:"/hashdit/blog/tags/july"},{label:"Incidents",permalink:"/hashdit/blog/tags/incidents"},{label:"Sharing",permalink:"/hashdit/blog/tags/sharing"},{label:"2024",permalink:"/hashdit/blog/tags/2024"}],readingTime:6.765,hasTruncateMarker:!1,authors:[{name:"Sebastian Lim",title:"SCS@HashDit",url:"https://github.com/slim115",imageURL:"https://github.com/slim115.png",key:"Sebastian"}],frontMatter:{slug:"monthly-incident-sharing-july-2024",title:"Monthly Incident Sharing - July 2024",authors:["Sebastian"],tags:["July","Incidents","Sharing","2024"]},nextItem:{title:"2024 H1 BSC Security Report",permalink:"/hashdit/blog/bsc-2024-half-year-report"}},l={authorsImageUrls:[void 0]},c=[{value:"Introduction",id:"introduction",level:2},{value:"Top 5 DApps incidents",id:"top-5-dapps-incidents",level:2},{value:"Li.Fi protocol - $10m - Lack of Validation",id:"lifi-protocol---10m---lack-of-validation",level:3},{value:"Rho Markets - $7.6m - Oracle Manipulation",id:"rho-markets---76m---oracle-manipulation",level:3},{value:"DoughFina - $1.8m - Lack of Validation",id:"doughfina---18m---lack-of-validation",level:3},{value:"Minterest - $1.4m - Exchange rate manipulation",id:"minterest---14m---exchange-rate-manipulation",level:3},{value:"Monoswap - $1.3m - Social Engineering",id:"monoswap---13m---social-engineering",level:3},{value:"Key lessons for developers",id:"key-lessons-for-developers",level:2}],p={toc:c};function d(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{align:"justify"},(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this July 2024 edition, the total losses amounted to $282.5 million, showing a 25% decrease compared to July 2023 ($377.2 million). "),(0,i.kt)("p",null,"In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to."),(0,i.kt)("h2",{id:"top-5-dapps-incidents"},"Top 5 DApps incidents"),(0,i.kt)("h3",{id:"lifi-protocol---10m---lack-of-validation"},"Li.Fi protocol - $10m - Lack of Validation"),(0,i.kt)("p",null,"Chain: Ethereum"),(0,i.kt)("p",null,"Li.Fi protocol is a bridge aggregation protocol with DEX connectivity and cross-chain data messaging capabilities. On July 16 2024, in this incident, the GasZipFacet contract was upgraded, introducing a vulnerable code which resulted in a compromise of approximately $10 million."),(0,i.kt)("p",null,"Interestingly, a similar exploit 2 years ago, when Li.Fi was also compromised for the same vulnerability. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The primary cause of the incident was no validation of swapCallData in the LibSwap.sol library. This calldata can be externally controlled in the outer function depositToGasZipERC20 method. This allows arbitrary calls whereby funds approved to this victim contract can be abused and stolen."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0x602d810c47a9022b422cf2fa32ec973f887a72df78d40e448d511e82eba5a38a"},"Hack tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-1",src:a(27628).Z,width:"1752",height:"1054"}),"\n",(0,i.kt)("img",{alt:"IMG-2",src:a(45352).Z,width:"1732",height:"1176"})),(0,i.kt)("h3",{id:"rho-markets---76m---oracle-manipulation"},"Rho Markets - $7.6m - Oracle Manipulation"),(0,i.kt)("p",null,"Chain: Scroll"),(0,i.kt)("p",null,"Rho Markets is a liquidity platform built on Scroll, based on an overcollateralized lending model (which is a fork of Compound Finance). On July 19, 2024, in this incident, a misconfigured oracle provided the wrong price of $ETH for the rETH market ($BTC price was fed instead). Thankfully, an MEV bot front ran the original hacker and was able to safeguard the $7.6 million and return them back to the project party."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": On July 16, 2024, after updating the smart contract for a new market, Rho Markets found that ETH and BTC price oracles were giving contradictory feeds due to a deployment script misconfiguration. This reversed BTC and ETH prices, creating arbitrage opportunities for MEV bots. Incorrect oracle pricing led to assets(USDC, USDT, wstETH, STONE, and wrsETH) being borrowed up to their caps. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://scrollscan.com/tx/0x30879b0dbee84ba41aa1fc6ef71e81a8985bf8509796ca45f30ec4640b338db4"},"Oracle misconfiguration tx")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://scrollscan.com/tx/0x0a7b4c6542eb8f37de788c8848324c0ae002919148a4426903b0fb4149f88f05"},"Hack tx")),(0,i.kt)("p",null,"Transaction snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-3",src:a(64197).Z,width:"2694",height:"1020"})),(0,i.kt)("h3",{id:"doughfina---18m---lack-of-validation"},"DoughFina - $1.8m - Lack of Validation"),(0,i.kt)("p",null,"Chain: Ethereum"),(0,i.kt)("p",null,"On July 12, 2024, DoughFina, a DeFi project, had its ConnectorDeleverageParaswap contract compromised, resulting in a loss of ~$1.8 million. In this attack, there was a lack of validation issue which allowed anyone to withdraw funds from the vulnerable contract."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The primary cause of the incident was that there is lack of validation in the flash loan call back data which leads to a WETH transfer."),(0,i.kt)("p",null,"After invoking the flashloan method of the ConnectorDeleverageParaswap contract, the flash loan call data allowed multiple operations to be executed afterwards."),(0,i.kt)("p",null,"This allowed the hacker to burn AaveWETH from one of Dough\u2019s pools. WETH is then approved to the Victim contract which can then be transferred from out to the hacker."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0x92cdcc732eebf47200ea56123716e337f6ef7d5ad714a2295794fdc6031ebb2e"},"Hack tx 1")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0x28a934816ed0371a3fbb2f89986eecf87a22937c40309ff2f58697792215b4da"},"Hack tx 2")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-4",src:a(63790).Z,width:"2442",height:"438"}),"\n",(0,i.kt)("img",{alt:"IMG-5",src:a(50761).Z,width:"2424",height:"970"})),(0,i.kt)("h3",{id:"minterest---14m---exchange-rate-manipulation"},"Minterest - $1.4m - Exchange rate manipulation"),(0,i.kt)("p",null,"Chain: Mantle"),(0,i.kt)("p",null,"Minterest is a blockchain cross-chain DeFi lending protocol that redistributes 100% of the value captured back to users. On July 15, 2024, its MUSDYToken_Mantle contract was compromised, leading to an estimate loss of ~$1.4m on Mantle (ETH and Taiko not affected)."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The exchange rate of the Minterest is dependent on the token cash balance (updated immediately during token transfers, instead of at the end of the state)."),(0,i.kt)("p",null,"Reentrancy vulnerability in which an attacker could loan out tokens that they had previously just borrowed from the protocol."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://explorer.mantle.xyz/tx/0xb3c4c313a8d3e2843c9e6e313b199d7339211cdc70c2eca9f4d88b1e155fd6bd"},"Hack tx")),(0,i.kt)("p",null,"Code snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-6",src:a(91049).Z,width:"2596",height:"614"})),(0,i.kt)("h3",{id:"monoswap---13m---social-engineering"},"Monoswap - $1.3m - Social Engineering"),(0,i.kt)("p",null,"Chain: Blast"),(0,i.kt)("p",null,"Monoswap is a community-driven and yield-focused v3 Decentralized Exchange built to facilitate the Blast ecosystem.. On the 24th of July, 2024, due to a social engineering exploit of one of its developers, the deployer wallet was compromised, resulting in financial losses approximating $1.3 million in ETH. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": One of Monoswap developers installed phishing software from https","[:]","//kakaocall","[.]","kr. The scammer pretended to be a VC institution to deceive the developer's trust and carried out phishing attacks."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blastscan.io/tx/0xc78fdbaa98e7652a3495df6fcdb5797d8ecf949e014b11c72fe1421e3f806272"},"Hack tx 1")," "),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blastscan.io/tx/0x348bee9fb6ceb6512f7b095702f6e0616870b7c1befbe94c5e42a86b48eaa9c7"},"Hack tx 2")," "),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blastscan.io/tx/0x430efd649ef7a5273f2fa084dc330d1326766a4811e2c35d568a83bd0bc9bfd8"},"Hack tx 3")),(0,i.kt)("p",null,"Transaction snippet:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-7",src:a(41541).Z,width:"2730",height:"350"})),(0,i.kt)("h2",{id:"key-lessons-for-developers"},"Key lessons for developers"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Given the risk of social engineering attacks, it is essential for employees to install only trusted software and exercise heightened caution when working with third parties. Specifically, be vigilant for potential red flags, including:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Educate and Train Team Members:")," "),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Awareness Programs"),": Regularly conduct training sessions to educate team members about the various types of social engineering attacks, such as phishing, vishing (voice phishing), and smishing (SMS phishing).")))))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    * **Simulated Attacks**: Perform simulated social engineering attacks to test and improve the team's response to real threats.\n\n    * **Trusted Software**: Always verify the source before installing any software. Ensure that you download applications only from official websites or trusted platforms, and avoid using pirated or cracked versions. Additionally, check for reviews and ratings, and consult with your IT department if you are unsure about the legitimacy of the software.\n\n\n* **Secure Communication Channels:** \n\n    * **Encrypted Communication**: Use encrypted communication channels for sensitive information and authentication processes.\n\n    * **Verification Protocols**: Establish protocols for verifying the identity of individuals before sharing sensitive information or performing critical actions.\n\n\n* **Limit Access and Permissions:** \n\n    * **Role-Based Access Control (RBAC)**: Implement RBAC to ensure that team members only have access to the information and systems necessary for their role.\n\n    * **Regular Audits**: Conduct regular audits of access permissions to ensure they are up-to-date and appropriate.\n")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Input validation is a crucial process - it's essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Calldata Parameters:")," Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"User Approvals:")," During the process where the protocol contract manages users' approvals, meticulous input checks are paramount to prevent potential malicious activities.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"To guard against price manipulation, it's essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here's how:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Set Boundaries"),": Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Fallback Oracle"),": Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Test scripts"),": Test scripts can be designed to check the integrity of the data being fed into the Oracle system. By running these scripts, you can ensure that the data is accurate, complete, and consistent with the expected format and values. This helps in identifying and correcting any discrepancies early in the process."))))),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Tips to Prevent Exchange Rate Manipulation:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Educate and Train Team Members:")," Use multiple, independent oracle sources to fetch exchange rates. Aggregating data from various sources can help ensure accuracy and reduce the risk of manipulation from a single compromised source.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Use Strong 2FA Mechanisms:")," Implement validation checks to ensure the consistency and accuracy of exchange rate data. Cross-verify rates with other reliable sources to detect anomalies.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Monitor and Respond to Suspicious Activity:")," Ensure that exchange rate data is transmitted securely using encryption protocols. This helps prevent interception and tampering of data during transmission.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Secure Communication Channels:"),"  In the context of exchange rate systems, a reentrancy attack could be particularly damaging. For example, if an exchange rate contract is vulnerable to reentrancy, an attacker could exploit this to manipulate the exchange rates."),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Checks-Effects-Interactions Pattern:")," Ensure that state changes are made before any external calls. This reduces the risk of reentrancy attacks.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Reentrancy Guards:")," Implement reentrancy guards, such as mutexes, to prevent multiple calls to a function before the first call is resolved."))))))),(0,i.kt)("p",null,"Feel free to contact us at ",(0,i.kt)("a",{parentName:"p",href:"mailto:support@hashdit.io"},"support@hashdit.io")," for any support needed! Stay safe!")))}d.isMDXComponent=!0},27628:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/1-557e331aa80bbb5c2b3da78ba59eb848.png"},45352:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/2-a985904a623bc62348a5afb6e1c293b2.png"},64197:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/3-88f0bb98090109b2cc16adaf58a2bf1b.png"},63790:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/4-ef034d503034ce87790b80a33d4fb802.png"},50761:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/5-66a9c09abd385750549545ae979fed40.png"},91049:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/6-f8b66ba4df3f76d4e70fc614fc70a4fc.png"},41541:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/7-f4841e020510bef8406699d2ec4c5b5b.png"}}]);