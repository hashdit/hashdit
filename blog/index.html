<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Blog | HashDit</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hashdit.github.io/hashdit/blog"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | HashDit"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/hashdit/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hashdit.github.io/hashdit/blog"><link data-rh="true" rel="alternate" href="https://hashdit.github.io/hashdit/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://hashdit.github.io/hashdit/blog" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/hashdit/blog/rss.xml" title="HashDit RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/hashdit/blog/atom.xml" title="HashDit Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XST5Y5VMG3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XST5Y5VMG3",{anonymize_ip:!0})</script><link rel="stylesheet" href="/hashdit/assets/css/styles.22075f5b.css">
<link rel="preload" href="/hashdit/assets/js/runtime~main.9a124b34.js" as="script">
<link rel="preload" href="/hashdit/assets/js/main.383d5b0f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/hashdit/"><div class="navbar__logo"><img src="/hashdit/img/favicon.ico" alt="HashDit Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/hashdit/img/favicon.ico" alt="HashDit Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">HashDit</b></a><a class="navbar__item navbar__link" href="/hashdit/docs/intro">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hashdit/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hashdit/hashdit/tree/main" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-june-2024">Monthly Incident Sharing - June 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-may-2024">Monthly Incident Sharing - May 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bridge-scan-report">Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/hashdit-snaps-guide">Getting Started with HashDit Snaps - A Step-by-Step Guide</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-apr-2024">Monthly Incident Sharing - April 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-mar-2024">Monthly Incident Sharing - March 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/meme-education-guide">Meme Education Guide</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-feb-2024">Monthly Incident Sharing - February 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/api-integration">HashDit API Integration</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-jan-2024">Monthly Incident Sharing - January 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/twitter-compromise">Twitter Compromise Security Blog</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/2023-Top10-Incidents">2023 Top 10 Security Incidents</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-16Nov2023">PancakeSwap November 16th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-09Nov2023">PancakeSwap November 9th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-02Nov2023">PancakeSwap November 2nd Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-26Oct2023">PancakeSwap October 26th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-19Oct2023">PancakeSwap October 19th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/Gas-Mint-Scam-2023">Gas Mint Scam (Updated!)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-05Oct2023">PancakeSwap October 5th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/The-Trend-of-Hot–Wallet-Compromises">An In-depth Security Analysis ---- The Trend of Hot Wallet Compromises</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-28Sep2023">PancakeSwap September 28th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-21Sep2023">PancakeSwap September 21st Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/Layer2-Security-Report">Security First in opBNB, Learnt from Layer 2 Incidents</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-14Sep2023">PancakeSwap September 14th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-07Sep2023">PancakeSwap September 7th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/BSC-August-Security-Report">BNB Smart Chain Monthly Incident Report August 2023 - 60% drop of total incident amounts</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-31Aug2023">PancakeSwap August 31st Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/ponzi-schemes-in-web3">Ponzi Schemes in Web3 ---- Swamps in the Dark</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-24Aug2023">PancakeSwap August 24th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bsc-2023-half-year-report">2023 H1 BSC Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/zero-knowledge-proof-and-its-application-in-blockchain">Zero-Knowledge Proof and Its Application in Blockchain</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/smart-wallet-migration-guide">Multisig Wallet Migration Guide</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/The-risks-and-future-of-crypto-wallets">The Risks and Future of Crypto Wallets</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bsc-2022-end-of-year-report">2022 End of Year BSC Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/repackaged-apps-are-harmful">Repackaged Apps are harmful</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/top-6-crypto-scams-2022">Top 6 Most Popular Crypto Scams In 2022</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/10-minutes-rugpull">How to Spot a Potential Rug in 10 Minutes</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-june-2024">Monthly Incident Sharing - June 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-07-17T00:00:00.000Z" itemprop="datePublished">July 17, 2024</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this June 2024 edition, the total losses amounted to $56.4 million, showing a 276% increase compared to June 2023 ($15 million). </p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="uwulend---237m---price-manipulation">Uwulend - $23.7m - Price Manipulation<a href="#uwulend---237m---price-manipulation" class="hash-link" aria-label="Direct link to Uwulend - $23.7m - Price Manipulation" title="Direct link to Uwulend - $23.7m - Price Manipulation">​</a></h3><p>Chain: Ethereum</p><p>Uwulend is a DeFi protocol where users can participate as depositors, borrowers or LP stakers. Depositors provide liquidity to the market to earn a passive income, while borrowers are able to borrow in an overcollateralized (perpetually) fashion. On June 10 2024, in this incident, the Market contracts used an unreliable averaged-out oracle which resulted in an initial compromise of $20 million.</p><p>After the project paused and unpaused the protocol, they were once again exploited for another $3.7 million just 3 days later.</p><p><strong>Root cause</strong>: The price oracle used took 11 different prices, and used the median price as the price oracle. However, 5 of these prices were spot prices and directly under the control of the attacker. This meant that only one EMA price needed to be manipulated.</p><p>The second issue is that the input prices are in USDE, but the oracle output is in sUSDE, which currently trades around 1.08. The oracle converts between them with an owner controlled conversion factor. This conversion was set to 1.03 three months ago, and has been steadily more wrong over time as the price of sUSDE goes up with yield.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x242a0fb4fde9de0dc2fd42e8db743cbc197ffa2bf6a036ba0bba303df296408b" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-521d400b06eb25a80b027e079131f900.png" width="1544" height="932" class="img_ev3q">
<img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-e9e353765ca1157e84369ad14d35c857.png" width="1548" height="494" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="velocore---68m---lack-of-validation">Velocore - $6.8m - Lack of validation<a href="#velocore---68m---lack-of-validation" class="hash-link" aria-label="Direct link to Velocore - $6.8m - Lack of validation" title="Direct link to Velocore - $6.8m - Lack of validation">​</a></h3><p>Chain: Linea &amp; Zksync</p><p>On the 2nd of June, 2024, Velocore is a Layer-2 protocol that leverages ZK technology to enhance Ethereum scalability. Due to a Lack of validation vulnerability in the smart contract, Velocore experienced a security breach on June 2nd, 2024, resulting in financial losses approximating $6.8 million in ETH.</p><p><strong>Root cause</strong>: The root cause of this compromise was due to vulnerabilities within the Balancer-style CPMM pool contract, specifically the ‘velocore__execute’ function. The vulnerability here is that <code>effectiveFee1e9</code> was allowed to exceed 100% - that is 1e18 (take note of the ‘unchecked’ block). This resulted in an underflow, changing a withdrawal into a large deposit.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x47e123af93add709bc2516f6a5db057dfbb1d66a75b693cd7980cd3eb28c7357" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><a href="https://www.bscscan.com/tx/0x55bb186c80834ffe00ac673b02fb1e70ac4fad56d4407afcf8bf4f1d716f579e" target="_blank" rel="noopener noreferrer">Malicious upgrade tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/6-6d6192dc3c4971ece4857bc657dca424.png" width="1528" height="414" class="img_ev3q">
<img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/7-dd63cc89045ad53f9372f219bc262f16.png" width="1546" height="278" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loopring---5m---social-engineering">Loopring - $5m - Social Engineering<a href="#loopring---5m---social-engineering" class="hash-link" aria-label="Direct link to Loopring - $5m - Social Engineering" title="Direct link to Loopring - $5m - Social Engineering">​</a></h3><p>Chain: Ethereum</p><p>Loopring is a zkRollup Layer 2. It allows for high-throughput, low-cost trading and payment on Ethereum. On June 9, 2024, in this attack, some Loopring Smart Wallets were targeted in a security breach. Subsequently, the attacker transferred assets out of the affected wallets. This resulted in a loss of approximately $5 million across the wallets.</p><p><strong>Root cause</strong>: The attack succeeded by compromising Loopring&#x27;s 2FA service, allowing the hacker to impersonate the wallet owner (by obtaining the right signature) and gain approval for the Recovery from the Official Guardian.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0xf0a02e3dc32e380f5fbc832981963277f7b2ce9345040ddf1f3016724b84e251" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/3-8d76f9de0fa69e36494aaed992946d18.png" width="1534" height="876" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bazaar---14m---lack-of-validation">Bazaar - $1.4m - Lack of Validation<a href="#bazaar---14m---lack-of-validation" class="hash-link" aria-label="Direct link to Bazaar - $1.4m - Lack of Validation" title="Direct link to Bazaar - $1.4m - Lack of Validation">​</a></h3><p>Chain: Blast</p><p>On June 10, 2024, Bazaar, a DeFi project, had its BazaarVaultBlast contract compromised, resulting in a loss of ~$1.4 million. In this attack, there was a lack of validation issue which allowed anyone to withdraw funds from the vulnerable contract.</p><p><strong>Root cause</strong>: The vulnerable function exitPool() did not validate its caller, which means that a malicious actor could invoke this method and parse another user’s balance to withdraw their funds to himself.</p><p><strong>Onchain information</strong>:</p><p><a href="https://blastscan.io/tx/0x7fdd140f7631f62d62f7256ee4a38af51a4723ad5d66adc9b9685bf78f750f2d" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/4-98059fd9b431f8f4353aec2aa9755ae4.png" width="1530" height="660" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="holograph---13m---insider-attack">Holograph - $1.3m - Insider Attack<a href="#holograph---13m---insider-attack" class="hash-link" aria-label="Direct link to Holograph - $1.3m - Insider Attack" title="Direct link to Holograph - $1.3m - Insider Attack">​</a></h3><p>Chain: Ethereum</p><p>Holograph is an omnichain tokenization protocol, enabling asset issuers to mint natively composable omnichain tokens. On June 13, 2024, the incident involved a misused HLG created on Mantle that was activated through Layerzero bridge. There was a Falsified packet that was executed on Mantle which resulted in a large mint of 1 billion HLG tokens on Ethereum, valued around $1.3 million at the time.</p><p><strong>Root cause</strong>: It was a private key compromise that was later on confirmed by Holograph, this was an insider attack. A former contractor exploited Holograph Protocol to mint additional HLG. The malicious actor deployed an unverified contract on Mantle, which was used to mint additional HLG.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x0cc143ccf3316d47b36a2e45577922f4ebe2374966bb22c1e9cf49c747d46396" target="_blank" rel="noopener noreferrer">Large mint tx</a></p><p><a href="https://explorer.mantle.xyz/tx/0x845dafdac3d55238e8cf005ae2daaac5f651ff4b3eaf56945377a7f6c8366449" target="_blank" rel="noopener noreferrer">Mantle packet tx</a></p><p>Transaction snippet:</p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/5-a80dd64e6f4b8191d0af5338b04f7fdc.png" width="1528" height="948" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>In light of potential insider compromises, it&#x27;s crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:</p><ul><li><p><strong>Preference for certain platforms:</strong> Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.</p></li><li><p><strong>Use of numbers:</strong> Both email addresses and Github usernames often contain numerical sequences. It&#x27;s suspected they use this as a method for tracking the identities they impersonate.</p></li><li><p><strong>Asian identities:</strong> There&#x27;s a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.</p></li><li><p><strong>Prominent educational background:</strong> The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.</p></li><li><p><strong>Codebase theft:</strong> While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.</p></li><li><p><strong>Multiple applications:</strong> They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.</p></li><li><p><strong>Premature expertise:</strong> They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Input validation is a crucial process - it&#x27;s essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:</p><ul><li><p><strong>Calldata Parameters:</strong> Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.</p></li><li><p><strong>User Approvals:</strong> During the process where the protocol contract manages users&#x27; approvals, meticulous input checks are paramount to prevent potential malicious activities.</p></li></ul></li><li><p>Here are five key tips to protect against social engineering attacks that compromise 2FA for Web3 protocol teams:</p><ul><li><p><strong>Educate and Train Team Members</strong> </p><ul><li><p><strong>Awareness Programs</strong>: Regularly conduct training sessions to educate team members about the various types of social engineering attacks, such as phishing, vishing (voice phishing), and smishing (SMS phishing).</p></li><li><p><strong>Simulated Attacks</strong>: Perform simulated social engineering attacks to test and improve the team&#x27;s response to real threats.</p></li></ul></li><li><p><strong>Use Strong 2FA Mechanisms</strong> </p><ul><li><p><strong>Hardware Tokens</strong>: Encourage the use of hardware-based 2FA tokens (e.g., YubiKey) instead of SMS-based 2FA, which is more susceptible to SIM swapping attacks.</p></li><li><p><strong>App-Based 2FA</strong>: If hardware tokens are not feasible, use app-based 2FA solutions like Google Authenticator or Authy, which are more secure than SMS.</p></li></ul></li><li><p><strong>Monitor and Respond to Suspicious Activity</strong> </p><ul><li><p><strong>Anomaly Detection</strong>: Implement systems to detect and alert on unusual login attempts or behavior that could indicate a compromised account.</p></li><li><p><strong>Immediate Response</strong>: Have a clear incident response plan in place to quickly address and mitigate any suspected social engineering attacks.</p></li></ul></li><li><p><strong>Secure Communication Channels</strong> </p><ul><li><p><strong>Encrypted Communication</strong>: Use encrypted communication channels for sensitive information and authentication processes.</p></li><li><p><strong>Verification Protocols</strong>: Establish protocols for verifying the identity of individuals before sharing sensitive information or performing critical actions.</p></li></ul></li><li><p><strong>Limit Access and Permissions</strong> </p><ul><li><p><strong>Role-Based Access Control (RBAC)</strong>: Implement RBAC to ensure that team members only have access to the information and systems necessary for their role.</p></li><li><p><strong>Regular Audits</strong>: Conduct regular audits of access permissions to ensure they are up-to-date and appropriate.</p></li></ul></li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/june">June</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-may-2024">Monthly Incident Sharing - May 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-06-04T00:00:00.000Z" itemprop="datePublished">June 4, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this May 2024 edition, the total losses mounted up to $92.3 million, showing a 16% increase compared to May 2023. </p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gogalagames---217m---private-key-compromise">GoGalaGames - $21.7m - Private Key Compromise<a href="#gogalagames---217m---private-key-compromise" class="hash-link" aria-label="Direct link to GoGalaGames - $21.7m - Private Key Compromise" title="Direct link to GoGalaGames - $21.7m - Private Key Compromise">​</a></h3><p>GoGalaGames is a GameFi protocol that allows players to earn cryptocurrencies and non-fungible tokens (NFTs) through gameplay. In this incident, its minting role’s private key was compromised, leading to a mint of 5,000,000,001 GALA tokens, an estimated loss of ~$222m on ETH. Interestingly, only a portion of GALA tokens were swapped for ETH, amounting to an estimate of 5913 ETH or $22m USD.</p><p>Thankfully, funds have since been returned and sent to an address termed as Gala Fund Recovery. Also, the excess GALA tokens have been burned. </p><p><strong>Root cause</strong>: The hacker was able to compromise the private key of the original Minter account. It is unclear if it was an internal or external attack.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0xa6d90abe17d17743a9cecab84bcefb0fd0bbfa0c61bba60fd2f680b0a2f077fe" target="_blank" rel="noopener noreferrer">Mint tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-f8343487a70d36fd7127bbcea4718661.png" width="2172" height="312" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sonnefinance---20m---empty-market-attack">SonneFinance - $20m - Empty Market Attack<a href="#sonnefinance---20m---empty-market-attack" class="hash-link" aria-label="Direct link to SonneFinance - $20m - Empty Market Attack" title="Direct link to SonneFinance - $20m - Empty Market Attack">​</a></h3><p>Sonne Finance is a decentralized lending protocol for individuals, institutions and protocols to access financial services. It is a permissionless, open source and Optimistic protocol serving users on Optimism. Users can deposit their assets, use them as collateral and borrow against them. In this attack, the hacker made use of a mislapse in the protocol’s market configuration to execute an empty market attack.</p><p><strong>Root cause</strong>: Sonne was aware of the empty market bug, and planned to:</p><ul><li>timelock add a market</li><li>user add funds</li><li>timelock open up the market for use.</li></ul><p>It would work, as long as the order was followed. However, they scheduled the supportMarket operation independently, instead of using scheduleBatch. Additionally, they opened the EXECUTOR_ROLE to everyone. This essentially allowed anyone to execute the operations in any order.</p><p>The exploited solVELO market was deployed 4 days ago without any liquidity, and added to the Unitroller 2 days later after timelock. As such, this empty market was abused with direct donation to borrow funds from other markets with liquidity.  </p><p><strong>Onchain information</strong>:</p><p><a href="https://optimistic.etherscan.io/tx/0xb43748ed668c1e44cf0a3e829ca0fe24eceaee7d33d06072bb11ca99afa7f448" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://optimistic.etherscan.io/tx/0x9312ae377d7ebdf3c7c3a86f80514878deb5df51aad38b6191d55db53e42b7f0" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-10733d4f188adf37459b33ca33ed5b39.png" width="2160" height="754" class="img_ev3q">
<img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-ff9fb31399ddb561be7a1e48584e9f55.png" width="1660" height="1120" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="alexlabbtc---43m---private-key-compromise">ALEXLabBTC - $4.3m - Private Key Compromise<a href="#alexlabbtc---43m---private-key-compromise" class="hash-link" aria-label="Direct link to ALEXLabBTC - $4.3m - Private Key Compromise" title="Direct link to ALEXLabBTC - $4.3m - Private Key Compromise">​</a></h3><p>On May 15, 2024, ALEXLabBTC, a DeFi project, had an unverified contract compromised, after a malicious upgrade. The potential loss was ~$12m, however the attacker was thankfully inexperienced. The attacker was successfully able to transfer around 13.8 million STX (~$2 million) on the Stack BTC layer-2 chain. </p><p>However, on BSC where the potential damage was $4.3m, a white hat was able to secure funds, and eventually returned all 100% to the project team. On ETH, the exploiter tried to steal assets notionally worth around $5 million, but failed to do so. ALEX Lab later announced they were able to recover or secure around $4.5 million of those assets (through CEX).</p><p><strong>Root cause</strong>: Using compromised private keys obtained via a phishing attack. The exploiter was able to upgrade the code to a malicious logic contract and drain some assets from the ALEX protocol.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x47e123af93add709bc2516f6a5db057dfbb1d66a75b693cd7980cd3eb28c7357" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><a href="https://www.bscscan.com/tx/0x55bb186c80834ffe00ac673b02fb1e70ac4fad56d4407afcf8bf4f1d716f579e" target="_blank" rel="noopener noreferrer">Malicious upgrade tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-dfaeb441be11b8e35fea3a17dbb0c864.png" width="2310" height="850" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pumpfun---19m---insider-attack">Pump.fun - $1.9m - Insider Attack<a href="#pumpfun---19m---insider-attack" class="hash-link" aria-label="Direct link to Pump.fun - $1.9m - Insider Attack" title="Direct link to Pump.fun - $1.9m - Insider Attack">​</a></h3><p>Pump.fun is a Solana Based Memecoin Launchpad that allows users to deploy their own Solana tokens. The incident involved a former employee gaining pump.fun&#x27;s admin privileges, resulting in the misappropriation of approximately 12,300 SOL, valued around $1.9 million at the time.</p><p><strong>Root cause</strong>: A former employee, illegitimately taken access of the withdraw authority using their privileged position at the company, used flash loans on a Solana lending protocol.</p><p>The loans were used to borrow SOL to buy out as many memecoins until they hit 100% on their bonding curves, which allowed the exploiter to gain liquidity to repay the flash loans. This affected roughly $1.9 million out of a total of $45 million in liquidity within the bonding curve contracts during a specific timeframe.</p><p><strong>Onchain information</strong>:</p><p><a href="https://solscan.io/tx/4i1BarkRVtU1RU7eaaTBKrbeDPPVD2D2LcyGFWu1tqCJUsGfkQc61YfsCWz1mQdhknjvP862EoGhs8dgpCVShoED" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-a450da23c0d270fb4f461760884dcff8.png" width="1328" height="894" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="normie---800k---price-manipulation">NORMIE - $800k - Price Manipulation<a href="#normie---800k---price-manipulation" class="hash-link" aria-label="Direct link to NORMIE - $800k - Price Manipulation" title="Direct link to NORMIE - $800k - Price Manipulation">​</a></h3><p>On the 26th of May, 2024, the Base network suffered a damaging exploit targeted at the memecoin, NORMIE. Due to a vulnerability in the smart contract, there was an unfortunate loss of approximately 224.98 ETH.</p><p><strong>Root cause</strong>: The fundamental catalyst for the exploit was a flaw in the smart contract logic. This flaw granted the attacker the capability to trick the contract into acknowledging their address as a privileged one. This deceptive maneuver allowed them to mint tokens without authorization, circumventing crucial security measures, and consequently leading to a significant financial loss.</p><p><strong>Onchain information</strong>:</p><p><a href="https://basescan.org/tx/0xa618933a0e0ffd0b9f4f0835cc94e523d0941032821692c01aa96cd6f80fc3fd" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-9d28598704993ee0a39445212b1799bc.png" width="1314" height="280" class="img_ev3q">
<img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-7686de921cb59a4c11cf6e2651ac067f.png" width="1294" height="370" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>In light of potential insider compromises, it&#x27;s crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:</p><ul><li><p><strong>Preference for certain platforms:</strong> Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.</p></li><li><p><strong>Use of numbers:</strong> Both email addresses and Github usernames often contain numerical sequences. It&#x27;s suspected they use this as a method for tracking the identities they impersonate.</p></li><li><p><strong>Asian identities:</strong> There&#x27;s a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.</p></li><li><p><strong>Prominent educational background:</strong> The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.</p></li><li><p><strong>Codebase theft:</strong> While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.</p></li><li><p><strong>Multiple applications:</strong> They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.</p></li><li><p><strong>Premature expertise:</strong> They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Keys should be properly secured, are rotated regularly and have some level of decentralization. Adopt a <strong>zero-trust</strong> model. </p></li><li><p>For projects utilizing lending protocols:</p><ul><li>When deploying a new market (especially for Compound / Aave v2 forks), ensure that it is first <strong>initialized with 0 Collateral Factor</strong> and <strong>deploy with small deposit to lock dead shares</strong>.</li><li>Disallow deposits when the pool price is out of the base range of liquidity.</li><li>Increase precision on price change thresholds and deposit ratios.</li><li>For those allowing single-sided pool deposits, add a conditional statement to <strong>prevent deposits of any ratio of assets</strong> so long as vault is single-sided.</li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/may">May</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/bridge-scan-report">Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-16T00:00:00.000Z" itemprop="datePublished">May 16, 2024</time> · <!-- -->16 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">Chris</span></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-scan-summary-report-for-cross-chain-bridges-on-the-bnb-chain">Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain<a href="#security-scan-summary-report-for-cross-chain-bridges-on-the-bnb-chain" class="hash-link" aria-label="Direct link to Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain" title="Direct link to Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a href="#background" class="hash-link" aria-label="Direct link to Background" title="Direct link to Background">​</a></h3><p>A cross-chain bridge is a decentralized application that helps to transfer assets from one blockchain to another. The cross-chain bridge is a core component of Web3 infrastructure. For users, the cross-chain bridge can facilitate the seamless movement of tokens and messages between chains. Undeniably, while cross-chain bridges are vital for unleashing exponential innovation in Web3, they simultaneously open up potential avenues for exploitation by malicious entities. Bridges have become a new target for cryptocurrency crime. Vulnerabilities in these bridges are under attack, and hacking incidents are becoming increasingly notable.</p><p>To ensure the safety of users on the BNB chain, we have conducted security scans on 37 active bridge projects on the BNB chain. The scans mainly focus on two aspects:</p><ol><li>The degree of centralization in the privileged roles of the project.</li><li>The open-source status of the project&#x27;s smart contracts.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1degree-of-centralization-in-the-projects-privileged-roles">1.Degree of Centralization in the Project’s Privileged Roles<a href="#1degree-of-centralization-in-the-projects-privileged-roles" class="hash-link" aria-label="Direct link to 1.Degree of Centralization in the Project’s Privileged Roles" title="Direct link to 1.Degree of Centralization in the Project’s Privileged Roles">​</a></h4><p>The main focus here is on whether privileged role management follows good security practices. The examination includes whether a privileged role is an EOA (Externally Owned Account). When an EOA is used in a privileged role, it exposes an attack surface. If the corresponding private key is exposed, the attacker may gain control over the privileged functions, endangering the project&#x27;s economic ecosystem and user funds. Therefore, it is generally considered a better practice with a higher degree of decentralization to use multi-signature wallets, MPC (multi-party computation), or time lock contracts as privileged addresses. Using an EOA as a privileged role in a smart contract signifies a higher degree of centralization in the project.
The assessment also checks whether the threshold or other parameters for privileged roles that have already used multi-signature wallets are set reasonably. If the threshold is not set properly, the multi-signature wallet cannot reduce the degree of centralization and still carries a centralization risk.</p><p>In the real world, notable cross-chain bridge vulnerabilities due to poor security practices for privileged roles are common:</p><ul><li>Harmony Bridge (June 2022) - Two out of five private keys required to promote, approve, and execute transactions on the Harmony Bridge multi-signature were exposed. Here, the mult-sig wallet threshold is less than 51%, which is relatively low.</li><li>Multichain Bridge Hack (July 2023) - The bridge&#x27;s private key was exposed, leading to unauthorized withdrawals, all under the control of the Multichain CEO.</li><li>QANplatform (October 2022) - The cross-chain bridge project was attacked, suspected to be due to a private key leak. It resulted in a loss of approximately $1.9 million, causing the price of the QANX token to plummet.</li></ul><p>Centralized bridge projects are not only vulnerable to attacks but also enable centralized participants to unilaterally control all funds. Decentralized privileged roles help mitigate centralization risks by requiring any potential attacker (including the bridge operator) to compromise the private keys of multiple independent entities to carry out any malicious activity, thus serving as an effective form of security.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-the-open-source-status-of-the-projects-smart-contracts">2. The Open-Source Status of the Project&#x27;s Smart Contracts<a href="#2-the-open-source-status-of-the-projects-smart-contracts" class="hash-link" aria-label="Direct link to 2. The Open-Source Status of the Project&#x27;s Smart Contracts" title="Direct link to 2. The Open-Source Status of the Project&#x27;s Smart Contracts">​</a></h4><p>This scan primarily focuses on the open-source nature of a project&#x27;s smart contracts. </p><p>Since the principal function of cross-chain bridges is the transfer of value from one blockchain to another, all cross-chain protocols necessarily involve smart contracts. In most cross-chain use case scenarios, smart contracts across multiple chains are employed to facilitate functions like token minting, burning, locking, or unlocking – all crucial to efficient cross-chain movement.</p><p>Smart contracts function as both a safeguard against vulnerabilities and a potential technical risk in the event of flawed implementation. Usually, smart contracts provide a valuable mechanism for cross-chain bridges to perform integral security checks, such as ensuring the amount a user withdraws doesn&#x27;t exceed their deposits and enforcing rate limitations. On the other hand, poorly written, or unaudited smart contract code can have a substantially adverse effect: vulnerabilities within the smart contract code can be exploited by malicious hackers, who could potentially steal massive volumes of data from the cross-chain bridge.</p><p>If a cross-chain bridge smart contract on a blockchain explorer is closed source, users would not be able to understand the cross-chain logic by examining the smart contract. Similarly, it would be more difficult for users to judge the quality of the code or identify potential vulnerabilities within the smart contract. Even worse, nefarious project parties may potentially create backdoor functions within closed-source bridge smart contracts, which could lead to user funds becoming irretrievably locked. Using or approving unverified smart contracts inherently exposes users to significant financial risk.</p><p>Contrary to what some project teams may believe, failing to open-source project contracts does not necessarily prevent potential hacker attacks. In truth, experienced hackers can still make attempts on closed source project smart contracts, which impedes normal user interaction and breeds mistrust. Open-sourcing contract code not only promotes project transparency, but also helps prevent the inclusion of malicious code, ultimately fostering increased user trust. Hence, open-sourcing smart contracts is often considered to be best practice in the industry.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-check-results">Security Check Results<a href="#security-check-results" class="hash-link" aria-label="Direct link to Security Check Results" title="Direct link to Security Check Results">​</a></h3><p>The scan results show:</p><ul><li>Out of 37 projects, 12 (32%) were found to have no apparent security risks in these two aspects;</li><li>15 (41%) out of 37 projects had issues of privileged roles centralization; 9 (24%) out of 37 projects had issues related to closed-source smart contracts.</li><li>5 (13%) projects had security issues in both aspects;</li><li>The remaining 6 (16%) projects are not applicable to our scanning. 2 of the projects do not use smart contracts, instead they use Externally Owned Accounts (EOA) to transfer tokens on the chain combined with off-chain programs for cross-chain transfers. The other four projects did not develop their own cross-chain bridges, they simply provide routing selection for multiple cross-chain bridges, so our scanning doesn&#x27;t hold much significance for these types of bridge aggregators.</li></ul><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-f8f378185e8e4baba73d5d2c53bcc282.png" width="1084" height="702" class="img_ev3q"></p><p>We found a total of 239 issues with the centralization of privileged roles and 67 issues with closed-source smart contracts.</p><p>We have identified the below types of risks, which include:</p><ol><li>In some bridge projects, closed-source smart contracts exist on BSCSCAN.</li><li>In some bridge projects, the smart contracts have applied the proxy pattern. While their proxy contracts are open-source, the corresponding logic contracts are closed-source.</li><li>In some bridge projects, closed-source smart contracts are used as privileged roles in certain smart contracts.</li><li>In some bridge projects, Externally Owned Accounts (EOAs) are used as key privileged roles in smart contracts, possessing various privileged functions.</li><li>In some bridge projects, although multi-signature wallets have been used as privileged roles in smart contracts, the multi-signature wallets have set unreasonable/low thresholds (&lt;51%).</li><li>In some bridge projects, despite the use of multi-signature wallets as privileged roles in smart contracts, the number of owners set for the multi-signature wallet is unreasonable, such as only consisting of one owner. This essentially means that the degree of centralization is equivalent to that of an EOA.</li></ol><p>Through our communication and initiatives, thus far, at least four project teams have completely or partially addressed the existing issues. Therefore, currently, there are 16 projects that have implemented good security practices in these two respects. We are still actively communicating with the remaining projects.</p><p>In general, nearly 50% of the cross-chain bridge projects on the BSC chain currently have a good degree of on-chain code openness and a high level of decentralization of privileged roles. In the remaining projects, most project teams have actively responded to our scanning results, showing a willingness to continuously optimize and improve in these two aspects, and are already taking steps to do so. Therefore, the security situation of bridge projects on the BSC chain is quite optimistic. Comparatively speaking, in many other blockchains, the BSC ecosystem has a relatively high overall security for its bridges.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="best-practice-recommendations">Best Practice Recommendations<a href="#best-practice-recommendations" class="hash-link" aria-label="Direct link to Best Practice Recommendations" title="Direct link to Best Practice Recommendations">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices-for-addressing-centralization-in-privileged-roles">Best Practices for Addressing Centralization in Privileged Roles<a href="#best-practices-for-addressing-centralization-in-privileged-roles" class="hash-link" aria-label="Direct link to Best Practices for Addressing Centralization in Privileged Roles" title="Direct link to Best Practices for Addressing Centralization in Privileged Roles">​</a></h4><p>Decentralization is critical for providing security against single points of failure. We recommend solutions such as multi-signature wallets, time-lock contracts, and MPC wallets for use as privileged roles in smart contracts to reduce the level of centralization. </p><ul><li>Multi-signature is abbreviated as multisig and requires multiple private key holders to sign a transaction, usually used to prevent one party from controlling the wallet.  </li><li>A time-lock can lock certain functions of a smart contract for a specified period. It can significantly improve the security of smart contracts. For example, consider a scenario where a hacker has compromised a bridge project&#x27;s multi-signature wallet and is preparing to withdraw money from the vault, but the vault contract has a two-day lock period. Thus, from the initiation of the withdrawal transaction to the actual withdrawal of funds, the attacker will need to abide by this two-day lock period. During this period, the project team can find countermeasures, and investors can sell out their tokens preemptively to reduce losses.</li><li>MPC wallets are a subset of crypto wallets created using multi-party computation methods. They allow multiple users to create a joint wallet to store digital assets without any single point of failure. In this way, MPC wallets can ensure safety and mitigate risks, because compromising the system requires substantial effort from multiple parties. </li></ul><p>We suggest combining one or more of the above solutions as privileged roles. However, please note that whether it is a multisig wallet, a timelock contract, or an MPC wallet, reasonable parameter settings must be applied in order to truly play a role and reduce the level of centralization.</p><ul><li><p>The popular/industry standard interface currently employed for multi-signature wallets is <a href="https://hashdit.github.io/hashdit/blog/smart-wallet-migration-guide/" target="_blank" rel="noopener noreferrer">GnosisSafe</a>. When using a multi-signature wallet, it&#x27;s important to ensure a reasonable threshold is applied. The appropriate threshold for a multi-sig wallet should depend on the number of share owners and their level of trust, and it can vary based on various practical situations. There&#x27;s always a balance between absolute security and convenience. If you set an overly high signature requirement, wallet operation can become overly complex and cumbersome. On the other hand, setting too low of a signature requirement may invite risks of wallet misappropriation.
Common settings include a 2-3-4 mode (a 3-person wallet requiring 2 signatures or a 4-person wallet requiring 3 signatures), which can ensure that, in the case of a participant&#x27;s private key being stolen or the participant being inaccessible, others can continue to operate the wallet without reducing the wallet&#x27;s financial security. Generally speaking, the threshold should not be lower than 51% of the total number of owners, but the total number of owners should not be less than 2.</p></li><li><p>Determining a reasonable lock time for a time lock contract depends on several factors, such as the specific needs of the project, the level of risk tolerance, and functionality requirements.
However, it&#x27;s important to remember that the right lock time for a specific project may vary. For high-risk operations or projects in volatile markets, longer lock times may be necessary. Conversely, for lower-risk operations or stable markets, a shorter lock time might suffice. If the lock time is too short, say a few minutes, the project team may not have enough time to take any action, and then this locking procedure would be essentially in vain.
Typically, the length of lock time chosen should provide sufficient time for the contract&#x27;s stakeholders to react to changes in the contract. Popular choices are often between 24 to 72 hours for many DeFi projects, as this provides an acceptable trade-off between security and operational efficiency.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices-for-smart-contract-codes">Best Practices for Smart Contract Codes<a href="#best-practices-for-smart-contract-codes" class="hash-link" aria-label="Direct link to Best Practices for Smart Contract Codes" title="Direct link to Best Practices for Smart Contract Codes">​</a></h4><p>When using cross-chain protocols, risks associated with smart contracts are practical. The safest cross-chain bridges continuously test their codebases through private and competitive audits, along with various internal security tests such as fuzzing, static analysis, formal verification, symbolic execution, etc.</p><p>Assessing the times of a codebase has been audited and by whom can serve as a reliable signal that the cross-chain bridge in use has protection against technical attacks. Additionally, layered security measures (like enabling emergency pauses and updates, and implementing rate limits) can mitigate the impact of any smart contract errors. </p><p>With all these measures in place, open-source code benefits the project by enhancing transparency and boosting user trust. Typically, closed-source project contracts imply potential risks or even hidden malicious code, backdoor functions, and a risk of rug pulling.</p><p>It&#x27;s best to open source all contracts within the project ecosystem. This is to ensure transparency for users and to allow code auditors/white hats to verify the security of the code.</p><p>An often overlooked case of an unverified contract is when a smart contract uses a proxy pattern. A proxy contract is a contract which delegates calls to another contract. To interact with the actual(logic) contract users have to go through the proxy, and the proxy knows which contract to delegate the call to (the logic).
A proxy pattern is often used when project parities want upgradability for their contracts. This way the proxy contract stays immutable, but they can deploy a new logic contract behind the proxy contract - simply change the logic address inside the proxy contract. So that the proxy contract indeed delegates its functionality to the logic contract. Therefore, it&#x27;s dangerous when only the proxy contract is verified and the logic contract isn&#x27;t as it can&#x27;t be guaranteed that the logic contract isn&#x27;t malicious. As a best security practice, it&#x27;s better to open source not only the proxy contract but also the logic contract.</p><p>When the privileged roles of a smart contract are unverified contracts, the unverified contracts might hold some potential backdoors or malicious external interactions, it&#x27;s best to open source that smart contract code of the privileged role.</p><p>How to open source contracts:</p><ul><li>On BNB chain: <a href="https://bscscan.com/verifyContract" target="_blank" rel="noopener noreferrer">https://bscscan.com/verifyContract</a>   </li><li>On opBNB chain: <a href="https://opbnbscan.com/verifyContract" target="_blank" rel="noopener noreferrer">https://opbnbscan.com/verifyContract</a>  </li></ul><p>Furthermore, always maintain transparency with your investors - for example, create Medium articles, informing users of the addresses or updates of key contracts, etc.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recommendation-for-users">Recommendation for users<a href="#recommendation-for-users" class="hash-link" aria-label="Direct link to Recommendation for users" title="Direct link to Recommendation for users">​</a></h3><p>Before using a cross-chain bridge, users also need to conduct due diligence to ensure that they choose a bridge with effective security measures. Here are some key points:</p><ol><li><strong>Security</strong>: Check whether the cross-chain bridge has passed multiple in-depth security audits, and whether the audit results didn&#x27;t show any major issues. Also, consider how they have responded to and rectified any identified issues.</li><li><strong>Transparency</strong>: It&#x27;s important that the bridge protocol&#x27;s source code is open source and easily accessible. This can help users understand how the protocol works and identify any potential issues.</li><li><strong>Decentralization</strong>: If you have a certain understanding of smart contracts, you can check whether privileged roles in the smart contract use highly decentralized multi-signature wallets or time-lock contracts; and whether the threshold of the multi-signature wallet or the lock duration of the time-lock contract is rationally set.</li><li><strong>Community support</strong>: An active and engaged community can help keep the bridge protocol updated, adaptable to market changes, and capable of solving any problems that may arise.</li><li><strong>Performance</strong>: Observing the performance of the cross-chain bridge, including transaction speeds and costs, is also an important step. A bridge with strong performance and low cost ensures a better user experience.</li><li><strong>User Experience</strong>: User experience is another significant factor, including the usability of the interface, whether there is a comprehensive user guide, and customer support availability.</li><li><strong>Partnerships and ecosystem</strong>: It&#x27;s beneficial for users to check whether the cross-chain bridge has many partners and supports many chains, to assess the extent and maturity of its ecosystem.</li></ol><p>For cross-chain investments, due diligence is essential. You should look at official documents, white papers, security audit reports, consider community reviews, listen to expert opinions, and if possible, test their services. Find out more about it from forums, communities, or Q&amp;A websites, and conduct a comprehensive evaluation from all aspects. Don&#x27;t lightly believe in unverified information.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="glossary">Glossary<a href="#glossary" class="hash-link" aria-label="Direct link to Glossary" title="Direct link to Glossary">​</a></h3><ul><li><p><strong>EOA</strong>: Externally Owned Accounts are accounts that are controlled by a private key and have no coding associated with them. If you hold the private key associated with an EOA, you can send coins and messages from it. (E.g a Metamask account).</p></li><li><p><strong>Rugpull</strong>: A rugpull in the crypto industry is when a development team suddenly abandons a project and sells or removes all its liquidity. The name comes from the phrase to pull the rug out from under (someone), meaning to withdraw support unexpectedly.</p></li><li><p><strong>Privileged Role</strong>: In smart contracts, &quot;privileged roles&quot; often refer to certain roles or accounts within the contract that have special permissions. These accounts have the authority to perform actions that regular users cannot execute in the contract. For example, privileged roles might be able to change contract parameters, upgrade the contract, or pause the contract in emergency situations.
When designing and deploying smart contracts, these privileged roles should be managed and controlled very carefully, as they have potential risks that may be misused or abused. For instance, if a bad actor gets control of a privileged role, they might have the ability to cause abnormal contract behavior or make destructive operations, such as stealing assets stored in the contract.
Sometimes, privileged roles in a smart contract may be assigned to a multi-signature wallet, controlled collectively by multiple entities, increasing complexity and security.</p></li><li><p><strong>Multi-Sig Wallet</strong>: A multi-signature (multi-sig) wallet is a type of digital wallet that requires approval from multiple parties to authorize a cryptocurrency transaction. This type of wallet is designed to provide increased security, as it minimizes the risk of single-point failures or attacks. The &#x27;multi-signature&#x27; aspect refers to the multiple cryptographic keys involved: each co-owner of the wallet has a unique key, and a preset number (the &#x27;threshold&#x27;) of these keys must be used in concert to authorize a transaction.</p></li><li><p><strong>MPC(Multi-Party Computation)</strong>: A Multi-Party Computation (MPC) wallet utilizes multi-party computation technology, in which each party holds a piece of the private key, and computations are collaboratively concluded without revealing individual inputs. This introduces a new level of security as no single party has access to the entire private key, and transactions require authorization from multiple parties, making it extremely difficult for attackers. MPC is used in various applications such as privacy-preserving data analytics, secure voting, secret sharing, etc., including enhancing the security of crypto wallets and transactions.
Compared to multi-signature wallets, the method provided by MPC for ensuring security is different; an MPC wallet offers security through private key sharing without needing to execute a multi-party transaction on the blockchain, while multi-signature wallets offer security by approving transactions with multiple keys executed on the blockchain (leading to typically higher gas fees).</p></li></ul></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/bridge">Bridge</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/scan">Scan</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Getting Started with HashDit Snaps: A Step-by-Step Guide"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/hashdit-snaps-guide">Getting Started with HashDit Snaps - A Step-by-Step Guide</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-15T00:00:00.000Z" itemprop="datePublished">May 15, 2024</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started-with-hashdit-snaps-a-step-by-step-guide">Getting Started with HashDit Snaps: A Step-by-Step Guide<a href="#getting-started-with-hashdit-snaps-a-step-by-step-guide" class="hash-link" aria-label="Direct link to Getting Started with HashDit Snaps: A Step-by-Step Guide" title="Direct link to Getting Started with HashDit Snaps: A Step-by-Step Guide">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3><p>Meet HashDit Snaps, a revolutionary MetaMask extension designed to dramatically boost your security when interacting with smart contracts.
HashDit snap aims to protect users by screening transactions before they are executed through transaction insights. This include warnings against interactions with:</p><ul><li>Ponzi Schemes</li><li>Risky Smart Contract Interactions</li><li>Phishing Websites and Addresses</li><li>Scam Websites and Addresses</li></ul><p>HashDit snap also provides clear details about the function and arguments invoked during a smart contract interaction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h3><p><strong>Installing MetaMask</strong></p><p>As a pre-requisite, MetaMask must be installed on your browser before installing HashDit Snaps. </p><u> Metamask Installation Link </u><p>MetaMask Snaps is currently only supported on the browser version, and not the mobile version.</p><p>Installing The Snap
On the HashDit Snap website, start the installation process by clicking the Add to MetaMask button.</p><p><strong>Installing The Snap</strong></p><p>On the HashDit Snap website, start the installation process by clicking the <strong>Add to MetaMask</strong> button.</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-ae67cfa06a63c4b5209511457887c9d7.png" width="1328" height="444" class="img_ev3q"></p><p><strong>Permissions</strong>
Continue through the install and accept the requested permissions. The requested permissions are required to allow HashDit Snap to work properly.</p><ul><li>Access the internet: Allow HashDit Snap to access the internet. This is used to both send and receive data with the HashDit API.</li><li>Access the Ethereum provider: Allow HashDit Snap to communicate with MetaMask directly, in order for it to read data from the blockchain and suggest messages and transactions.</li><li>Allow websites to communicate directly with HashDit Security: Allow websites to send messages to HashDit Security and receive a response from HashDit Security.</li><li>Fetch and display transaction insights:  Allow HashDit Snap to decode transactions and show insights within the MetaMask UI. This is used for all the security features.</li><li>See the origins of websites that suggest transactions: Allow HashDit Security to see the origin (URL) of websites that suggest transactions. This is used by the URL screening feature.</li><li>Store and manage its data on your device: Allow HashDit Security to store, update, and retrieve data securely with encryption. Other snaps cannot access this information. The only data stored is the signed hash of the security message (see below). </li></ul><p>The HashDit snap does not have access to the user&#x27;s private keys. Furthermore, the only transaction initiated by the Snap is a signature request dispatched during installation.</p><p><strong>Signature Request</strong></p><p>Upon completion of the installation process, the user will be prompted to sign a security message. Note that this is only used to authenticate the HashDit API. Rejecting the signature request will <strong>prevent</strong> HashDit&#x27;s features from working. </p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-baf1cb990ded54ca2f4ec98be863bd47.png" width="674" height="1068" class="img_ev3q"></p><p>If the signature request is rejected, it can be re-prompted by just reinstalling the snap.</p><p>If you attempt to use HashDit snap without signing the security message, an error screen will be displayed.</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-4185076a57beaef5406b6559eaccd99c.png" width="850" height="854" class="img_ev3q"></p><p>Reinstalling the snap will resolve this issue.</p><p><strong>Reinstalling The Snap</strong></p><p>To update the snap or re-sign the signature request, users simply need to click the &#x27;Reconnect&#x27; button, which triggers a new installation prompt.</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-db793506acc5b4ea6cbe0e3c4d02a2ce.png" width="1096" height="480" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-hashdit-snap">How To Use HashDit Snap<a href="#how-to-use-hashdit-snap" class="hash-link" aria-label="Direct link to How To Use HashDit Snap" title="Direct link to How To Use HashDit Snap">​</a></h3><p>Using HashDit Snap is simple!
Once the HashDit Snap is installed, the security features are entirely automatic. The HashDit Snap will provide transaction insights before a transaction is executed by a user. In the transaction screen, a user can switch to the <strong>HashDit Security tab</strong> to view the risks involved with their transaction.</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-3b274a3795704e2b854db0c95e7b1385.png" width="834" height="832" class="img_ev3q"></p><p>The features of HashDit Snap are currently supported on the <strong>Binance Smart Chain Mainnet</strong> and <strong>Ethereum Mainnet</strong>. Other networks will only support URL screening.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="features">Features<a href="#features" class="hash-link" aria-label="Direct link to Features" title="Direct link to Features">​</a></h3><p><strong>Transaction Screening and Destination Screening</strong></p><p><strong>Transaction Screening</strong></p><p>The <strong>Transaction Screening</strong> insight offers a risk assessment before interacting with a smart contract. This assessment provides users with three values that shed light on potential risks associated with their transaction:
<strong>Overall Risk</strong> - The overall risk level of the transaction, which can be one of three levels
·	Low Risk
·	Medium Risk
·	High Risk
<strong>Risk Overview</strong> - The recommended action
<strong>Risk Details</strong> - Details explaining the output of the overall risk</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-7a3a7537998b6b1366f6c6f0c7a9bf28.png" width="1340" height="894" class="img_ev3q"></p><p><strong>Destination Screening</strong></p><p>The <strong>Destination Screening</strong> insight scans a transaction&#x27;s destination address against HashDit&#x27;s database of blacklisted and whitelisted addresses. This database encompasses known scamming, phishing, and trusted addresses. This assessment provides users with three values that shed light on potential risks of interaction:</p><p><strong>Overall Risk</strong> - The overall risk level of the transaction can be one of three levels
·	Low Risk
·	Medium Risk
·	High Risk
<strong>Risk Overview</strong> - The recommended action
<strong>Risk Details</strong> - Details explaining the output of the overall risk</p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-9124c6fc114f244f7e46463cd25ba317.png" width="1352" height="902" class="img_ev3q"></p><p><strong>URL Screening</strong></p><p>The URL Screening insight scans the website origin of the transaction and compares it against HashDit&#x27;s database of whitelisted and blacklisted URLs. Our database includes sites flagged as scams, deemed high-risk, and whitelisted. The insight will provide users with a risk level, ranging from -1 to 4.</p><table><thead><tr><th>Risk Level</th><th>Risk Explanation</th></tr></thead><tbody><tr><td>-1</td><td>Unknown Risk</td></tr><tr><td>0</td><td>No Risk</td></tr><tr><td>1</td><td>Low Risk</td></tr><tr><td>2</td><td>Medium Risk - Suspicious Website</td></tr><tr><td>3</td><td>Medium Risk - Dangerous Website</td></tr><tr><td>4</td><td>High Risk - Dangerous Website</td></tr></tbody></table><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-d43aabfdfba2c89aec367b15f4a0713b.png" width="1344" height="338" class="img_ev3q"></p><p><strong>Function Call Information</strong></p><p>The Function Call insight provides clear and explicit details about the function and arguments invoked during a smart contract interaction. The aim is to offer more readable parameters than Metamask&#x27;s current &#x27;Hex&#x27; tab. This is achieved by displaying each function argument, its type, and its corresponding value.</p><p><img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-9d0e275ccdddd31ed6df1df67adc1280.png" width="1350" height="986" class="img_ev3q">
<img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-e4a927ad519e394b51d285dc88ee9a52.png" width="1298" height="1576" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="links">Links<a href="#links" class="hash-link" aria-label="Direct link to Links" title="Direct link to Links">​</a></h3><p>Official Website: <a href="https://www.hashdit.io/en/snap" target="_blank" rel="noopener noreferrer">https://www.hashdit.io/en/snap</a> </p><p>Documentation and FAQ: <a href="https://hashdit.gitbook.io/hashdit-snap" target="_blank" rel="noopener noreferrer">https://hashdit.gitbook.io/hashdit-snap</a></p><p>GitHub Repo: <a href="https://github.com/hashdit/metamask-snap" target="_blank" rel="noopener noreferrer">https://github.com/hashdit/metamask-snap</a></p><p>MetaMask Snap Page: <a href="https://snaps.metamask.io/snap/npm/hashdit-snap-security/" target="_blank" rel="noopener noreferrer">https://snaps.metamask.io/snap/npm/hashdit-snap-security/</a></p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/api">API</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/integration">Integration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-apr-2024">Monthly Incident Sharing - April 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-14T00:00:00.000Z" itemprop="datePublished">May 14, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this Apr 2024 edition, the total losses mounted up to $2.7 million, showing a 54% decrease compared to April 2023. </p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xbridge---103m---wrong-proxy-upgrade">XBridge - $1.03m - Wrong Proxy Upgrade<a href="#xbridge---103m---wrong-proxy-upgrade" class="hash-link" aria-label="Direct link to XBridge - $1.03m - Wrong Proxy Upgrade" title="Direct link to XBridge - $1.03m - Wrong Proxy Upgrade">​</a></h3><p>XBridge is a Bridge / Cross-Chain protocol that allows users to bridge funds from one chain to another. In this attack, a vulnerable logic contract was introduced in a proxy contract upgrade, allowing the attacker to drain 466,490,205 STC tokens, 511,424,527 SRLTY tokens and 11,165,018 Mazi tokens, amounting to ~$1.03m. Interestingly, the attacker did not liquidate all tokens, and only swapped ~$192k to BNB and deposited it into Tornado Cash, leaving some tokens in his wallet.</p><p><strong>Root cause</strong>: The listToken function in the target contract does not verify msg.sender and _tokenOwner. Essentially, as long as _baseToken==_correspondingToken, the attacker can set the key variable _tokenOwner to msg.sender which is himself, and subsequently call withdrawTokens to extract the baseToken funds directly.</p><p>The upgrade introduced a wrong mapping _tokenOwner instead of using TokenOwner (which was correctly set up in the old logic contract), anyone can thus assume _tokenOwner and withdraw tokens.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x26b1c65526a0d932c1e5589e1ec31341cf918e77247ef49d3036810c0cbb09ad" target="_blank" rel="noopener noreferrer">Bug introduced in Upgrade tx</a></p><p><a href="https://bscscan.com/tx/0xcf8aa3b9dfcf9250a5da5e9571f98374f1d649024a81b8d5f7da2f7d92f313f9" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-a49b6e7bdafe035e7269f604fc05f2c5.png" width="1302" height="1328" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="financechainge---710k---lack-of-validation">FinanceChainge - $710k - Lack of Validation<a href="#financechainge---710k---lack-of-validation" class="hash-link" aria-label="Direct link to FinanceChainge - $710k - Lack of Validation" title="Direct link to FinanceChainge - $710k - Lack of Validation">​</a></h3><p>FinanceChainge is a DeFi protocol, which is known as a liquid cross-chain aggregator. In this attack, the hackers exploited the swap function with a malicious payload. The hack amount is ~ $710k. Interestingly, the sole victim is 0x8a4aa176007196d48d39c89402d3753c39ae64c1, which is linked to the project team and hence likely funds belonging to the project.</p><p><strong>Root cause</strong>: The swap() function had a bug which allowed hackers to exploit users’ allowance given to this victim contract.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0xd348b5fc00b26fc1457b70d02f9cb5e5a66a564cc4eba2136a473866a47dac08" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://bscscan.com/tx/0x051276afa96f2a2bd2ac224339793d82f6076f76ffa8d1b9e6febd49a4ec11b2" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-8050db9e770d0b9bc69fc9e2b8fdc6b8.png" width="960" height="1182" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="openleverage---226k---internal-accounting">OpenLeverage - $226k - Internal accounting<a href="#openleverage---226k---internal-accounting" class="hash-link" aria-label="Direct link to OpenLeverage - $226k - Internal accounting" title="Direct link to OpenLeverage - $226k - Internal accounting">​</a></h3><p>OpenLeverage is a DeFi protocol which operates as a DEX, allowing users to swap tokens. In this rather complicated attack, the attacker was able to compromise the OpenLev contract on BSC. The exploit consisted of a sequence of arbitrary external calls, taking advantage of inconsistency in the accounting for borrowers.</p><p><strong>Root cause</strong>: The attack occurred due to a discrepancy in the accounting process, which comprised two separate transactions. </p><p>Firstly, the attacker set up a &quot;margin position&quot; in the OpenLevV1 contract using the marginTrade function. This function call permitted an additional position creation with minimal collateral through an untrusted external call to the OpBorrowing contract. This position was ultimately liquidated. </p><p>However, both OpenLevV1 and OpBorrowing contracts use the LToken contract for their transactions. Consequently, the debt of the margin position was unintentionally cleared in the liquidation process. </p><p>In the second transaction, the attacker exploited this situation. They used the payoffTrade function, bypassing the health check, and drained all the collateral from the margin positions.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0xf08b6d36dc6f650c030344b6307ae94528f77a01db11d1284ed966e7e44337d3" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://bscscan.com/tx/0x0434bf08a63d70b84fad033d38d8b645498016b3931af4d13f6c11e86848876b" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-ceac19bc84d78f73b52ec8694e1ef8c1.png" width="1302" height="734" class="img_ev3q">
<img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-2a96f75182efb00fbd548a43bb174d6f.png" width="1302" height="820" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ngfs---190k---lack-of-validation">NGFS - $190k - Lack of Validation<a href="#ngfs---190k---lack-of-validation" class="hash-link" aria-label="Direct link to NGFS - $190k - Lack of Validation" title="Direct link to NGFS - $190k - Lack of Validation">​</a></h3><p>NGFS is a DeFi token on BSC. In this attack, the attacker was able to manipulate his own token balance due to a lack of validation for a privileged function. As such, he could simply increase his balance and dump the tokens on the open market.</p><p><strong>Root cause</strong>: The function delegateCallReserves() can be called only once, and is supposed to be set up during the initialization phase, however it was left untouched. As such, anyone could assume _uniswapV2Proxy position and then call the setProxySync() method to set an arbitrary _uniswapV2Library. Lastly, within the reserveMultiSync() function, the attacker could set a large balance for himself since he has _uniswapV2Library privilege.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x8ff764dde572928c353716358e271638fa05af54be69f043df72ad9ad054de25" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-3c256dc651a0b813d3338eddf738c0e7.png" width="1260" height="1010" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="atm---180k---price-manipulation">ATM - $180k - Price Manipulation<a href="#atm---180k---price-manipulation" class="hash-link" aria-label="Direct link to ATM - $180k - Price Manipulation" title="Direct link to ATM - $180k - Price Manipulation">​</a></h3><p>ATM is a DeFi token on BSC. In this attack, the attacker was able to make use of the funds in the ATM contract to add liquidity to the pool. At the same time, he could invoke the skim function to drain excess funds from the pair.</p><p><strong>Root cause</strong>: The _transfer routine can be exploited by directly transferring funds to the pair contract. This triggers the distributeCurrency function, adding liquidity from the perspective of the ATM contract. The attacker could then profit by simply calling skim on the pair.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x458ea2d7e6c5953b0d927aabc1c6a144df276d6ffa55b236087763396ee57067" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://bscscan.com/tx/0xee10553c26742bec9a4761fd717642d19012bab1704cbced048425070ee21a8a" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-d3a3ebc82aa15b51bf05481314118f56.png" width="1112" height="1158" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>Input validation is a crucial process - it&#x27;s essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:</p><ul><li><p><strong>Calldata Parameters:</strong> Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.</p></li><li><p><strong>User Approvals:</strong> During the process where the protocol contract manages users&#x27; approvals, meticulous input checks are paramount to prevent potential malicious activities.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Upgrading proxy code should be taken very seriously and should require several checks such as:</p><ul><li><p><strong>Thorough Testing</strong>: Conduct rigorous testing before deploying any updates to ensure that the changes will not disrupt existing functionalities or introduce new vulnerabilities.</p></li><li><p><strong>Code Audits</strong>: Always get your code audited by a third party. It&#x27;s crucial to have another set of eyes inspect your code, as they may spot issues that you&#x27;ve overlooked.</p></li><li><p><strong>Pause Functionality</strong>: Make sure that your contract has a &#x27;pause&#x27; functionality. In case something goes wrong, this function allows halting the operations until the issue is fixed.</p></li></ul></li><li><p>Addressing internal accounting errors and effectively handling external arbitrary calls are critical for crypto developers, especially for lending projects which involve complex financial transactions. Here are some recommendations:</p><ul><li><p><strong>Sequencing Transactions</strong>: Consider sequencing transactions appropriately. Generally, it&#x27;s safer to make state changes before conducting external calls.</p></li><li><p><strong>External Calls</strong>: Be extremely careful while interacting with third-party contracts. They should be treated as potentially malicious. Avoid state changes after making a call to an external contract.</p></li><li><p><strong>Precise Accounting</strong>: Keep accurate and precise accounting to make sure all balances tally at the end of each operation. This is primarily to ensure that no tokens are lost or mistakenly created during transactions.</p></li><li><p><strong>Debt and Collateral Management</strong>: Carefully track and manage computational handling of debt and collateral. Errors in management or calculation can lead to vulnerabilities such as unforeseen liquidations or insolvency.</p></li><li><p><strong>Limit Permissions</strong>: Limit the permissions of the contract that makes external calls to only what&#x27;s necessary to reduce your contract&#x27;s attack surface.</p></li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/apr">Apr</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-mar-2024">Monthly Incident Sharing - March 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-04-09T00:00:00.000Z" itemprop="datePublished">April 9, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this Mar 2024 edition, the total losses mounted up to $146 million, showing a 50% decrease compared to March 2023. </p><p>Of which, they are split across 2 sections: DApps ($114m) and Phishing ($32m).</p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="munchables---625m---insider-attack">Munchables - $62.5m - Insider Attack<a href="#munchables---625m---insider-attack" class="hash-link" aria-label="Direct link to Munchables - $62.5m - Insider Attack" title="Direct link to Munchables - $62.5m - Insider Attack">​</a></h3><p>Munchables is a GameFi and NFT protocol. In this attack, it was confirmed to be an Insider Attack where a rogue employee was malicious, gaining access to a privileged account. After malicious logic was introduced in a proxy contract upgrade, 62M funds were transferred out by the attacker. Thankfully, after some negotiation and investigation, the funds were eventually returned.</p><p><strong>Root cause</strong>: Malicious developer was hired and suspected to be linked to DPRK, and had bad intentions right from the start. It was found that the malicious logic was already introduced during deployment and the bad actor used manual manipulation of the getLocked storage slot to assign himself an enormous Ether balance in the contract, so that his locked amount would bypass the withdrawal checks.</p><p><strong>Onchain information</strong>:</p><p><a href="https://blastscan.io/tx/0x9a7e4d16ed15b0367b8ad677eaf1db6a2a54663610696d69e1b4aa1a08f55c95" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><a href="https://blastscan.io/tx/0xea1d9c0d8de4280b538b6fe6dbc3636602075184651dfeb837cb03f8a19ffc4f" target="_blank" rel="noopener noreferrer">Malicious contract upgrade</a></p><p><strong>Code snippet</strong>:</p><p>Unverified contract</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-21ba244362c94bac7527ea374c136625.png" width="2472" height="1166" class="img_ev3q">
<img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-e496156fb5b1ac071ec742d2a03f1ff2.png" width="1548" height="1480" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prismafi---12m---lack-of-validation">PrismaFi - $12m - Lack of Validation<a href="#prismafi---12m---lack-of-validation" class="hash-link" aria-label="Direct link to PrismaFi - $12m - Lack of Validation" title="Direct link to PrismaFi - $12m - Lack of Validation">​</a></h3><p>PrismaFi is a DeFi protocol, which is known as a non-custodial and decentralized Ethereum LST &amp; LRT backed stablecoins. In this attack, the hackers bypassed the migrate function and called the flash loan directly with carefully crafted input data.</p><p>The flash loan&#x27;s callback function, onFlashloan(), was called. The lack of proper checks allowed the hackers to close a trove owner&#x27;s Trove and immediately reopen it within the same TroveManager. The transaction caused the owner&#x27;s position to be closed and reopened, resulting in the trove owner having a new position with the same debt but less collateral and the difference in collateral sitting in the zap contract.</p><p>The hackers then opened a new Trove and used the MigrateTroveZap contract to migrate it, effectively using the remaining collateral for their own Trove.
Finally, the hackers closed their Trove and took the profits.</p><p><strong>Root cause</strong>: The root cause of the vulnerability was twofold:</p><ol><li>By directly calling the onFlashloan() function, the user could manipulate other trove managers positions.</li><li>The contract allowed for a mismatch between the collateral in the initial position and the collateral in the new position, with the difference being susceptible to being taken.</li></ol><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x00c503b595946bccaea3d58025b5f9b3726177bbdc9674e634244135282116c7" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://etherscan.io/tx/0xce3cdc7c29eb7dfc565f5d99034789e80c1cd3278adafa26af6f3d21c8412c59" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p><a href="https://etherscan.io/tx/0x0e38dd693ddbc2f62282932f36a4b8de75f8ea1da530532af26698b4eda9a110" target="_blank" rel="noopener noreferrer">Hack tx 3</a></p><p><strong>Code snippet</strong>:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-cbabf4825b46c1c9e8c20b58a1f94190.png" width="2434" height="1276" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="woofi---87m---price-manipulation">WooFi - $8.7m - Price Manipulation<a href="#woofi---87m---price-manipulation" class="hash-link" aria-label="Direct link to WooFi - $8.7m - Price Manipulation" title="Direct link to WooFi - $8.7m - Price Manipulation">​</a></h3><p>WooFi is a DeFi protocol which operates as a DEX, allowing users to swap tokens. In this attack, the attacker was able to compromise the WooPPV2 contract on Arbitrum. The exploit consisted of a sequence of flash loans that took advantage of low liquidity to manipulate the price of WOO in order to repay the flash loans at a cheaper price.</p><p><strong>Root cause</strong>: There were 2 configuration issues. </p><ol><li>A previously unidentified error resulted in the price being adjusted far outside of the expected range ($0.00000009) </li><li>The fallback check, normally executed against Chain Link, didn’t cover the WOO token price.</li></ol><p><strong>Onchain information</strong>:</p><p><a href="https://arbiscan.io/tx/0x40e1b8c78083fc666cb7598efcecd0ae0af313fc41441386e4db716c2808ce07" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://arbiscan.io/tx/0xe80a16678b5008d5be1484ec6e9e77dc6307632030553405863ffb38c1f94266" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p><strong>Code snippet</strong>:</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-9678ce02d5bf2abb832d9be16732cda9.png" width="2446" height="1288" class="img_ev3q">
<img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-89d68fb5f280af92d3312ae8bb18efda.png" width="2500" height="1122" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sss_hq---48m---function-wrongly-implemented">SSS_HQ - $4.8m - Function wrongly implemented<a href="#sss_hq---48m---function-wrongly-implemented" class="hash-link" aria-label="Direct link to SSS_HQ - $4.8m - Function wrongly implemented" title="Direct link to SSS_HQ - $4.8m - Function wrongly implemented">​</a></h3><p>SSS_HQ or Super Sushi Samurai is a GameFi platform on Blast chain. In this attack, thankfully a White Hat was able to spot the bug before any malicious actor, where he increased his own balance by repeatedly transferring to himself. He subsequently swapped these tokens in the liquidity pool and protected the liquidity of ~$4.8m.</p><p><strong>Root cause</strong>: The tax transfer logic is wrongly implemented in the _update method of the SSS.sol code. The _balances<!-- -->[to]<!-- --> value is incremented before the _balances<!-- -->[from]<!-- --> value is updated (done within the _postCheck method), seen in the first picture. As such, the balance of the to address uses the stale value i.e original balance, seen in the second picture. This is summed with the amount variable, stored in the toBalance variable and subsequently overwriting the _balances<!-- -->[from]<!-- --> in the last statement, almost doubling the sender’s balance.</p><p><strong>Onchain information</strong>:</p><p><a href="https://blastscan.io/tx/0x62e6b906bb5aafdc57c72cd13e20a18d2de3a4a757cd2f24fde6003ce5c9f2c6" target="_blank" rel="noopener noreferrer">White-hat Hack tx</a></p><p><strong>Code snippet</strong>:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-0ba50f8dd2cc93d2d34703751344e355.png" width="2450" height="1296" class="img_ev3q">
<img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-a6035a7c2c90673517a3ee25d667449e.png" width="2482" height="580" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unizen---21m---lack-of-validation">Unizen - $2.1m - Lack of Validation<a href="#unizen---21m---lack-of-validation" class="hash-link" aria-label="Direct link to Unizen - $2.1m - Lack of Validation" title="Direct link to Unizen - $2.1m - Lack of Validation">​</a></h3><p>Unizen is a DeFi protocol which operates as a DEX across multiple chains. In this instance, the attack happened on Ethereum, just 5 hours after the victim proxy was upgraded to a vulnerable logic contract. The vulnerable contract introduced a function 0x1ef29a02 which allowed arbitrary calldata to be sent. </p><p><strong>Root cause</strong>: Lack of validation in a Swap related function (which allowed arbitrary transferFrom calls, specifying the From, To and Amount parameters). As such, victims that have approved their funds to this contract will be affected.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0xc12a4155c2c90707138e4aef8883c8f724371145823e2f661f19b93e5b3a9d6e" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><strong>Code snippet</strong>:
Unverified contract</p><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-931334844f2e49da8fee7bc0e18989e6.png" width="2066" height="164" class="img_ev3q">
<img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-15da38e5b70cc0081ac666cdf6c3c690.png" width="576" height="146" class="img_ev3q">
<img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-8bca9882db94438e55423645b10e359f.png" width="2764" height="212" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>In light of potential insider compromises, it&#x27;s crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:</p><ul><li><p><strong>Preference for certain platforms:</strong> Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.</p></li><li><p><strong>Use of numbers:</strong> Both email addresses and Github usernames often contain numerical sequences. It&#x27;s suspected they use this as a method for tracking the identities they impersonate.</p></li><li><p><strong>Asian identities:</strong> There&#x27;s a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.</p></li><li><p><strong>Prominent educational background:</strong> The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.</p></li><li><p><strong>Codebase theft:</strong> While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.</p></li><li><p><strong>Multiple applications:</strong> They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.</p></li><li><p><strong>Premature expertise:</strong> They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.</p></li></ul></li><li><p>Input validation is a crucial process - it&#x27;s essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:</p><ul><li><p><strong>Calldata Parameters:</strong> Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.</p></li><li><p><strong>User Approvals:</strong> During the process where the protocol contract manages users&#x27; approvals, meticulous input checks are paramount to prevent potential malicious activities.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Ensuring that the deployed function aligns with the intended objective is a critical requirement, especially for high-stakes operations such as accounting. This assurance can be achieved through:</p><ul><li><p><strong>Thorough Testing:</strong> Execute comprehensive fuzz testing and edge case analysis. This doesn&#x27;t solely ensure correct function logic, it also helps to identify potential flaws and security vulnerabilities that might otherwise be overlooked.</p></li><li><p><strong>Use Trusted Templates:</strong> Consider using trusted codebases, such as Openzeppelin, as a foundation for your code. These established libraries have been vetted extensively by the developer community, reducing the likelihood of introduction of unexpected bugs or issues.</p></li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p><p>*Unverified contracts screenshots courtesy of Dedaub’s decompiler!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/mar">Mar</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Meme Education Guide"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/meme-education-guide">Meme Education Guide</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-04-04T00:00:00.000Z" itemprop="datePublished">April 4, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="meme-education-guide">Meme Education Guide<a href="#meme-education-guide" class="hash-link" aria-label="Direct link to Meme Education Guide" title="Direct link to Meme Education Guide">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3><p>Since its inception, meme tokens have earned themselves a polarizing reputation in the crypto space. From the fun frenzy around Doge coins, Cat coins, Pepe coins, to the latest hype surrounding Solana memes, they&#x27;ve become a phenomenon that’s difficult to ignore. Their promise of potentially delivering exponential returns attracts many users. But with great rewards come great risks.</p><p>In the decentralized web3 world, fraud such as honeypot scams and rugpull schemes are unfortunately common. These deceptive strategies often use innocuous meme tokens as bait, exploiting the pseudonymous nature of addresses to deceive unsuspecting investors. </p><p>At HashDit, we&#x27;re committed to maximizing user security by providing countermeasures to these issues. Our aim is to enable more users to understand the potential risks associated with tokens they encounter, especially as trading becomes increasingly accessible with the surge of channels, with Telegram bots being one good example. </p><p>HashDit provides token scanning and threat intelligence services to platforms such as PancakeSwap and Trust Wallet, where users can make informed decisions after being notified of the risks. Platforms like DAppBay have also integrated our API, offering a scanner that users can employ to evaluate the risk associated with a token before investing in it.</p><p>However, while automation can help to identify most risks, it&#x27;s not completely foolproof. Even the most sophisticated models can have false positives. So, how can you personally ensure a meme token&#x27;s safety before investing? Here&#x27;s a basic checklist:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="as-a-meme-user-investor">As a meme user investor:<a href="#as-a-meme-user-investor" class="hash-link" aria-label="Direct link to As a meme user investor:" title="Direct link to As a meme user investor:">​</a></h3><ol><li><p><strong>Research the Token:</strong> Start your exploration by looking into the meme token online. Rely on trustworthy sources such as the project&#x27;s website, or reputable third-party sites like <a href="https://coinmarketcap.com/view/memes/" target="_blank" rel="noopener noreferrer">CoinMarketCap</a>. This helps you glean a well-rounded view of the asset.</p></li><li><p><strong>Verify the Contract Address:</strong> Token replication is a common forgery tactic. To avoid falling into honeypot traps or scams, ensure that you&#x27;re investing in the legitimate token by verifying the contract address with authentic sources like the project’s website. </p></li><li><p><strong>Investigate the Team and Developers:</strong> Confidence in a token is often synonymous with the team behind it. Check their track record and transparency levels. Always remember, a credible team builds a credible token.</p></li><li><p><strong>Audit Reports:</strong> It is important to find out if professional security auditors have vetted the meme token’s code. Audit reports from reliable firms can significantly mitigate the risk of scams hidden in the code.</p></li><li><p><strong>Social Media and Community Interactions:</strong> Stay engaged with the project’s online communities on platforms like Telegram, Twitter, Discord, and so forth. Active and responsive social media channels underscore the project&#x27;s genuine nature.</p></li><li><p><strong>Smart Contract Checks:</strong> Basic review of the smart contract code is strongly advised, <a href="https://bscscan.com/" target="_blank" rel="noopener noreferrer">BscScan</a> is a good way to check this. Firstly, check if the contract code is verified or open-source. (Paste the address on BscScan. Click on Contract and then Code.)</p></li></ol><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-1031a31e78d3dd63e5b39f190508868f.png" width="1882" height="490" class="img_ev3q"></p><p>If the contract code has been verified, there should be an accompanying green tick seen.</p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-3f8665cc90367e144803b6edf78fb7d2.png" width="1166" height="254" class="img_ev3q"></p><p>If the contract has not been verified, the code would not be seen and there would be no green tick.</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-1729912f449be6a01ff8847c86569c19.png" width="1898" height="1004" class="img_ev3q"></p><p>If the code is verified, users should then proceed to look for any privileged functions that the team has access to, within the &quot;Search Source Code&quot; box.</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-4cbd7943109315d412ea67f51543fd59.png" width="1116" height="192" class="img_ev3q"></p><p>The presence of these privileged functions might pose a potential security risk to investors, causing loss of funds.</p><p>Common privileged functions can include, but not limited to: mint(), pause(), blacklist(), whitelist(), setFee(), etc. An easy way to search through the code is to use keywords (ctrl-F) like “onlyOwner” and “authorized”. </p><p>However, it is possible that the privileged role has been renounced i.e the dead address. As such, it is critical to check if the privileged role is an Externally Owned Account (EOA). To verify the ownership, click on “Read Contract” and search for “owner”.</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-c7b17100eae4d2a4aa50332c3f792044.png" width="1312" height="562" class="img_ev3q"></p><p>If the address is an EOA, you would see an “Address” label beside the actual address, as seen below.</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-d1f8e879aa24293c96d2388c8485358b.png" width="448" height="194" class="img_ev3q"></p><p>However, do take note that the address could be a “Dead address”. A “Dead address” in crypto terms simply means that nobody has the keys to this account and hence the tokens there would be taken out of circulation. 2 common examples are
<a href="https://bscscan.com/address/0x0000000000000000000000000000000000000000" target="_blank" rel="noopener noreferrer">0x0000000000000000000000000000000000000000</a> and <a href="https://bscscan.com/address/0x000000000000000000000000000000000000dead" target="_blank" rel="noopener noreferrer">0x000000000000000000000000000000000000dead</a></p><p>In other circumstances, you could see another label called “Contract”. This simply means that another smart contract has privileges over this token. </p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-a0f8bece37d8653287c2c87d4262bc6a.png" width="384" height="158" class="img_ev3q"></p><p>If it was a Multi-Signature wallet, you would see a “Smart Account by Safe”. This is relatively more secure as multiple owners can verify transactions.</p><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-8923857d3895fa4fe6998c81645707b0.png" width="334" height="144" class="img_ev3q"></p><p>If this label is not there, it could be a Timelock related smart contract managed by the team. In this case, users should check with the team to get more clarity. </p><ol start="7"><li><p><strong>Automated Security Scanners:</strong> Other external tools such as GoPlus and Honeypot.is can be utilized to cross-check that the token is indeed secure. This increases confidence in the security assessing process.</p></li><li><p><strong>Liquidity Locks:</strong> A locked liquidity usually denotes a safer investment. You can check this on the project&#x27;s website, as well as verify through independent tools like BscScan. Detecting a lack of liquidity lock could save you from falling for a rug pull. </p></li></ol><p>Most meme projects would inform their investors on their site that a certain percentage is burned or locked. However, to ensure that this information is accurate, you are encouraged to verify this with BscScan. You can follow the following steps:</p><ul><li>After pasting the address, click on the token link under “More Info” -&gt; “TOKEN TRACKER”. </li><li>Then, click “Holders” to check who are the top holders for the meme token.</li></ul><p><img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-ba93e4a1ba28dea7e0cc20a35d8dd84e.png" width="996" height="1020" class="img_ev3q"></p><p>Some of the positive signs to look out for amongst the top holders include the presence of Dead addresses, having its supply stored in Multi-Signature wallets or being listed on Centralized Exchanges (CEXs) like Binance. This means that some of the liquidity is locked temporarily with trustable entities or permanently with these addresses.</p><p>Another common strategy for meme tokens is to use a Liquidity Locker. There are 2 types here: either a 1) 3rd party Locking-as-a-Service platform or a 2) Personal locking contract deployed by the team.</p><p>Popular 3rd party platforms include PinkSale and Unicrypt locking services. As such, their respective labels will be visible in the Holders list as seen below.  </p><p><img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-8d2ea2299069d2701d336aa9bf9247d3.png" width="656" height="256" class="img_ev3q"></p><p>A personal Locking contract by the team could be a smart contract with the name “Vesting / Locking wallet”, as seen in the image below.</p><p><img loading="lazy" alt="IMG-12" src="/hashdit/assets/images/12-9316acfa74e4234fc9f825179e857556.png" width="1112" height="166" class="img_ev3q"></p><p>Similarly, you can apply the same process to the liquidity token. Usually, this would be a PancakeSwap LP token. To get the liquidity token from the meme token, you can use another tool like dextools.io, paste the address to obtain the pair contract address.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="as-a-meme-project-owner">As a meme project owner:<a href="#as-a-meme-project-owner" class="hash-link" aria-label="Direct link to As a meme project owner:" title="Direct link to As a meme project owner:">​</a></h3><p>To launch and maintain a successful and trustworthy meme token, consider the following:</p><ol><li><p><strong>Transparency:</strong> Keep your team identities accessible, and refrain from restricting users&#x27; comments on community platforms like Twitter or Telegram. Posting regular updates about the project&#x27;s progress are also key to building trust and transparency.</p></li><li><p><strong>Credibility:</strong> Forge partnerships with reputable projects, and aim to list your token on recognized centralized or decentralized exchanges that have established themselves as being trustworthy. These actions can help to add credibility to the meme token.</p></li></ol><ol start="3"><li><strong>Supply Locking:</strong> Locking your token&#x27;s supply adds an extra layer of security and stability to your project. This includes not just the token’s supply, but also the liquidity on decentralized exchanges. As a guideline, the locking period should be at least 1 year. Numerous platforms offer Locking-as-a-Service, or you could opt to deploy your own locking or vesting contracts using libraries like <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/finance/VestingWallet.sol" target="_blank" rel="noopener noreferrer">OpenZeppelin</a>.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h3><p>In conclusion, exercising awareness and caution by both users and project owners are essential for fostering growth in the dynamic world of meme tokens. By following the safety guidelines here, users can avoid potential pitfalls, and projects can increase their chance of success. </p><p>It is important to take note that meme tokens generally contain high risks and can have significant price fluctuations so users should be wary in terms of their risk management.</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/april">April</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/meme">Meme</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/guide">Guide</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/education">Education</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Monthly Incident Sharing (Feb 2024)"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-feb-2024">Monthly Incident Sharing - February 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-03-14T00:00:00.000Z" itemprop="datePublished">March 14, 2024</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monthly-incident-sharing-feb-2024">Monthly Incident Sharing (Feb 2024)<a href="#monthly-incident-sharing-feb-2024" class="hash-link" aria-label="Direct link to Monthly Incident Sharing (Feb 2024)" title="Direct link to Monthly Incident Sharing (Feb 2024)">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this Feb 2024 edition, the total losses mounted up to $132 million, showing a 141% increase compared to February 2023. </p><p>Of which, they are split across 3 sections: DApps ($65m), CEXs ($62m) and Phishing ($5m).</p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="playdapp---30m---private-key-compromise">PlayDapp - $30m - Private Key Compromise<a href="#playdapp---30m---private-key-compromise" class="hash-link" aria-label="Direct link to PlayDapp - $30m - Private Key Compromise" title="Direct link to PlayDapp - $30m - Private Key Compromise">​</a></h4><p>PlayDapp is a GameFi and Web3 Service protocol. In this attack, the hacker was able to compromise the original Minter account. As such, a malicious minter account was added and he minted 200m $PLA tokens, before dumping them on the open market.</p><p>Since then, the token transfer method has been paused and the token is planning to be migrated to a new address $PDA.</p><p>Root cause: The hacker was able to compromise the private key of the original Minter account. It is unclear if it was an internal or external attack.</p><p>Onchain information:</p><p><a href="https://etherscan.io/tx/0xe834f28377b79759ac5495a91975a01e0876af9aae312228c1ac525846406170" target="_blank" rel="noopener noreferrer">Add Malicious Minter tx</a></p><p><a href="https://etherscan.io/tx/0xe8be05f6a3360f63b9e78a30b4ba16ea4c7d0b530a8abf99390f1c831851fb7e" target="_blank" rel="noopener noreferrer">Malicious Mint tx</a></p><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-877f2ba8ce7b99ca53676ecb80f1ae96.png" width="2120" height="932" class="img_ev3q">
<img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-e67662453bba0da903a5be24a576d7a7.png" width="2576" height="334" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ronin-networks-jihoz---10m---private-key-compromise">Ronin Network’s Jihoz - $10m - Private Key Compromise<a href="#ronin-networks-jihoz---10m---private-key-compromise" class="hash-link" aria-label="Direct link to Ronin Network’s Jihoz - $10m - Private Key Compromise" title="Direct link to Ronin Network’s Jihoz - $10m - Private Key Compromise">​</a></h4><p>Ronin Network is a bridge protocol allowing cross chain of funds. In this attack, Ronin Network’s cofounder Jihoz had his wallet compromised. However, the attack is limited to only personal accounts, and does not affect operations of Sky Mavis and the Ronin chain.</p><p>Root cause: The hacker was able to compromise the private key of Jihoz’s wallet. As such, his assets were stolen from there.</p><p>Onchain information:</p><ul><li><p>Ronin:
<a href="https://app.roninchain.com/tx/0x206bc24404b66f9a4424c7515bd6da92ce95640fae66fe217784a0edd71334dd" target="_blank" rel="noopener noreferrer">https://app.roninchain.com/tx/0x206bc24404b66f9a4424c7515bd6da92ce95640fae66fe217784a0edd71334dd</a>
<a href="https://app.roninchain.com/tx/0x93977df7f34204a88ed12ddb591e2e58a0aad6edfd009ca6db4491e14f9f38d9" target="_blank" rel="noopener noreferrer">https://app.roninchain.com/tx/0x93977df7f34204a88ed12ddb591e2e58a0aad6edfd009ca6db4491e14f9f38d9</a>
<a href="https://app.roninchain.com/tx/0x9784ad2501cff282fa98a87272a9ac4379170fb80a2da92e5c7195fa5af274f1" target="_blank" rel="noopener noreferrer">https://app.roninchain.com/tx/0x9784ad2501cff282fa98a87272a9ac4379170fb80a2da92e5c7195fa5af274f1</a>
<a href="https://app.roninchain.com/tx/0x7fb315e8c27d78f6a3c4bd812b2afcf0b3b3e80fd36c8db3ab3d0e9dfa58c291" target="_blank" rel="noopener noreferrer">https://app.roninchain.com/tx/0x7fb315e8c27d78f6a3c4bd812b2afcf0b3b3e80fd36c8db3ab3d0e9dfa58c291</a> </p></li><li><p>Ethereum:
<a href="https://etherscan.io/tx/0x4962a88dfd49e49d3df0f290ae7d4b73632b2afc943a7ea5c2ee45140de7ad93" target="_blank" rel="noopener noreferrer">https://etherscan.io/tx/0x4962a88dfd49e49d3df0f290ae7d4b73632b2afc943a7ea5c2ee45140de7ad93</a>
<a href="https://etherscan.io/tx/0x517dac8e59ca0d5e7017323a75dd732b2d48b07c9de20c2bfcaf1cee22cd7d7b" target="_blank" rel="noopener noreferrer">https://etherscan.io/tx/0x517dac8e59ca0d5e7017323a75dd732b2d48b07c9de20c2bfcaf1cee22cd7d7b</a>
<a href="https://etherscan.io/tx/0x5cd2b28d70b79d7f1d92f7273234f2a4ce3b153731ef44dffedac425de311201" target="_blank" rel="noopener noreferrer">https://etherscan.io/tx/0x5cd2b28d70b79d7f1d92f7273234f2a4ce3b153731ef44dffedac425de311201</a>
<a href="https://etherscan.io/tx/0xcdd35d3c3a1b584dfa86732a61d5f42f6c5b0c03c6805ccd97294c6f1a0163f5" target="_blank" rel="noopener noreferrer">https://etherscan.io/tx/0xcdd35d3c3a1b584dfa86732a61d5f42f6c5b0c03c6805ccd97294c6f1a0163f5</a> </p></li></ul><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-0a745f34dbef177c0e430ba2e38252ec.png" width="2726" height="286" class="img_ev3q">
<img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-530bfcfaf95d6f2275c6b7a73f7658a4.png" width="2732" height="690" class="img_ev3q">
<img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-9adf222ab6a695c3cc3f876a5715389a.png" width="2606" height="602" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="shido---33m---private-key-compromise">Shido - $3.3m - Private Key Compromise<a href="#shido---33m---private-key-compromise" class="hash-link" aria-label="Direct link to Shido - $3.3m - Private Key Compromise" title="Direct link to Shido - $3.3m - Private Key Compromise">​</a></h4><p>Shido is a L1 blockchain protocol which combines the interoperability of Cosmos, and the development power of EVM and WASM. In this attack, the attacker was able to compromise the StakingV4Proxy owner&#x27;s wallet on Ethereum, upgrading to a malicious logic, withdrawing $SHIDO tokens and dumping them on the open market. </p><p>Root cause: The hacker was able to compromise the private key of StakingV4Proxy’s owner wallet. It is unclear if it was an internal or external attack.</p><p>After transferring ownership to a malicious owner, he immediately upgrades the StakingV4Proxy contract with a malicious withdrawToken() function that withdraws all $SHIDO tokens from the contract.</p><p>Onchain information:</p><p><a href="https://etherscan.io/tx/0xaa76ea503fadddf775b1ef7f195676440fdc3ac46ab642798ab6fa7ae3aafcbe" target="_blank" rel="noopener noreferrer">StakingV4Proxy owner transfer tx</a></p><p><a href="https://etherscan.io/tx/0x5d4056cdf40d09a6715fd0f26895d0c60038899b45620f0a6a402c4cd425b672" target="_blank" rel="noopener noreferrer">StakingV4Proxy upgrade tx</a></p><p><a href="https://etherscan.io/tx/0xed3000ddd8b4feb0902107f97a91815ecee8d7ccb57de9a9dbc50a4c07593cb3" target="_blank" rel="noopener noreferrer">Withdraw all $SHIDO tokens tx</a></p><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-3b158c73922c403041b20db3f9300103.png" width="2652" height="404" class="img_ev3q">
<img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-a11f05a485c6c0ed583db87e799e3918.png" width="2632" height="308" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="seneca---31m---lack-of-validation">Seneca - $3.1m - Lack of Validation<a href="#seneca---31m---lack-of-validation" class="hash-link" aria-label="Direct link to Seneca - $3.1m - Lack of Validation" title="Direct link to Seneca - $3.1m - Lack of Validation">​</a></h4><p>Seneca Protocol is a DeFi lending platform and stablecoin issuer. In this attack, the attacker was able to compromise approximately 1,385 PT-Kelp rsETH from a Seneca collateral pool. He subsequently swapped these tokens for approximately $3 million worth of ETH.</p><p>Root cause: There is a lack of validation check for the user input data in the performOperations() function. This bug allows any account to call the function while specifying OPERATION_CALL as the action to be performed, allowing an exploiter to arbitrarily invoke external calls to steal funds from approving users.</p><p>Onchain information:</p><p><a href="https://etherscan.io/tx/0x6da8f7cb19d6e56cd9b74298677986b3b55cb9db902175c2627b7d57a85e820d" target="_blank" rel="noopener noreferrer">Hack tx on Ethereum</a> </p><p><a href="https://arbiscan.io/tx/0x5e9c14e30ff1d56da37c17d84378650881095bda2802f0a0bff90fd3a8b11e31" target="_blank" rel="noopener noreferrer">Hack tx on Arbitrum</a></p><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-3c767dd51b9d0691b02af3f68e1a7081.png" width="2430" height="1068" class="img_ev3q">
<img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-6571e15fb952268225972ae02cc57d06.png" width="2336" height="522" class="img_ev3q">
<img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-8d3cf31b44e81d8543a5b53cc2192582.png" width="2174" height="1516" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="blueberryfdn---16m---oracle-misconfiguration">BlueberryFDN - $1.6m - Oracle Misconfiguration<a href="#blueberryfdn---16m---oracle-misconfiguration" class="hash-link" aria-label="Direct link to BlueberryFDN - $1.6m - Oracle Misconfiguration" title="Direct link to BlueberryFDN - $1.6m - Oracle Misconfiguration">​</a></h4><p>BlueberryFDN is a DeFi protocol which allows lending and borrowing of funds across chains. In this instance, the attack was front-runned by a whitehat, c0ffeebabe.eth. The vulnerability was due to the lending contract&#x27;s incorrect handling of price decimals. As such, the attacker was able to borrow all the liquidity of three lending pools (OHM, USDC, WBTC) with extremely low collateral, since the assets borrowed are under-estimated, due to the non-normalized price.</p><p>Root cause: There was an incorrect usage of the oracle because the oracle always returns prices scaled to 18 decimals, thus causing assets that have less than 18 decimals to be undervalued significantly when being borrowed. </p><p>On Ethereum, WETH has a decimal of 18, OHM has a decimal of 9, USDC has a decimal of 6, and WBTC has a decimal of 8. Since BlueberryProtocol’s price oracle scales all token prices based on a decimal of 18, this caused the value of OHM to shrink by 1e9, USDC by 1e12, and WBTC by 1e10. As a result, the attacker managed to borrow assets worth 460 ETH by only collateralizing 1 ETH.</p><p>Onchain information: </p><p><a href="https://etherscan.io/tx/0xf0464b01d962f714eee9d4392b2494524d0e10ce3eb3723873afd1346b8b06e4" target="_blank" rel="noopener noreferrer">Hack tx</a> </p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-11" src="/hashdit/assets/images/11-fce0279a97edea4b1994c2ddf7c184c0.png" width="2642" height="832" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h3><ol><li>Keys should be properly secured, rotated regularly and have some level of decentralization. Adopt a <strong>zero-trust model</strong>.
Conduct proper background checks for new employees in view of insider compromises.</li></ol><ol start="2"><li>Validation is important - <strong>ensure all possible user inputs are checked for state changing</strong> methods. This is especially true for calldata parameters where attackers can craft any data and when the protocol contract handles users’ approvals.</li></ol><ol start="3"><li>Proper handling of decimals in different tokens used in the protocol is fundamental, particularly when calculating token price values. Furthermore, guaranteeing that the <strong>price oracles used in the protocol are normalized to the expected decimals</strong> is critical. Price oracles provide current and accurate token prices, thus any discrepancies might lead to significant errors in token pricing and overall system operations.</li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/feb">Feb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="HashDit API Integration"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/api-integration">HashDit API Integration</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-03-12T00:00:00.000Z" itemprop="datePublished">March 12, 2024</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hashdit-api-integration">HashDit API Integration<a href="#hashdit-api-integration" class="hash-link" aria-label="Direct link to HashDit API Integration" title="Direct link to HashDit API Integration">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-hashdit">What Is HashDit?<a href="#what-is-hashdit" class="hash-link" aria-label="Direct link to What Is HashDit?" title="Direct link to What Is HashDit?">​</a></h3><p>HashDit is a Web3 Security Firm dedicated to providing completely free security solutions to both end users and protocol developers on the BNB Chain. Our central objective is to furnish crucial threat intelligence to empower day-to-day DeFi investors in making well-informed decisions. Navigating this DeFi intricate landscape poses challenges even for seasoned investors, let alone newcomers. HashDit aims to bridge this knowledge gap by offering timely and comprehensive threat intelligence on DeFi projects.
HashDit&#x27;s API integration extends its influence to numerous prominent applications, anchoring active measures to safeguard users from the clutches of fraudulent activities.
Hashdit typical clients include but are not limited to the following protocols.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1trustwallet">1.TrustWallet<a href="#1trustwallet" class="hash-link" aria-label="Direct link to 1.TrustWallet" title="Direct link to 1.TrustWallet">​</a></h4><p>HashDit&#x27;s API takes center stage within TrustWallet, an industry vanguard Web3 Wallet. Serving as a protective layer within the user experience, HashDit&#x27;s threat intelligence suite preempts elevated risks by promptly notifying users before they connect to the dApp or execute transactions. This proactive approach ensures users operate with heightened vigilance, fortifying their engagement within the dynamic DeFi landscape.</p><span style="background-color:#d3d3d3">In 2023, HashDit API continually safeguarded assets on TrustWallet and prevented 584k of 630k risky BSC transactions, that&#x27;s a 93% coverage, preventing users from transferring nearly $169m to scammers!</span><br><br><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2pancakeswap">2.PancakeSwap<a href="#2pancakeswap" class="hash-link" aria-label="Direct link to 2.PancakeSwap" title="Direct link to 2.PancakeSwap">​</a></h4><p>This leading DEX on the BNBChain, with a substantial $1.3 billion in TVL, seamlessly incorporates HashDit&#x27;s solution. Automated scans of tokens within the PancakeSwap framework offer users discernible risk scores. This feature empowers users with real-time insights into potential transactional risks, bolstering informed decision-making amid their DeFi interactions.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3bscscan">3.BscScan<a href="#3bscscan" class="hash-link" aria-label="Direct link to 3.BscScan" title="Direct link to 3.BscScan">​</a></h4><p>A prime example of HashDit&#x27;s impact unfolds through its collaboration with blockchain explorers, most notably BscScan. Integrating risk alerts within the explorer&#x27;s interface bolsters user prudence and caution. Users are empowered to tread warily when engaging with projects or addresses displaying suspicious or high-risk attributes. This measured approach fosters an environment of cautious exploration, preventing undue exposure to potential risks.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="integrate-hashdit-api-with-3-steps">Integrate HashDit API With 3 Steps<a href="#integrate-hashdit-api-with-3-steps" class="hash-link" aria-label="Direct link to Integrate HashDit API With 3 Steps" title="Direct link to Integrate HashDit API With 3 Steps">​</a></h3><ul><li>Step1: Apply for access by sending a request with following information to <a href="mailto:support@hashdit.com" target="_blank" rel="noopener noreferrer">support@hashdit.com</a>.<ul><li>Project name</li><li>Project description &amp; main products</li><li>Estimated chains</li><li>Estimated QPS<ul><li>Query Per Second, the HashDit Security API rate limit is 1200 calls/minute. If you require a higher limit than the available plans, please input correct QPS info.</li></ul></li><li>Scenario (see more details in “Security Scanner Scenario” below)<ul><li>DeFi Wallet<ul><li>Url Security Scanner</li><li>Address Security Scanner</li></ul></li><li>Dex<ul><li>Token Security Scanner</li><li>Others (input the description)</li></ul></li></ul></li><li>Release date</li></ul></li><li>Step2: HashDit team will review the request and provide the api token and test examples within 5 work days.</li><li>Step3: You can build up the Security Scanner within your project 🎉.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-scanner-scenario">Security Scanner Scenario<a href="#security-scanner-scenario" class="hash-link" aria-label="Direct link to Security Scanner Scenario" title="Direct link to Security Scanner Scenario">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1wallet">1.Wallet<a href="#1wallet" class="hash-link" aria-label="Direct link to 1.Wallet" title="Direct link to 1.Wallet">​</a></h4><ul><li>Typical Example: <br> <a href="https://trustwallet.com/blog/a-safer-web3-experience-with-trust-wallet-security-scanner" target="_blank" rel="noopener noreferrer">https://trustwallet.com/blog/a-safer-web3-experience-with-trust-wallet-security-scanner</a>  </li><li>Url Security Scanner <ul><li>API: <a href="https://hashdit.github.io/hashdit/docs/hashdit-api/dapp-url-analysis" target="_blank" rel="noopener noreferrer">https://hashdit.github.io/hashdit/docs/hashdit-api/dapp-url-analysis</a> </li><li>User interaction and design references</li></ul></li></ul><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-a081d741622996c98ce47a89ca0fa8d5.png" width="2690" height="1620" class="img_ev3q"></p><ul><li>Address Security Scanner <ul><li>API: <a href="https://hashdit.github.io/hashdit/docs/hashdit-api/address-analysis-api" target="_blank" rel="noopener noreferrer">https://hashdit.github.io/hashdit/docs/hashdit-api/address-analysis-api</a> </li><li>User interaction and design references</li></ul></li></ul><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-3898aa270c9fc2e777f98471e4e2de46.png" width="2692" height="1466" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2dex-token-security-scanner">2.Dex Token Security Scanner<a href="#2dex-token-security-scanner" class="hash-link" aria-label="Direct link to 2.Dex Token Security Scanner" title="Direct link to 2.Dex Token Security Scanner">​</a></h4><ul><li><p>Typical Example: <br> <a href="https://pancakeswap.finance/swap?outputCurrency=0xDd25E1955FD9F7B3aBE83CC419070A7ace104DCE" target="_blank" rel="noopener noreferrer">https://pancakeswap.finance/swap?outputCurrency=0xDd25E1955FD9F7B3aBE83CC419070A7ace104DCE</a> </p></li><li><p>API：<a href="https://hashdit.github.io/hashdit/docs/hashdit-api/address-analysis-api" target="_blank" rel="noopener noreferrer">https://hashdit.github.io/hashdit/docs/hashdit-api/address-analysis-api</a> </p></li><li><p>User interaction and design references</p></li></ul><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-ebe8a58bd2e0026ee928b100f40b68d1.png" width="2702" height="1458" class="img_ev3q"></p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/api">API</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/integration">Integration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Monthly Incident Sharing (Jan 2024)"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-jan-2024">Monthly Incident Sharing - January 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-02-08T00:00:00.000Z" itemprop="datePublished">February 8, 2024</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monthly-incident-sharing-jan-2024">Monthly Incident Sharing (Jan 2024)<a href="#monthly-incident-sharing-jan-2024" class="hash-link" aria-label="Direct link to Monthly Incident Sharing (Jan 2024)" title="Direct link to Monthly Incident Sharing (Jan 2024)">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them.</p><p>For this Jan 2024 edition, the total losses mounted up to $153 million, showing a staggering 453% increase compared to January 2023. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="orbit-chain---815m">Orbit Chain - $81.5m<a href="#orbit-chain---815m" class="hash-link" aria-label="Direct link to Orbit Chain - $81.5m" title="Direct link to Orbit Chain - $81.5m">​</a></h4><p>Orbit Chain is a Bridge protocol, which uses the model of locking collateral on the source chain to mint wrapped tokens on the destination chain. In this attack, the hacker was able to compromise 1 of the bridge’s vault and steal its funds. <a href="https://etherscan.io/tx/0xd8ca42941a0a2c25669267ad8d61f7f9f4118252cb502316602fe16624b80ac8" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Root cause: Backend compromise. The hacker was able to produce 15 correct Signer keys (v, r, s values), although the threshold needed was just 7. </p><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-1fda6473d3e9922fb49bddae3980573c.png" width="369" height="512" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="magic-internet-money-mim---65m">Magic Internet Money (MIM) - $6.5m<a href="#magic-internet-money-mim---65m" class="hash-link" aria-label="Direct link to Magic Internet Money (MIM) - $6.5m" title="Direct link to Magic Internet Money (MIM) - $6.5m">​</a></h4><p>Magic Internet Money is a DeFi protocol which allows lending and borrowing of funds. In this attack, the attacker was able to compromise 1 of the protocol’s markets and steal funds. <a href="https://etherscan.io/tx/0x26a83db7e28838dd9fee6fb7314ae58dcc6aee9a20bf224c386ff5e80f7e4cf2" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Root cause: The borrow function in CauldronV4 contracts was vulnerable to manipulation of the part parameter (the user’s share of total debt) via repeatedly borrowing and repaying an asset, taking advantage of the rounding error. </p><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-f2213b5f67805e7722fa82f5d2764fae.png" width="512" height="78" class="img_ev3q">
<img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-4de6b41f15584ccf02e4b4c9d959467e.png" width="512" height="209" class="img_ev3q">
<img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-3a5c14f90b22c05292e490127315d2f4.png" width="512" height="208" class="img_ev3q">
<img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-5241913e554a5ad8b138938215477fc0.png" width="512" height="222" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gamma-strategies---46m">Gamma Strategies - $4.6m<a href="#gamma-strategies---46m" class="hash-link" aria-label="Direct link to Gamma Strategies - $4.6m" title="Direct link to Gamma Strategies - $4.6m">​</a></h4><p>Gamma Strategies is a DeFi protocol which allows active liquidity management and market making strategies. In this attack, the attacker was able to compromise 1 of the protocol’s vaults and steal funds. <a href="https://arbiscan.io/tx/0x6116f311ac199d6f608c52e44c93a0e6961f10380fd379873b8bf27c92402462" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Root cause: The liquidity ratio checker function erroneously allowed for deposits in any ratio so long as the contents within the vault were single-sided. This allowed for a disproportionate amount of token 0 being deposited, gaining more shares than expected. A second issue was there was no check for the current tick to be within the base position’s lower and upper tick (only a check for the tick change)</p><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-19bc59fc19c58e5f1193f8b093983795.png" width="512" height="217" class="img_ev3q">
<img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-9abfb14c2724d7dd691084edbfcdfd67.png" width="512" height="188" class="img_ev3q">
<img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-cd990f7ecccf920ab38d06b39759c080.png" width="512" height="170" class="img_ev3q">
<img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-71712f1eccca3b5628354c50ca733e15.png" width="512" height="155" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="radiant---44m">Radiant - $4.4m<a href="#radiant---44m" class="hash-link" aria-label="Direct link to Radiant - $4.4m" title="Direct link to Radiant - $4.4m">​</a></h4><p>Radiant is a DeFi protocol which allows lending and borrowing of funds across chains. In this attack, the attacker was able to compromise 1 of the protocol’s markets and steal funds. <a href="https://arbiscan.io/tx/0x1ce7e9a9e3b6dd3293c9067221ac3260858ce119ecb7ca860eac28b2474c7c9b" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Root cause: &quot;New/empty market&quot; exploit. It is a known vulnerability to the combination of a rounding error and a totalSupply value of 0. Bug introduced in recent upgrade. </p><p>Vulnerable code snippet:</p><p><img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-507490cb1f730fccc10a3573236a8f0b.png" width="512" height="252" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="socket-dot-tech---33m">Socket Dot Tech - $3.3m<a href="#socket-dot-tech---33m" class="hash-link" aria-label="Direct link to Socket Dot Tech - $3.3m" title="Direct link to Socket Dot Tech - $3.3m">​</a></h4><p>Socket Dot Tech is an Interoperability protocol bringing seamless connectivity across blockchains. In this attack, the attacker was able to compromise 1 of the protocol’s vaults and steal funds. <a href="https://etherscan.io/tx/0x591d054a9db63f0976e533f447df482bed5f24d7429646570b2108a67e24ce54" target="_blank" rel="noopener noreferrer">Hack Tx</a></p><p>Root cause: Unsafe call in the performAction() function. The attacker constructed calldata in the swapExtraData parameter to call transferFrom() of arbitrary tokens, transferring tokens approved to the contract by other users to the attacker&#x27;s address. Bug was introduced in the recent proxy upgrade. </p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-11" src="/hashdit/assets/images/11-ce162f921fec96de828bfc25bc800407.png" width="512" height="220" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h3><ol><li>Keys should be properly secured, rotated regularly and have some level of decentralization. Adopt a <strong>zero-trust model</strong>.
Conduct proper background checks for new employees in view of insider compromises.</li></ol><ol start="2"><li>Validation is important - <strong>ensure all possible user inputs are checked for state changing</strong> methods. This is especially true for calldata parameters where attackers can craft any data and when the protocol contract handles users’ approvals.</li></ol><ol start="3"><li><p>Rounding in Solidity always rounds down. As such, it is important to perform multiplication before division and to round down for the user during withdrawals, and round up during deposits. Consider <strong>increasing precision</strong> during calculations to avoid unexpected manipulation attacks.</p><p>However, in the latest donation attacks for lending protocols, we see that the usual rule to favor protocol for calculations is no longer sufficient. There must be better <strong>health checks for bad debt</strong> as well, at the end state of a transaction.</p></li></ol><ol start="4"><li><p>For projects utilizing lending protocols:</p><ul><li>When deploying a new market (especially for Compound / Aave v2 forks), ensure that it is first <strong>initialized with 0 Collateral Factor</strong> and <strong>deploy with small deposit to lock dead shares</strong>.</li><li>Disallow deposits when the pool price is out of the base range of liquidity.</li><li>Increase precision on price change thresholds and deposit ratios.</li><li>For those allowing single-sided pool deposits, add a conditional statement to <strong>prevent deposits of any ratio of assets</strong> so long as vault is single-sided.</li></ul></li><li><p>Always engage a security auditor to <strong>review all code upgrades before they are deployed on chain</strong>. This prevents new bugs from being introduced.</p></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/jan">Jan</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/hashdit/blog/page/2"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Introduction</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/hashdit/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/hashdit/docs/hashdit-api/api-access">API Documentations</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/HashDit" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/hashdit/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/hashdit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Hashdit Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/hashdit/assets/js/runtime~main.9a124b34.js"></script>
<script src="/hashdit/assets/js/main.383d5b0f.js"></script>
</body>
</html>