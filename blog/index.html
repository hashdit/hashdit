<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Blog | HashDit</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hashdit.github.io/hashdit/blog"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | HashDit"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/hashdit/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hashdit.github.io/hashdit/blog"><link data-rh="true" rel="alternate" href="https://hashdit.github.io/hashdit/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://hashdit.github.io/hashdit/blog" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/hashdit/blog/rss.xml" title="HashDit RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/hashdit/blog/atom.xml" title="HashDit Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XST5Y5VMG3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XST5Y5VMG3",{anonymize_ip:!0})</script><link rel="stylesheet" href="/hashdit/assets/css/styles.ac84f47d.css">
<link rel="preload" href="/hashdit/assets/js/runtime~main.d84112fb.js" as="script">
<link rel="preload" href="/hashdit/assets/js/main.4868fa04.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/hashdit/"><div class="navbar__logo"><img src="/hashdit/img/favicon.ico" alt="HashDit Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/hashdit/img/favicon.ico" alt="HashDit Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">HashDit</b></a><a class="navbar__item navbar__link" href="/hashdit/docs/intro">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hashdit/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hashdit/hashdit/tree/main" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bsc-2024-end-of-year-report">2024 End of Year BSC Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bsc-2024-quarter-three-report">2024 Q3 BSC Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-july-2024">Monthly Incident Sharing - July 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bsc-2024-half-year-report">2024 H1 BSC Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-june-2024">Monthly Incident Sharing - June 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-may-2024">Monthly Incident Sharing - May 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bridge-scan-report">Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/hashdit-snaps-guide">Getting Started with HashDit Snaps - A Step-by-Step Guide</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-apr-2024">Monthly Incident Sharing - April 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-mar-2024">Monthly Incident Sharing - March 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/meme-education-guide">Meme Education Guide</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-feb-2024">Monthly Incident Sharing - February 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/api-integration">HashDit API Integration</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/monthly-incident-sharing-jan-2024">Monthly Incident Sharing - January 2024</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/twitter-compromise">Twitter Compromise Security Blog</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/2023-Top10-Incidents">2023 Top 10 Security Incidents</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-16Nov2023">PancakeSwap November 16th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-09Nov2023">PancakeSwap November 9th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-02Nov2023">PancakeSwap November 2nd Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-26Oct2023">PancakeSwap October 26th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-19Oct2023">PancakeSwap October 19th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/Gas-Mint-Scam-2023">Gas Mint Scam (Updated!)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-05Oct2023">PancakeSwap October 5th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/The-Trend-of-Hot–Wallet-Compromises">An In-depth Security Analysis ---- The Trend of Hot Wallet Compromises</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-28Sep2023">PancakeSwap September 28th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-21Sep2023">PancakeSwap September 21st Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/Layer2-Security-Report">Security First in opBNB, Learnt from Layer 2 Incidents</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-14Sep2023">PancakeSwap September 14th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-07Sep2023">PancakeSwap September 7th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/BSC-August-Security-Report">BNB Smart Chain Monthly Incident Report August 2023 - 60% drop of total incident amounts</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-31Aug2023">PancakeSwap August 31st Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/ponzi-schemes-in-web3">Ponzi Schemes in Web3 ---- Swamps in the Dark</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/PancakeSwap-Security-Report-24Aug2023">PancakeSwap August 24th Weekly Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bsc-2023-half-year-report">2023 H1 BSC Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/zero-knowledge-proof-and-its-application-in-blockchain">Zero-Knowledge Proof and Its Application in Blockchain</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/smart-wallet-migration-guide">Multisig Wallet Migration Guide</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/The-risks-and-future-of-crypto-wallets">The Risks and Future of Crypto Wallets</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/bsc-2022-end-of-year-report">2022 End of Year BSC Security Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/repackaged-apps-are-harmful">Repackaged Apps are harmful</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/top-6-crypto-scams-2022">Top 6 Most Popular Crypto Scams In 2022</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hashdit/blog/10-minutes-rugpull">How to Spot a Potential Rug in 10 Minutes</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Table of contents"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/bsc-2024-end-of-year-report">2024 End of Year BSC Security Report</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-12-30T00:00:00.000Z" itemprop="datePublished">December 30, 2024</time> · <!-- -->19 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h1>2024 End of Year BSC Security Report</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of contents" title="Direct link to Table of contents">​</a></h2><ul><li><a href="#overview">Overview</a></li><li><a href="#disclaimer">Disclaimer</a></li><li><a href="#executive-summary">Executive Summary</a></li><li><a href="#notable-developments">Notable developments</a><ul><li><a href="#developments-in-the-wallet-drainer-scams">Developments in the Wallet Drainer Scams</a></li><li><a href="#continued-rise-of-dprk-scams">Continued rise of DPRK Scams</a></li><li><a href="#continued-rise-of-spoofing-scams">Continued rise of Spoofing Scams</a></li></ul></li><li><a href="#year-over-year-yoy">Year-over-Year (YoY)</a><ul><li><a href="#general">General</a></li><li><a href="#type-of-attack-vectors">Type of attack vectors</a></li><li><a href="#type-of-projects">Type of projects</a></li><li><a href="#chain-comparison">Chain comparison</a></li></ul></li><li><a href="#2024-in-focus">2024 in focus</a><ul><li><a href="#general-1">General</a></li><li><a href="#wallet-drainer-analysis">Wallet Drainer Analysis</a></li><li><a href="#spoofing-analysis">Spoofing Analysis</a></li><li><a href="#quarter-over-quarter-qoq">Quarter-over-Quarter (QoQ)</a></li><li><a href="#month-over-month-mom">Month-over-Month (MoM)</a></li><li><a href="#type-of-attack-vectors-1">Type of attack vectors</a></li><li><a href="#type-of-projects-1">Type of projects</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#appendix">Appendix</a><ul><li><a href="#hashdit">HashDit</a></li><li><a href="#top-10-incidents">Top 10 Incidents</a></li><li><a href="#2024-highlights">2024 highlights</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>This report focuses on security events that happened on BSC in 2024, analyzing the type of projects targeted and sharing the common attack techniques used in 2024, with respect to the financial loss of the incidents.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="disclaimer">Disclaimer<a href="#disclaimer" class="hash-link" aria-label="Direct link to Disclaimer" title="Direct link to Disclaimer">​</a></h2><p>The financial data provided here is accurate based on our own monitoring system and based on the $USD amount of the cryptocurrency involved at the time of the incident. Due to the fluctuating price nature of cryptocurrencies, the total amount loss might differ with the current token valuations.</p><p>Furthermore, the financial data might not fully reflect the true “exploited amount” of the incident. This is especially true for scams where the total scammed amount is usually mixed with an initial base amount injected by the scam project party.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="executive-summary">Executive Summary<a href="#executive-summary" class="hash-link" aria-label="Direct link to Executive Summary" title="Direct link to Executive Summary">​</a></h2><ol><li>A total of <strong>$62,895,059</strong> was lost across <strong>149</strong> security incidents in 2024</li><li>This represents a decline of <strong>61%</strong> from 2023 total of <strong>$162,214,631</strong></li><li>May saw the most loss, with <strong>$20,624,200</strong> across <strong>9</strong> incidents</li><li>Q4 was the most costly quarter, at <strong>$31,399,100</strong> from <strong>88</strong> incidents </li><li>The most financially damaging attack vector belongs to <strong>Hot Wallet Compromise</strong>, with $<strong>27,040,000</strong> in <strong>6</strong> incidents.</li><li>BSC ranks <strong>6th</strong> in total losses across chains, representing <strong>3%</strong> of total loss in Web3. This gave an average loss of $422,114 per incident. The 1st place went to Ethereum, representing <strong>53%</strong> of total loss, with <strong>$1,075,000,000</strong> in losses in <strong>326</strong> incidents. This resulted in an average loss of <strong>$3,297,546</strong> per incident.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="notable-developments">Notable developments<a href="#notable-developments" class="hash-link" aria-label="Direct link to Notable developments" title="Direct link to Notable developments">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="developments-in-the-wallet-drainer-scams">Developments in the Wallet Drainer Scams<a href="#developments-in-the-wallet-drainer-scams" class="hash-link" aria-label="Direct link to Developments in the Wallet Drainer Scams" title="Direct link to Developments in the Wallet Drainer Scams">​</a></h3><p>Wallet Drainers are a sophisticated form of fraud that preys on users with low security awareness. These scams often operate under a &quot;Scam-as-a-Service&quot; model, allowing individuals to purchase malicious scripts to conduct their own scam campaigns. The primary method involves tricking users into visiting phishing websites and signing scam transactions with their crypto wallets, leading to the theft of their funds. This technique is not limited to a single blockchain but follows the flow of money across various chains. In 2024, Wallet Drainers continue to run wild, spreading havoc across ordinary users who are not careful in the space. Some of the notable instances include:</p><ul><li>Wallet Drainers have extended their reach beyond EVM chains to include networks like TON and Cardano.</li><li>Scammers continue to focus on high-profile events, such as the Pudgy’s PENGU airdrop, to maximize their impact.</li><li>Compromised data from breaches like MailerLite and LastPass have been used to spread phishing scams.</li><li>Drainers have created fake channels and social media accounts on platforms like Telegram and Discord to mislead users.</li><li>Scammers have developed fake meeting software and used social engineering to trick users into downloading malware.</li><li>Targeting commonly used npm packages in crypto projects, such as Solana/Web3.js and LottieFiles, to compromise multiple projects&#x27; front ends.</li><li>DNS hijacking incidents, including the major compromise of Squarespace, resulted in significant impacts on many hosted sites, such as Compound and Celer.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="continued-rise-of-dprk-scams">Continued rise of DPRK Scams<a href="#continued-rise-of-dprk-scams" class="hash-link" aria-label="Direct link to Continued rise of DPRK Scams" title="Direct link to Continued rise of DPRK Scams">​</a></h3><p>DPRK-affiliated personnel continue to target trending protocols and high-net-worth individuals in the Web3 space. Their tactics include impersonating legitimate employees to compromise projects, exfiltrate sensitive data, and steal funds over time. Notable incidents include the compromises of DMM Bitcoin and WazirX exchanges. Additionally, they exploit non-technical vulnerabilities to compromise large Total Value Locked (TVL) Web3 methods.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="continued-rise-of-spoofing-scams">Continued rise of Spoofing Scams<a href="#continued-rise-of-spoofing-scams" class="hash-link" aria-label="Direct link to Continued rise of Spoofing Scams" title="Direct link to Continued rise of Spoofing Scams">​</a></h3><p>Scammers have adopted a new tactic of sending small amounts of real money to unsuspecting victims. This involves creating addresses with similar endings to those that users normally interact with and sending a few pennies. They monitor the mempool and quickly generate these addresses to follow up on original transactions. This spoofing technique has been observed on multiple non-EVM chains, including Solana (with over $3 million in losses) and Tron. The largest recorded damage was $68 million on Ethereum in May.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="year-over-year-yoy">Year-over-Year (YoY)<a href="#year-over-year-yoy" class="hash-link" aria-label="Direct link to Year-over-Year (YoY)" title="Direct link to Year-over-Year (YoY)">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general">General<a href="#general" class="hash-link" aria-label="Direct link to General" title="Direct link to General">​</a></h3><p>In 2024, HashDit monitored $62,895,059 funds loss on BSC. The amounts lost to exploits have continued to drop significantly since 2022, continuing the downward trend of 2023, with a YoY 61% decrease in damages, as seen from the figure below.</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-deab9d01cf38c6b8b6645eada1e7332b.png" width="2318" height="1432" class="img_ev3q"></p><p align="center">Figure 1: Total amount stolen funds (in dollars) on BSC over the last 5 years</p><p>In total, there were 149 security incidents on BSC, representing a 64% year-over-year decrease from 2023, dropping even lower than the 2022 incident count of 286. The average number of incidents per month decreased from 34 to 12. Figure 2 shows that the increasing trend of security incidents has finally been broken in 2024 on BSC, which could signify a positive sign and turnaround in the space.</p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-448bbd071d575fe8777b115bcef38c26.png" width="2318" height="928" class="img_ev3q"></p><p align="center">Figure 2: Number of incidents on BSC over the last 5 years</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="type-of-attack-vectors">Type of attack vectors<a href="#type-of-attack-vectors" class="hash-link" aria-label="Direct link to Type of attack vectors" title="Direct link to Type of attack vectors">​</a></h3><p>Analyzing the attack vectors trends based on Financial losses, both Hacks and Scams have dropped significantly from 2023, with Hacks accounting for $50.6m (31% decrease) and Scams accounting for $12.1m (86% decrease) in 2024.</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-330ca35ccf7ef771e6c0d2a7725a404e.png" width="2318" height="1460" class="img_ev3q"></p><p align="center">Figure 3: Financial losses per attack vector over the last 5 years</p><p>In terms of incident count, both Hacks and Scams have also shown a positive reversal trend from 2023, with 123 Hacks (41% decrease) and 25 Scams (87% decrease) in 2024.</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-bdf84d2f3d8fd0bd8045045c9533f10d.png" width="2318" height="1460" class="img_ev3q"></p><p align="center">Figure 4: Number of incidents per attack vector over the last 5 years</p><p>A comparative analysis of the decrease in percentages reveals a significant reduction in both hacks and scams. This positive trend can be attributed to several key factors. Enhanced security measures on the BSC have played a crucial role in mitigating these threats. The implementation of advanced security protocols and continuous monitoring has made it more difficult for malicious actors to exploit vulnerabilities.</p><p>Additionally, users are becoming more vigilant and knowledgeable about potential scams. There is a growing awareness among the community about the importance of conducting thorough due diligence (DD) before investing in new projects. This proactive approach by users, combined with the robust security efforts on BSC, has contributed to a safer and more secure environment in the crypto space.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="type-of-projects">Type of projects<a href="#type-of-projects" class="hash-link" aria-label="Direct link to Type of projects" title="Direct link to Type of projects">​</a></h3><p>This chart represents the type of projects that were exploited since 2020.</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-24d729d07c7860f9d79c9ed5c1ee210e.png" width="2876" height="844" class="img_ev3q"></p><p align="center">Figure 5: Security Incidents per type of project over the last 5 years</p><p>It is clear that DeFi projects are still the main targets for crypto hackers, with 104 in 2024, still a noticeable drop from 70% decrease from 2023. Many of these projects are relatively obscure and are generally categorized under decentralized finance (DeFi). They typically involve staking or rewards mechanics, which attract users looking for high returns on their investments. Despite their potential for profitability, the lack of visibility and recognition makes these projects more susceptible to risks and scams. As a result, it is crucial for investors to exercise caution and conduct thorough research before engaging with such DeFi projects.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="chain-comparison">Chain comparison<a href="#chain-comparison" class="hash-link" aria-label="Direct link to Chain comparison" title="Direct link to Chain comparison">​</a></h3><p>The figure below shows the comparison between the chains with the top funds losses to exploits over the last 4 years.</p><p>BSC (in green) has shown positive steps, figures dropping significantly since 2021.</p><p>On the other hand, Ethereum (in blue) has continued to be the largest hitting chain since 2021, maintaining its lead at the forefront. At the same time, other chains like BTC (in yellow), Blast (in dark blue) and XRP (in light purple) have shown large increases from 2023.</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-ee7434ff0f3c31c891ae88525a9e3b63.png" width="2876" height="900" class="img_ev3q"></p><p align="center">Figure 6: Biggest financial losses across chains over the last 5 years</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2024-in-focus">2024 in focus<a href="#2024-in-focus" class="hash-link" aria-label="Direct link to 2024 in focus" title="Direct link to 2024 in focus">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general-1">General<a href="#general-1" class="hash-link" aria-label="Direct link to General" title="Direct link to General">​</a></h3><p>In total, roughly $62.8 million were lost to 149 security incidents on BSC.</p><p>Interestingly, when removing the top 3 largest incidents, the total financial loss drops down to just above $30m, a large 52% drop from the total amount loss of 2024. This signifies that most of the damage is still attributed to 1 or 2 large hitting cases.</p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-b185554f0018ad400b1a156cee65e35c.png" width="2876" height="760" class="img_ev3q"></p><p align="center">Figure 7: Amount of stolen funds in dollars excluding the 3 largest incidents</p><p>By observing the quarterly and monthly trends below, there are some interesting observations to be made.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wallet-drainer-analysis">Wallet Drainer Analysis<a href="#wallet-drainer-analysis" class="hash-link" aria-label="Direct link to Wallet Drainer Analysis" title="Direct link to Wallet Drainer Analysis">​</a></h3><p>In 2024, we closely monitored Drainer operations, observing over 500,000 drainer transactions on BNB Chain, resulting in a total loss exceeding $20 million USD.</p><p>The most significant incident occurred on December 11, 2024, when a user <a href="https://bscscan.com/tx/0x1cf2084e9c5965d37610e2ba40db504670114db3abecef8fc67f89d3f4da9faa" target="_blank" rel="noopener noreferrer">lost</a> $8.3 million worth of SolvBTC.BBN and SolvBTC tokens to an Angel Drainer address on BNB Chain. Other incidents did not surpass the $1 million mark, with the second-largest being an $833,000 <a href="https://bscscan.com/tx/0x400b7583b892024db19940e2e74a26b22b188196e3c6cbff4e6663295a50daed" target="_blank" rel="noopener noreferrer">loss</a> in January and another $830,000 <a href="https://bscscan.com/tx/0x0a00ec522a95a517bfb2914e3a4b606163e604f6c9f10287a3dc3ea2a2dfb1bc" target="_blank" rel="noopener noreferrer">loss</a> in July.</p><p>For comparison, on Ethereum, the total drainer amount is much more staggering, exceeding $500 million USD combined. The highest single incident involved $55 million worth of DAI tokens <a href="https://etherscan.io/tx/0xf70042bf3ae7c22f0680f8afa078c38989ed475dfbe5c8d8f30a50d4d2f45dc4" target="_blank" rel="noopener noreferrer">stolen</a> in August 2024, with these funds still residing in the scammer&#x27;s wallets to date.</p><p>This highlights the growing need to educate users on security awareness when signing transactions and to adopt more security tools to aid in understanding what they are signing.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spoofing-analysis">Spoofing Analysis<a href="#spoofing-analysis" class="hash-link" aria-label="Direct link to Spoofing Analysis" title="Direct link to Spoofing Analysis">​</a></h3><p>In 2024, spoofing and address poisoning scams continued to proliferate. We monitored over 30 groups conducting these scams on Ethereum and BNB Chain, resulting in more than $80 million in losses across all chains. Our analysis revealed that most of these groups have a lifespan of less than one month, with the largest groups (those with the most scam funds invested) operating for more than half a year.</p><p>These groups employed various tactics, including:</p><ul><li>Using fake tokens that mimic actual funds transferred.</li><li>Sending 0 amounts of the actual funds transferred.</li><li>Sending small amounts of the actual funds being transferred.</li></ul><p>These measures were used to deceive victims and execute scams effectively.</p><p>Some of the scam profits were exited through non-KYC platforms like Exch and FixedFloat, or they were bridged to other less traceable chains such as Litecoin or Tron.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="quarter-over-quarter-qoq">Quarter-over-Quarter (QoQ)<a href="#quarter-over-quarter-qoq" class="hash-link" aria-label="Direct link to Quarter-over-Quarter (QoQ)" title="Direct link to Quarter-over-Quarter (QoQ)">​</a></h3><ol><li>On BNB Chain, Q4 sees significant increase in fiat losses compared to the rest of the quarters</li></ol><p>Fiat losses surged by 121%, rising from $14.2 million in Q3 to $31.4 million in Q4. In fact, it represented nearly half of the total incident losses in 2024. This significant increase was primarily driven by two major incidents in Q4 2024. The first was the Radiant case, which resulted in losses amounting to $17.8 million. The second involved an individual who fell victim to a Drainer incident, suffering losses of $7.8 million. These two events were among the most damaging losses of the year, contributing substantially to the overall increase in fiat losses.</p><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-22fbebddbd2202a019b9e6459db2313f.png" width="2876" height="968" class="img_ev3q"></p><p align="center">Figure 8: Financial losses across chains over the last 4 quarters in 2024</p><ol start="2"><li>Across all chains in Web3, the overall losses dropped in Q4 as compared to other quarters. This is likely due to increased security education and awareness among users, even though threat actors continue to proliferate in the Web3 space. Enhanced knowledge and vigilance have empowered users to better protect their assets and avoid scams, contributing to the reduction in overall losses.</li></ol><p><img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-c9bed4e1ea23c8f820eee05539baf486.png" width="2876" height="1288" class="img_ev3q"></p><p align="center">Figure 9: Chain comparison fund losses in Q4</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="month-over-month-mom">Month-over-Month (MoM)<a href="#month-over-month-mom" class="hash-link" aria-label="Direct link to Month-over-Month (MoM)" title="Direct link to Month-over-Month (MoM)">​</a></h3><p>The average monthly loss is calculated to be ~$5.2m, with 9 out of the 12 months being below this average reference line.</p><p><img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/11-b13cfa707a7806462fdc824ead52693b.png" width="2876" height="1144" class="img_ev3q"></p><p align="center">Figure 10: Amount of stolen funds in dollars per month in 2024</p><p>In those months above the reference line, the significant increase in fiat loss was due to one or two singular, abnormally large security events. For example, in September, there were two major incidents: the BingXOfficial hot wallet compromise for approximately $6.8 million and the CUT2024CUT price manipulation vulnerability for around $1.45 million. This indicates that, on average, losses per incident are relatively small.</p><p>Analyzing the trend in the number of security incidents, the chart shows that the number of cases largely peaked in April, September, and November, with the average being around 12 incidents per month.</p><p><img loading="lazy" alt="IMG-11" src="/hashdit/assets/images/10-29c4a8051e0ae88fad4c726aa9d7abdc.png" width="2876" height="1104" class="img_ev3q"></p><p align="center">Figure 11: Number of projects impacted by security exploits</p><p>Interestingly, even though April has the one of the highest number of security incidents at 17, the financial loss only stands at $2.7m which is more than half of September’s data. With a nearly similar count at 18, September’s financial loss is more than double, at $9.4m.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="type-of-attack-vectors-1">Type of attack vectors<a href="#type-of-attack-vectors-1" class="hash-link" aria-label="Direct link to Type of attack vectors" title="Direct link to Type of attack vectors">​</a></h3><p>Out of the 149 security incidents, the majority were attributed to hacks, accounting for 82.55%. Scams made up 16.78%, and improper management (operational issues caused by the team&#x27;s mismanagement) accounted for 0.67%.</p><p><img loading="lazy" alt="IMG-12" src="/hashdit/assets/images/12-bcf5a8ce4764457e23dfbee80ec4c6df.png" width="2876" height="1992" class="img_ev3q"></p><p align="center">Figure 12: Proportion of different type of exploits</p><p>This is synchronous with the financial loss of these security incidents. As shown in Figure 12, hacks resulted in a financial loss of $50.6 million, which is significantly more than the $12.1 million loss from scams.</p><p><img loading="lazy" alt="IMG-13" src="/hashdit/assets/images/13-b1d4808c095a4fcdecba44cfb197e39e.png" width="2876" height="1460" class="img_ev3q"></p><p align="center">Figure 13: Financial impact measured in dollars comparing different types of incidents</p><p>For further analysis of the specific attack vectors, this figure below displays this against the financial loss in 2024.</p><p><img loading="lazy" alt="IMG-14" src="/hashdit/assets/images/14-b8aabd095a122263f02266736a5839d8.png" width="2876" height="1712" class="img_ev3q"></p><p align="center">Figure 14: Proportion of the funds lost comparing the different type of vulnerabilities</p><p>A worrying 49.01% of incidents were attributed to <strong>Hot Wallet Compromise</strong>, where CEXs or protocols were careless with managing security around their privileged accounts or lacked security awareness. This led to threat actors breaching their infrastructure and obtaining keys to drain funds. </p><p>The second largest contributor was <strong>Phishing</strong> among regular users, who might store substantial amounts of funds in hot wallets without being aware of the threats. Clicking on fake sites can lead to fake signatures being generated, resulting in stolen funds. </p><p>The third largest contributor was <strong>Private Key Compromise</strong> within other entities, highlighting the importance of securing keys properly and following proper security guidelines in both Web2 and Web3 environments.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="type-of-projects-1">Type of projects<a href="#type-of-projects-1" class="hash-link" aria-label="Direct link to Type of projects" title="Direct link to Type of projects">​</a></h3><p>When focusing on the project type versus financial loss, 48.64% of financial losses are attributed to DeFi projects. The trend of DeFi continues to lead across all major chains, including BSC. However, some developers might not be well-versed in security when writing their smart contracts, leading to investors bearing the brunt of the compromises.</p><p>The second most targeted type were individuals at 14.66%, followed by CEX platforms at 13.51%. Individuals continue to be a main target for scammers, especially with the rise in the crypto market bringing in a new wave of investors whose security awareness may not be strong. Wallets and security extensions play a vital role in protecting these users.</p><p>CEX platforms also continue to be targets since they hold large amounts of funds. If the keys are not managed and stored safely, they become easy targets for hackers.</p><p><img loading="lazy" alt="IMG-15" src="/hashdit/assets/images/15-100e36b55a633052400f6ec05eb8dbe8.png" width="2876" height="1992" class="img_ev3q"></p><p align="center">Figure 15: Proportion of funds lost comparing the type of project</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>In 2024, we observed a notable shift in the landscape of security incidents. While the number and amount of hacks have dropped, scams are on the rise, highlighting the need for users to be more security aware. Phishing remains a persistent threat, and it is crucial for users to stay vigilant against such tactics.</p><p>Our HashDit user products, such as the Chrome extension and Snaps, could have potentially prevented over $25 million in losses. We highly recommend these free products to enhance user security. Additionally, our B2B products, including monitoring, auditing, and prevention tools, will continue to serve the top protocols on BNB Chain, protecting them from threat actors.</p><p>Malicious actors will continue to lurk in the background, and we are committed to staying ahead of them for the sake of the Web3 community. BSC remains a strong competitor, outperforming Ethereum in terms of daily active users and transactions. Although 2023 showed better performance in terms of total funds lost to exploits, it is undeniable that scammers and hackers will continue to evolve their methods until stricter measures are in place to hold them accountable.</p><p>Within HashDit, we will keep improving by:</p><ul><li>Implementing a comprehensive set of stringent audit guidelines that all top TVL projects must meet before deploying significant features on-chain.</li><li>Collaborating promptly with key stakeholders to conduct in-depth root cause analyses on all major incidents, ensuring similar issues are not present in the top TVL projects.</li><li>Working closely and sharing intel within members to identify potentially fraudulent projects at an early stage, particularly those amassing substantial liquidity.</li><li>Monitoring any malicious activities related to hacks and scams vigilantly and transmitting alerts via numerous channels such as Twitter and Telegram to rapidly inform the community.</li><li>Continually extending HashDit’s influence to the community by regularly publishing articles and reports related to hack and scam techniques, strengthening users&#x27; knowledge regarding security awareness in the crypto space.</li></ul><p>We remain dedicated to protecting the Web3 community and ensuring a safer environment for all users and protocols.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a href="#appendix" class="hash-link" aria-label="Direct link to Appendix" title="Direct link to Appendix">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hashdit">HashDit<a href="#hashdit" class="hash-link" aria-label="Direct link to HashDit" title="Direct link to HashDit">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="user-facing-products">User-Facing Products<a href="#user-facing-products" class="hash-link" aria-label="Direct link to User-Facing Products" title="Direct link to User-Facing Products">​</a></h4><ol><li><p><strong><a href="https://chromewebstore.google.com/detail/hashdit/coegijljhiejhdodjbnlglffjomlbgmi?utm_source=ext_app_menu" target="_blank" rel="noopener noreferrer">HashDit Chrome Extension</a>:</strong>
The HashDit Chrome Extension provides an extra layer of protection when interacting with websites involving digital assets. It operates between websites and extension-based wallets like TrustWallet and MetaMask, analyzing transactions, identifying risk factors, and alerting users to potential threats.</p></li><li><p><strong><a href="https://snaps.metamask.io/snap/npm/hashdit-snap-security/" target="_blank" rel="noopener noreferrer">HashDit MetaMask Snaps</a></strong>:
The HashDit MetaMask Snaps offers similar protective features as the Chrome Extension, focusing on showing risks when users are on phishing sites or signing risky transactions. While it has fewer functions compared to the Chrome Extension, it still provides essential security alerts to help users avoid scams.</p></li></ol><p>Business-Facing Products</p><ol><li><p><strong><a href="https://hashdit.github.io/hashdit/docs/transaction-prevention/introduction" target="_blank" rel="noopener noreferrer">Novel Prevention Product</a></strong>:
Our novel prevention product can stop hacks in real-time once any previously set invariants are broken. This proactive approach ensures that any deviations from expected behavior are immediately addressed, preventing potential exploits and safeguarding assets.</p></li><li><p><strong>Monitoring</strong>:
Our monitoring service detects risky events both on-chain and off-chain. On-chain monitoring includes tracking sensitive events such as ownership changes or malicious upgrades, while off-chain monitoring covers social media compromises and DNS hijacks. This comprehensive monitoring allows for quick responses to minimize financial losses, with alerts shared via multiple channels like Twitter and Telegram.</p></li><li><p><strong><a href="https://hashdit.github.io/hashdit/docs/category/hashdit-api-1" target="_blank" rel="noopener noreferrer">Threat Intelligence Product API</a></strong>:
The Threat Intelligence Product API provides a wholesale, all-in-one solution that flags risks associated with addresses or URLs in real-time. By gathering and detecting various types of information, this API offers accurate and timely detection of scam/exploit risks, helping businesses stay ahead of potential threats.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="commitment-to-security">Commitment to Security<a href="#commitment-to-security" class="hash-link" aria-label="Direct link to Commitment to Security" title="Direct link to Commitment to Security">​</a></h4><p>HashDit remains dedicated to improving security for both users and businesses in the Web3 community. By implementing stringent audit guidelines, collaborating with key stakeholders, and sharing intelligence, we aim to create a safer environment for all. Our educational efforts continue to equip builders, investors, and users with the knowledge needed to adopt a security-first mindset, ensuring the Web3 ecosystem becomes a safer place for everyone.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="top-10-incidents">Top 10 Incidents<a href="#top-10-incidents" class="hash-link" aria-label="Direct link to Top 10 Incidents" title="Direct link to Top 10 Incidents">​</a></h4><ol><li><p>Radiant</p><ul><li>Attack Vector: Hot Wallet Compromise</li><li>Damage: $17,800,000</li><li>Description: Hacker gained signatures of three owners of an 11-threshold multisig. The attacker deployed a malicious contract (0xf0fc) to drain Radiant&#x27;s lending pool. Devices were compromised with malware, affecting at least three contributors. The malicious implementation continues to drain funds from users who have approved it.</li></ul></li><li><p>User</p><ul><li>Attack Vector: Phishing</li><li>Damage: $8,300,000</li><li>Description: A user (@0xYuanbo) lost ~$8.3m worth of SolvBTC.BBN &amp; SolvBTC tokens to an Angel Drainer address on BSC due to two transfer transactions signed to scam Create2 addresses. Most funds sent to the Drainer Customer were burned by the Solv Protocol.</li></ul></li><li><p>BingXOfficial</p><ul><li>Attack Vector: Hot Wallet Compromise</li><li>Damage: $6,840,000</li><li>Description: On September 20, BingX&#x27;s technical team detected abnormal network access, suspecting a hacker attack on their hot wallet. Emergency measures were taken, including asset transfer and withdrawal suspension.</li></ul></li><li><p>ALEXLabBTC</p><ul><li>Attack Vector: Private Key Compromise</li><li>Damage: $4,300,000</li><li>Description: Hacker compromised a key and made a malicious proxy upgrade. The Alex deployer account performed five identical upgrades to the “Bridge Endpoint” contract on BNB Smart Chain, resulting in the removal of approximately $4.3 million.</li></ul></li><li><p>BullcoinBSC</p><ul><li>Attack Vector: Hot Wallet Compromise</li><li>Damage: $2,400,000</li><li>Description: Multisig transferred ownership to a compromised address, which later upgraded the contract with a backdoor. At least three of the project&#x27;s multisig signer addresses were compromised, likely due to centralization of the keys.</li></ul></li><li><p>MEV bot</p><ul><li>Attack Vector: Lack of Validation</li><li>Damage: $2,200,000</li><li>Description: Hacker invoked the fallback function logic with a specific function selector. Funds were bridged to ETH within nine hours of deployment. Executors included the hacker.</li></ul></li><li><p>NFPrompt</p><ul><li>Attack Vector: Private Key Compromise</li><li>Damage: $1,500,000</li><li>Description: Hackers compromised wallets, including those of NFP’s contract administrators, gaining control of victims&#x27; funds, including a portion of NFP treasury and ecosystem fund.</li></ul></li><li><p>CUT2024CUT</p><ul><li>Attack Vector: Price Manipulation</li><li>Damage: $1,450,000</li><li>Description: The $CUT token&#x27;s price protection mechanism was vulnerable to price manipulation. The exploiter gained extra $CUT tokens and sold them, profiting ~$1.4m from the BUSD-CUT pancake pair.</li></ul></li><li><p>Duelbits</p><ul><li>Attack Vector: Hot Wallet Compromise</li><li>Damage: $1,100,000</li><li>Description: The Duelbits crypto casino and sports betting website was drained. The thief accessed a Duelbits wallet, likely through a private key compromise.</li></ul></li><li><p>CoinsPaid</p><ul><li>Attack Vector: Hot Wallet Compromise</li><li>Damage: $1,000,000</li><li>Description: On July 22, CoinsPaid experienced a hacker attack, likely by the Lazarus group from DPRK.</li></ul></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2024-highlights">2024 highlights<a href="#2024-highlights" class="hash-link" aria-label="Direct link to 2024 highlights" title="Direct link to 2024 highlights">​</a></h4><ul><li><p>Our Chrome Extension user base grew exponentially, reaching almost 1,000 users, which is a growth of more than 300% from the start of the year.</p></li><li><p>We joined partnerships with critical infrastructure platforms in the space, such as 48Club and Token Pocket, to reduce scams and frauds on BNB Chain.</p></li><li><p>Released countless tweets to raise user security awareness, covering topics such as spotting fake Pig Butchering sites, identifying phishing scams like Drainers and Spoofers, and numerous other scam warnings. These tweets amassed over 788,000 views and attracted more than 2,400 new followers to our HashDit X account.</p></li></ul></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/smart-contract-security">smart-contract-security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/end-of-year-report">end-of-year-report</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/bsc">bsc</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Overview"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/bsc-2024-quarter-three-report">2024 Q3 BSC Security Report</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-10-15T00:00:00.000Z" itemprop="datePublished">October 15, 2024</time> · <!-- -->14 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>This report focuses on security events that occurred on BNB Smart Chain (BSC) in Q3 of 2024. It analyzes the types of projects targeted, the common attack techniques used and the financial losses that resulted from the incidents.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disclaimer">Disclaimer<a href="#disclaimer" class="hash-link" aria-label="Direct link to Disclaimer" title="Direct link to Disclaimer">​</a></h3><p>The financial data provided here is accurate based on our own monitoring system and based on the $USD amount of the cryptocurrency involved at the time of the incident. Due to the fluctuating price nature of cryptocurrencies, the total amount loss might differ with the current token valuations.</p><p>Furthermore, the financial data might not fully reflect the true “exploited amount” of the incident. This is especially true for scams where the total scammed amount is usually mixed with an initial base amount injected by the scam project party.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tldr">TL;DR<a href="#tldr" class="hash-link" aria-label="Direct link to TL;DR" title="Direct link to TL;DR">​</a></h2><ol><li><strong>Q3 sees increase in fiat losses compared to Q2</strong></li></ol><p>Fiat losses increased by approximately 50%, rising from $9.1 million in Q2 to $14.2 million in Q3. Interestingly, this increase in losses was observed despite a decrease in the number of hacks, with Q3 experiencing 34 hacks compared to 46 in Q2.</p><ol start="2"><li><strong>BSC ranks second in Q3 fiat losses when compared to other chains</strong></li></ol><p>In Q3, BSC (Binance Smart Chain) accounted for 2.8% of the total fiat losses across all chains, ranking second. Ethereum took first place, representing 88% of the total fiat losses. In terms of incident count, BSC also ranked second with 27%, trailing behind Ethereum.</p><ol start="3"><li><strong>Price Manipulation and Lack of Validation bugs were the two most substantial types of exploit, with DeFi type of projects being the most targeted</strong></li></ol><p>32% of total fund losses were due to price manipulation attacks, often caused by poorly designed smart contracts relying on liquidity pool prices. The second leading attack vector was lack of validation, accounting for 23.53%, due to developers not checking input validation in smart contracts, leading to compromised contracts. Other issues included reentrancy, spoofing, and rug pulls.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="q3-comparisons">Q3 Comparisons<a href="#q3-comparisons" class="hash-link" aria-label="Direct link to Q3 Comparisons" title="Direct link to Q3 Comparisons">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bsc-comparisons">BSC Comparisons<a href="#bsc-comparisons" class="hash-link" aria-label="Direct link to BSC Comparisons" title="Direct link to BSC Comparisons">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="yoy-comparison">YoY Comparison<a href="#yoy-comparison" class="hash-link" aria-label="Direct link to YoY Comparison" title="Direct link to YoY Comparison">​</a></h4><p>When we compare the data with Q3 of previous years, there is a decreasing trend. Q3 financial losses dropped by a large 68% between 2023 and 2024.</p><p>This suggests that the security of the BNB Chain has improved significantly over the years.</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-00915f11013c757e3d5b9a9aeb420b71.png" width="2876" height="648" class="img_ev3q"></p><p align="center">Figure 1: Q3 financial losses from 2021 - 2024</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2024-q3-vs-2024-other-quarters">2024 Q3 vs 2024 other quarters<a href="#2024-q3-vs-2024-other-quarters" class="hash-link" aria-label="Direct link to 2024 Q3 vs 2024 other quarters" title="Direct link to 2024 Q3 vs 2024 other quarters">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="fiat-losses">Fiat Losses<a href="#fiat-losses" class="hash-link" aria-label="Direct link to Fiat Losses" title="Direct link to Fiat Losses">​</a></h5><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-103d24c76dfc5464d58bf53f9bb76cd8.png" width="2876" height="968" class="img_ev3q"></p><p align="center">Figure 2: Financial losses across the first 3 quarters in 2024</p><ul><li><p>Q3 have the highest financial losses in a quarter in 2024</p></li><li><p>~50% increase in amount lost to exploits from Q2 to Q3</p></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="number-of-incidents">Number of Incidents<a href="#number-of-incidents" class="hash-link" aria-label="Direct link to Number of Incidents" title="Direct link to Number of Incidents">​</a></h5><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-b916ef904aecba91a187828b7b010adc.png" width="2876" height="968" class="img_ev3q"></p><p align="center">Figure 3: Number of incidents across the 3 quarters in 2024</p><p>In terms of incident count, that number dropped by 26% from Q2 to Q3 to 34 incidents this quarter.</p><p>Notable Trends</p><p>Q3 accounted for 45.10% of amount losses in 2024 so far</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-6abb5b5f7052ca678da0dde14e7e1126.png" width="2876" height="968" class="img_ev3q"></p><p align="center">Figure 4: Amount lost to exploits across the previous quarters in 2024</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="chain-comparisons">Chain Comparisons<a href="#chain-comparisons" class="hash-link" aria-label="Direct link to Chain Comparisons" title="Direct link to Chain Comparisons">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="q3-comparison-to-other-blockchains">Q3 Comparison to Other Blockchains<a href="#q3-comparison-to-other-blockchains" class="hash-link" aria-label="Direct link to Q3 Comparison to Other Blockchains" title="Direct link to Q3 Comparison to Other Blockchains">​</a></h3><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-b0aadc06a3876ec3a59eff041a50bbea.png" width="2876" height="728" class="img_ev3q"></p><p align="center">Figure 5: Proportion of funds loss across all chains in Q3</p><p>As seen in Figure 5, BSC accounts for 2.8% of total funds loss and 27% of total incident count. The top chain affected is Ethereum with 88% of the total losses in Q3 of 2024 and 55% of total incident count</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="qoq-analysis">QoQ Analysis<a href="#qoq-analysis" class="hash-link" aria-label="Direct link to QoQ Analysis" title="Direct link to QoQ Analysis">​</a></h3><p>Fiat Losses</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-228c72fdfa61827721da691248321c93.png" width="2876" height="1288" class="img_ev3q"></p><p align="center">Figure 6: Proportion of incidents across all chains from Q1-Q3 in 2024</p><p>Noticeably, Ethereum still had the highest number of financial losses in each quarter of 2024 thus far. Generally, Q2 has the lowest amount of losses in 2024 across all chains, although it had security incidents across all chains in that quarter.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deep-dive-on-2024-q3-incidents-on-bsc">Deep Dive on 2024 Q3 Incidents on BSC<a href="#deep-dive-on-2024-q3-incidents-on-bsc" class="hash-link" aria-label="Direct link to Deep Dive on 2024 Q3 Incidents on BSC" title="Direct link to Deep Dive on 2024 Q3 Incidents on BSC">​</a></h2><p>In total, roughly $14.2 million was lost as a result of security incidents on BSC in Q3. As demonstrated by Figure 7, the month with the greatest losses was October which stands at $9.4 million. </p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-705bec2c534d571bb3e4c81b5e377b7a.png" width="2876" height="1248" class="img_ev3q"></p><p align="center">Figure 7: Amount of stolen funds in dollars per month in Q3 of 2024</p><p>Figure 8 shows the number of projects impacted by exploits in Q3 .</p><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-6c1729d07b3d4c3c3e50c7d08dd6b629.png" width="2876" height="728" class="img_ev3q"></p><p align="center">Figure 8: Number of project impacted by exploits</p><p>The highest number of security incidents took place in October. In total, there were 34 incidents on BSC in Q3 2024. Similarly in September, there was the highest number of security incidents at 18.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="attack-vectors-analysis">Attack vectors analysis<a href="#attack-vectors-analysis" class="hash-link" aria-label="Direct link to Attack vectors analysis" title="Direct link to Attack vectors analysis">​</a></h3><p>Out of the total 34 security incidents, hacks made up 79.41%. The remaining percentage were a result of scams. </p><p><img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-fab387ab4fc8790f7d5a21de101cc9e3.png" width="2876" height="848" class="img_ev3q"></p><p align="center">Figure 9: Proportion of types of exploits</p><p>Proportional to the attack vector count, the financial impact of hacks was greater as well. The total financial loss of hacks was $12.7m and the total financial loss from hacks was $1.4m, as shown in Figure 10.</p><p><img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-c31cc702c266e01914e1e5c7772e5524.png" width="2876" height="848" class="img_ev3q"></p><p align="center">Figure 10: Financial impact measured in dollars comparing different types of incidents</p><p>This might suggest that there is a good emphasis on scam security for general BSC users. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="specific-attack-vectors-analysis">Specific attack vectors analysis<a href="#specific-attack-vectors-analysis" class="hash-link" aria-label="Direct link to Specific attack vectors analysis" title="Direct link to Specific attack vectors analysis">​</a></h4><p>Figure 11 shows the specific attack vectors and their corresponding financial losses in Q3 of 2024. </p><p><img loading="lazy" alt="IMG-11" src="/hashdit/assets/images/11-a72c44dc7a5e27c4c1a15e4eaa5c70a7.png" width="2876" height="888" class="img_ev3q"></p><p align="center">Figure 11: Proportion of funds lost across different types of exploits</p><p>In Q3, 32% of the total funds loss were attributed to Price Manipulation attacks. This could be due to poorly designed smart contracts relying on the instantaneous price of liquidity pools, making them easier to manipulate with a large swap trade or flash loans by hackers.</p><p>The second leading attack vector was Lack of Validation, which accounted for 23.53%. This is still a main cause of concern as we noticed developers not checking for input validation within poor designed smart contracts. This can result in untrusted calls that result in contracts being compromised.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loss-by-project-type">Loss by Project Type<a href="#loss-by-project-type" class="hash-link" aria-label="Direct link to Loss by Project Type" title="Direct link to Loss by Project Type">​</a></h3><p>When comparing the project type against financial loss, 61.76% of financial losses were attributed to DeFi projects. </p><p>The second most targeted type was Unknown contracts at 11.76% which are obscure and unknowing contracts, where their project name could not be identified. This is followed by Individuals at 11.76% which are likely a result of general users being scammed.</p><p><img loading="lazy" alt="IMG-12" src="/hashdit/assets/images/12-92817f08ca02dd153d8f3d37bd730d2e.png" width="2876" height="888" class="img_ev3q"></p><p align="center">Figure 12: Proportion of funds lost against the type of project</p><p>The large proportion of fiat losses associated with DeFi projects suggests that DeFi remains the most common type of crypto project on BSC. It also shows how important it is for users to only invest in reputable and well audited projects, and for developers to take precautions for Price Manipulation and Lack of Validation issues.</p><p>At the same time, the constant trend of Individuals getting scammed should serve as a critical reminder for users to only sign transactions that they understand and use security plug-ins where suitable.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-10-incidents-in-q3-of-2024">Top 10 Incidents in Q3 of 2024<a href="#top-10-incidents-in-q3-of-2024" class="hash-link" aria-label="Direct link to Top 10 Incidents in Q3 of 2024" title="Direct link to Top 10 Incidents in Q3 of 2024">​</a></h2><p>The following were the top 10 security incidents in terms of financial losses in Q3 of 2024. </p><p><img loading="lazy" alt="IMG-13" src="/hashdit/assets/images/13-6590111b987a0a6b1b5e519ded819025.png" width="2876" height="1048" class="img_ev3q"></p><p align="center">Figure 13: Top exploits measured in dollars in 2024 Q3 on BNB Smart Chain</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bingxofficial---68-million-loss">BingXOfficial - $6.8 Million Loss<a href="#bingxofficial---68-million-loss" class="hash-link" aria-label="Direct link to BingXOfficial - $6.8 Million Loss" title="Direct link to BingXOfficial - $6.8 Million Loss">​</a></h3><p>Attack type: Hot Wallet Compromise</p><p>On September 20, 2024, BingXOfficial, a centralized exchange (CEX), experienced a security breach in its hot wallet across multiple chains. On the Binance Smart Chain (BSC), the impact was approximately $6.8 million.</p><p>The root cause of the security breach at BingX was likely related to unauthorized access to the exchange&#x27;s hot wallet. Since hot wallets are connected to the internet, they are inherently more vulnerable to cyberattacks.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mev-bot---22-million-loss">MEV Bot - $2.2 Million Loss<a href="#mev-bot---22-million-loss" class="hash-link" aria-label="Direct link to MEV Bot - $2.2 Million Loss" title="Direct link to MEV Bot - $2.2 Million Loss">​</a></h3><p>Attack type: Internal Breach</p><p>On August 22, 2024, an unknown MEV bot was compromised, resulting in a loss of approximately $2.2 million.</p><p>Typically, this MEV bot contract is designed to exploit price differences in liquidity pools. However, the vulnerability in this case was due to a lack of validation of the pool contract supplied within the victim contract. This allowed the attacker to use a fake pool contract to perform a &quot;swap,&quot; tricking the contract into transferring funds to the attacker&#x27;s contract.</p><p>Interestingly, only Executors can call the vulnerable function, and the hacker was one of the validated addresses added during the setup. This suggests that an internal breach could be a likely scenario in this case.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cut2024cut---14-million-loss">CUT2024CUT - $1.4 Million Loss<a href="#cut2024cut---14-million-loss" class="hash-link" aria-label="Direct link to CUT2024CUT - $1.4 Million Loss" title="Direct link to CUT2024CUT - $1.4 Million Loss">​</a></h3><p>Attack type: Price Manipulation</p><p>On September 10, 2024, CUT2024CUT, a token DeFi project, was exploited due to a price manipulation attack, resulting in losses exceeding $1.4 million USD on the Binance Smart Chain (BSC).</p><p>The CUT project had implemented a vulnerable reward calculation system that depended on the pool reserves. This vulnerability allowed attackers to deplete the liquidity pool (LP) reserves.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="user---107-million-loss">User - $1.07 Million Loss<a href="#user---107-million-loss" class="hash-link" aria-label="Direct link to User - $1.07 Million Loss" title="Direct link to User - $1.07 Million Loss">​</a></h3><p>Attack type: Phishing</p><p>Throughout this quarter, we detected multiple instances of users falling victim to phishing attacks, resulting in total losses exceeding $1.07 million.</p><p>Two primary types of phishing transactions were observed:</p><ol><li><strong>Wallet Drainers</strong>: Scammers trick users into visiting phishing websites, where they are then deceived into signing transactions that transfer funds directly to the attackers.</li><li><strong>Spoofing Cases</strong>: Users are deceived into transferring funds to a recipient that appears to be legitimate but is actually a copycat.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ups---052-million-loss">UPS - $0.52 Million Loss<a href="#ups---052-million-loss" class="hash-link" aria-label="Direct link to UPS - $0.52 Million Loss" title="Direct link to UPS - $0.52 Million Loss">​</a></h3><p>Attack type: Price Manipulation</p><p>On July 21, 2024, the UPS project was compromised, resulting in a loss of approximately $0.52 million worth of funds.</p><p>The root cause of the hack was a vulnerability in the UPS token&#x27;s transfer mechanism. When transferring tokens to a PancakeSwap pair, the UPS token burns tokens at the pair and calls the &quot;sync&quot; function. The hacker exploited this mechanism to reduce the UPS reserves in the PancakeSwap pair, causing a reserves imbalance. As a result, the UPS reserve became very small, allowing the hacker to drain BUSD from the pair using only a few UPS tokens.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unknown-token-stake---035-million-loss">Unknown Token Stake - $0.35 Million Loss<a href="#unknown-token-stake---035-million-loss" class="hash-link" aria-label="Direct link to Unknown Token Stake - $0.35 Million Loss" title="Direct link to Unknown Token Stake - $0.35 Million Loss">​</a></h3><p>Attack type: Price Manipulation</p><p>On August 6, 2024, an unknown Token Stake contract was exploited due to a price manipulation attack, resulting in a loss of $0.35 million.</p><p>The root cause of the exploit was the Token Stake contract&#x27;s reliance on an instantaneous price oracle. This made it susceptible to price oracle manipulation, allowing the attacker to profit from the Token Stake contract.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xmm---029-million-loss">XMM - $0.29 Million Loss<a href="#xmm---029-million-loss" class="hash-link" aria-label="Direct link to XMM - $0.29 Million Loss" title="Direct link to XMM - $0.29 Million Loss">​</a></h3><p>Attack type: Price Manipulation</p><p>On September 14, 2024, the XMM project was hacked, resulting in a loss of approximately $0.29 million.</p><p>The hacker exploited a flaw in the transfer function that allowed the recipient to mint tokens. This vulnerability enabled the hacker to mint a large amount of XMM tokens at the start of the attack, allowing them to profit by dumping the tokens into the liquidity pool.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bankroll---023-million-loss">Bankroll - $0.23 Million Loss<a href="#bankroll---023-million-loss" class="hash-link" aria-label="Direct link to Bankroll - $0.23 Million Loss" title="Direct link to Bankroll - $0.23 Million Loss">​</a></h3><p>Attack type: Business Logic Vulnerability</p><p>On September 23, 2024, the Bankroll DeFi project was attacked due to a business logic vulnerability, resulting in a loss of approximately $0.23 million.</p><p>The root cause of the attack was a flaw in the <code>BuyFor</code> function, which allowed the invoked contract to be used as the <code>customerAddress</code>. This vulnerability enabled the attacker to transfer WBNB back into the victim contract, inflating the <code>profitPerShare_</code> value significantly in the distribute routine.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="truflation---023-million-loss">Truflation - $0.23 Million Loss<a href="#truflation---023-million-loss" class="hash-link" aria-label="Direct link to Truflation - $0.23 Million Loss" title="Direct link to Truflation - $0.23 Million Loss">​</a></h3><p>Attack type: Malware Scam</p><p>On September 25, 2024, the Truflation project, a decentralized infrastructure project, was exploited for approximately $0.23 million due to a malware scam.</p><p>The project&#x27;s multisig wallet had a 1 out of 1 threshold, making it highly vulnerable. The holder of the private key was easily compromised through malware as a result of social engineering. This allowed the malicious actor to scam the team into transferring funds to their account.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unknown-project---02-million-loss">Unknown project - $0.2 Million Loss<a href="#unknown-project---02-million-loss" class="hash-link" aria-label="Direct link to Unknown project - $0.2 Million Loss" title="Direct link to Unknown project - $0.2 Million Loss">​</a></h3><p>Attack type: Reentrancy</p><p>On September 25, 2024, an unknown project was exploited for approximately $0.2 million. The root cause was identified as a reentrancy vulnerability.</p><p>Interestingly, after the initial attack transaction, the deployer invoked the victim contract&#x27;s <code>emergencyWithdrawUSDT</code> function multiple times, each for a small amount rather than withdrawing all the funds at once. This allowed the attacker to make small, repeated profits.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>Below we have some final tips for investors and developers:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-investors">For investors:<a href="#for-investors" class="hash-link" aria-label="Direct link to For investors:" title="Direct link to For investors:">​</a></h3><ol><li><strong>Understand What You&#x27;re Signing:</strong> Never blindly sign random signatures or transactions. Always ensure signatures are from official websites.</li><li><strong>Verify Official Websites:</strong> Double-check that you are on the official website of the DApp.</li><li><strong>Exercise Caution with New/Trending Projects:</strong> Be wary of projects that guarantee high APYs or use MEV bots. Always verify the project team’s authenticity.</li><li><strong>Use Multiple Wallets:</strong> Utilize different wallets for various activities—hot wallets for frequent transactions and cold wallets for storing high-value funds.</li><li><strong>Interact with Open-Source Contracts:</strong> Ensure you are interacting with open-source contracts and revoke approval once the interaction is complete.</li><li><strong>Check Risk Warnings:</strong> Use tools like Metamask Snaps and HashDit Extension to check risk warnings of transactions.</li><li><strong>Heed Warnings on Trust Wallet and PancakeSwap:</strong> Pay attention to warnings about phishing sites, malicious contracts, and dangerous tokens. If flagged as high risk, it is strongly advised to stay away.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-bnb-chain-developers">For BNB Chain Developers:<a href="#for-bnb-chain-developers" class="hash-link" aria-label="Direct link to For BNB Chain Developers:" title="Direct link to For BNB Chain Developers:">​</a></h3><ol><li><strong>Verify &amp; Open-Source Contracts:</strong> Ensure all relevant contracts are verified and open-sourced on-chain to maintain transparency and trust.</li><li><strong>Conduct Audits:</strong> Have the project audited by at least two well-known security companies and address all identified issues, including newly added code.</li><li><strong>Implement a Bug-Bounty Program:</strong> Encourage the community to help maintain the security of the code by offering rewards for identifying vulnerabilities.</li><li><strong>Prioritize Security:</strong> Run sufficient testing, stress-testing, and simulations for scenarios such as adverse token price fluctuations and edge cases.</li><li><strong>Prevent Centralization Risks:</strong> Use multi-signature wallets instead of a single EOA wallet for operations.</li><li><strong>Minimize Contract Upgradeability:</strong> Limit contract upgradeability and apply changes only when necessary.</li><li><strong>Secure Fund Storage:</strong> Ensure funds are stored securely through proper key management and fund distribution.</li><li><strong>Implement Safeguards:</strong> Formulate an incident response plan and introduce time locks or pausing mechanisms within smart contracts to mitigate the impact of hacks.</li><li><strong>Monitor System Parameters:</strong> Continuously monitor system parameters, such as the exchange rate of tokens.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-hashdit">About Hashdit<a href="#about-hashdit" class="hash-link" aria-label="Direct link to About Hashdit" title="Direct link to About Hashdit">​</a></h3><p>HashDit’s core mission is to provide the essential threat intelligence for the everyday crypto investors to make informed decisions. Our methodology includes a variety of automated and manual techniques to evaluate a DApp project. </p><p>Hashdit Products:</p><ul><li><strong>HashDit extension</strong>: A chrome web extension which utilizes the HashDit API to warn users for potential risky urls and risky addresses. HashDit’s pop-up warning window is displayed on the frontend to immediately alert users to take extra caution.</li><li><strong>Risk assessment</strong>: All-in-one collection of security rating framework, auto-scan tools, and corresponding APIs, which are able to deliver accurate detection for potential risks based on an address / dApp / transaction / signature. This is integrated with core platforms like Trust Wallet and PancakeSwap, to leverage their reach and protect more users. </li><li><strong>Audit service</strong>: Comprehensive code audits following extensive and detailed best practices for smart contracts and discovering code loopholes/security vulnerabilities before they are deployed on-chain, guaranteeing users’ safety on BSC. </li><li><strong>Monitoring</strong>: The combination of real-time on-chain monitoring, off-chain social media monitoring, and public alerts via Twitter makes this service a valuable tool for enhancing security and awareness in the blockchain space. By detecting sensitive events and compromised social media accounts early, we can quickly respond to minimize financial losses and provide immediate guidance for account recovery. This comprehensive approach ensures that both financial transactions and communication channels are protected, helping to build transparency and trust within the community.</li><li><strong>Prevention</strong>: Transaction Prevention Solution, a proactive defense strategy for threat detection and handling. This solution enables project teams to promptly address attacks, control fund disposal, secure user assets, and establish a robust multi-layer protection system. It currently includes four strategies that can be used in combination, aiming to provide a comprehensive risk recognition and risk disposal transaction prevention system</li><li><strong>Education</strong>: The goal is to share security knowledge for builders, investors and users in the Web3 community. With all the players in the industry equipped with the security knowledge needed and adopting a security-first mindset, only then will the Web3 ecosystem be a safer place for everyone. </li></ul><p>If you have any doubts or concerns about a specific project, contract address, transaction, or risk score, please do not hesitate to reach out to our team for assistance.</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/smart-contract-security">smart-contract-security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/quarter-three-report">quarter-three-report</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/bsc">bsc</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-july-2024">Monthly Incident Sharing - July 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-08-07T00:00:00.000Z" itemprop="datePublished">August 7, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this July 2024 edition, the total losses amounted to $282.5 million, showing a 25% decrease compared to July 2023 ($377.2 million). </p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lifi-protocol---10m---lack-of-validation">Li.Fi protocol - $10m - Lack of Validation<a href="#lifi-protocol---10m---lack-of-validation" class="hash-link" aria-label="Direct link to Li.Fi protocol - $10m - Lack of Validation" title="Direct link to Li.Fi protocol - $10m - Lack of Validation">​</a></h3><p>Chain: Ethereum</p><p>Li.Fi protocol is a bridge aggregation protocol with DEX connectivity and cross-chain data messaging capabilities. On July 16 2024, in this incident, the GasZipFacet contract was upgraded, introducing a vulnerable code which resulted in a compromise of approximately $10 million.</p><p>Interestingly, a similar exploit 2 years ago, when Li.Fi was also compromised for the same vulnerability. </p><p><strong>Root cause</strong>: The primary cause of the incident was no validation of swapCallData in the LibSwap.sol library. This calldata can be externally controlled in the outer function depositToGasZipERC20 method. This allows arbitrary calls whereby funds approved to this victim contract can be abused and stolen.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x602d810c47a9022b422cf2fa32ec973f887a72df78d40e448d511e82eba5a38a" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-557e331aa80bbb5c2b3da78ba59eb848.png" width="1752" height="1054" class="img_ev3q">
<img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-a985904a623bc62348a5afb6e1c293b2.png" width="1732" height="1176" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rho-markets---76m---oracle-manipulation">Rho Markets - $7.6m - Oracle Manipulation<a href="#rho-markets---76m---oracle-manipulation" class="hash-link" aria-label="Direct link to Rho Markets - $7.6m - Oracle Manipulation" title="Direct link to Rho Markets - $7.6m - Oracle Manipulation">​</a></h3><p>Chain: Scroll</p><p>Rho Markets is a liquidity platform built on Scroll, based on an overcollateralized lending model (which is a fork of Compound Finance). On July 19, 2024, in this incident, a misconfigured oracle provided the wrong price of $ETH for the rETH market ($BTC price was fed instead). Thankfully, an MEV bot front ran the original hacker and was able to safeguard the $7.6 million and return them back to the project party.</p><p><strong>Root cause</strong>: On July 16, 2024, after updating the smart contract for a new market, Rho Markets found that ETH and BTC price oracles were giving contradictory feeds due to a deployment script misconfiguration. This reversed BTC and ETH prices, creating arbitrage opportunities for MEV bots. Incorrect oracle pricing led to assets(USDC, USDT, wstETH, STONE, and wrsETH) being borrowed up to their caps. </p><p><strong>Onchain information</strong>:</p><p><a href="https://scrollscan.com/tx/0x30879b0dbee84ba41aa1fc6ef71e81a8985bf8509796ca45f30ec4640b338db4" target="_blank" rel="noopener noreferrer">Oracle misconfiguration tx</a></p><p><a href="https://scrollscan.com/tx/0x0a7b4c6542eb8f37de788c8848324c0ae002919148a4426903b0fb4149f88f05" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Transaction snippet:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-88f0bb98090109b2cc16adaf58a2bf1b.png" width="2694" height="1020" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="doughfina---18m---lack-of-validation">DoughFina - $1.8m - Lack of Validation<a href="#doughfina---18m---lack-of-validation" class="hash-link" aria-label="Direct link to DoughFina - $1.8m - Lack of Validation" title="Direct link to DoughFina - $1.8m - Lack of Validation">​</a></h3><p>Chain: Ethereum</p><p>On July 12, 2024, DoughFina, a DeFi project, had its ConnectorDeleverageParaswap contract compromised, resulting in a loss of ~$1.8 million. In this attack, there was a lack of validation issue which allowed anyone to withdraw funds from the vulnerable contract.</p><p><strong>Root cause</strong>: The primary cause of the incident was that there is lack of validation in the flash loan call back data which leads to a WETH transfer.</p><p>After invoking the flashloan method of the ConnectorDeleverageParaswap contract, the flash loan call data allowed multiple operations to be executed afterwards.</p><p>This allowed the hacker to burn AaveWETH from one of Dough’s pools. WETH is then approved to the Victim contract which can then be transferred from out to the hacker.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x92cdcc732eebf47200ea56123716e337f6ef7d5ad714a2295794fdc6031ebb2e" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://etherscan.io/tx/0x28a934816ed0371a3fbb2f89986eecf87a22937c40309ff2f58697792215b4da" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-ef034d503034ce87790b80a33d4fb802.png" width="2442" height="438" class="img_ev3q">
<img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-66a9c09abd385750549545ae979fed40.png" width="2424" height="970" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minterest---14m---exchange-rate-manipulation">Minterest - $1.4m - Exchange rate manipulation<a href="#minterest---14m---exchange-rate-manipulation" class="hash-link" aria-label="Direct link to Minterest - $1.4m - Exchange rate manipulation" title="Direct link to Minterest - $1.4m - Exchange rate manipulation">​</a></h3><p>Chain: Mantle</p><p>Minterest is a blockchain cross-chain DeFi lending protocol that redistributes 100% of the value captured back to users. On July 15, 2024, its MUSDYToken_Mantle contract was compromised, leading to an estimate loss of ~$1.4m on Mantle (ETH and Taiko not affected).</p><p><strong>Root cause</strong>: The exchange rate of the Minterest is dependent on the token cash balance (updated immediately during token transfers, instead of at the end of the state).</p><p>Reentrancy vulnerability in which an attacker could loan out tokens that they had previously just borrowed from the protocol.</p><p><strong>Onchain information</strong>:</p><p><a href="https://explorer.mantle.xyz/tx/0xb3c4c313a8d3e2843c9e6e313b199d7339211cdc70c2eca9f4d88b1e155fd6bd" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-f8b66ba4df3f76d4e70fc614fc70a4fc.png" width="2596" height="614" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monoswap---13m---social-engineering">Monoswap - $1.3m - Social Engineering<a href="#monoswap---13m---social-engineering" class="hash-link" aria-label="Direct link to Monoswap - $1.3m - Social Engineering" title="Direct link to Monoswap - $1.3m - Social Engineering">​</a></h3><p>Chain: Blast</p><p>Monoswap is a community-driven and yield-focused v3 Decentralized Exchange built to facilitate the Blast ecosystem.. On the 24th of July, 2024, due to a social engineering exploit of one of its developers, the deployer wallet was compromised, resulting in financial losses approximating $1.3 million in ETH. </p><p><strong>Root cause</strong>: One of Monoswap developers installed phishing software from https<!-- -->[:]<!-- -->//kakaocall<!-- -->[.]<!-- -->kr. The scammer pretended to be a VC institution to deceive the developer&#x27;s trust and carried out phishing attacks.</p><p><strong>Onchain information</strong>:</p><p><a href="https://blastscan.io/tx/0xc78fdbaa98e7652a3495df6fcdb5797d8ecf949e014b11c72fe1421e3f806272" target="_blank" rel="noopener noreferrer">Hack tx 1</a> </p><p><a href="https://blastscan.io/tx/0x348bee9fb6ceb6512f7b095702f6e0616870b7c1befbe94c5e42a86b48eaa9c7" target="_blank" rel="noopener noreferrer">Hack tx 2</a> </p><p><a href="https://blastscan.io/tx/0x430efd649ef7a5273f2fa084dc330d1326766a4811e2c35d568a83bd0bc9bfd8" target="_blank" rel="noopener noreferrer">Hack tx 3</a></p><p>Transaction snippet:</p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-f4841e020510bef8406699d2ec4c5b5b.png" width="2730" height="350" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>Given the risk of social engineering attacks, it is essential for employees to install only trusted software and exercise heightened caution when working with third parties. Specifically, be vigilant for potential red flags, including:</p><ul><li><p><strong>Educate and Train Team Members:</strong> </p><ul><li><p><strong>Awareness Programs</strong>: Regularly conduct training sessions to educate team members about the various types of social engineering attacks, such as phishing, vishing (voice phishing), and smishing (SMS phishing).</p></li><li><p><strong>Simulated Attacks</strong>: Perform simulated social engineering attacks to test and improve the team&#x27;s response to real threats.</p></li><li><p><strong>Trusted Software</strong>: Always verify the source before installing any software. Ensure that you download applications only from official websites or trusted platforms, and avoid using pirated or cracked versions. Additionally, check for reviews and ratings, and consult with your IT department if you are unsure about the legitimacy of the software.</p></li></ul></li><li><p><strong>Secure Communication Channels:</strong> </p><ul><li><p><strong>Encrypted Communication</strong>: Use encrypted communication channels for sensitive information and authentication processes.</p></li><li><p><strong>Verification Protocols</strong>: Establish protocols for verifying the identity of individuals before sharing sensitive information or performing critical actions.</p></li></ul></li><li><p><strong>Limit Access and Permissions:</strong> </p><ul><li><p><strong>Role-Based Access Control (RBAC)</strong>: Implement RBAC to ensure that team members only have access to the information and systems necessary for their role.</p></li><li><p><strong>Regular Audits</strong>: Conduct regular audits of access permissions to ensure they are up-to-date and appropriate.</p></li></ul></li></ul></li><li><p>Input validation is a crucial process - it&#x27;s essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:</p><ul><li><p><strong>Calldata Parameters:</strong> Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.</p></li><li><p><strong>User Approvals:</strong> During the process where the protocol contract manages users&#x27; approvals, meticulous input checks are paramount to prevent potential malicious activities.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries</strong>: Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle</strong>: Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li><li><p><strong>Test scripts</strong>: Test scripts can be designed to check the integrity of the data being fed into the Oracle system. By running these scripts, you can ensure that the data is accurate, complete, and consistent with the expected format and values. This helps in identifying and correcting any discrepancies early in the process.</p></li></ul></li><li><p>Tips to Prevent Exchange Rate Manipulation:</p><ul><li><p><strong>Educate and Train Team Members:</strong> Use multiple, independent oracle sources to fetch exchange rates. Aggregating data from various sources can help ensure accuracy and reduce the risk of manipulation from a single compromised source.</p></li><li><p><strong>Use Strong 2FA Mechanisms:</strong> Implement validation checks to ensure the consistency and accuracy of exchange rate data. Cross-verify rates with other reliable sources to detect anomalies.</p></li><li><p><strong>Monitor and Respond to Suspicious Activity:</strong> Ensure that exchange rate data is transmitted securely using encryption protocols. This helps prevent interception and tampering of data during transmission.</p></li><li><p><strong>Secure Communication Channels:</strong>  In the context of exchange rate systems, a reentrancy attack could be particularly damaging. For example, if an exchange rate contract is vulnerable to reentrancy, an attacker could exploit this to manipulate the exchange rates.</p><ul><li><p><strong>Checks-Effects-Interactions Pattern:</strong> Ensure that state changes are made before any external calls. This reduces the risk of reentrancy attacks.</p></li><li><p><strong>Reentrancy Guards:</strong> Implement reentrancy guards, such as mutexes, to prevent multiple calls to a function before the first call is resolved.</p></li></ul></li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/july">July</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Overview"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/bsc-2024-half-year-report">2024 H1 BSC Security Report</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-08-06T00:00:00.000Z" itemprop="datePublished">August 6, 2024</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h1>Hashdit 2024 BNB Smart Chain (BSC) H1 Security Report</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>This report focuses on security events that happened on BSC in 2024 H1, analyzing the type of projects targeted and sharing the common attack techniques used in 2024 H1, with respect to the financial loss of the incidents.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disclaimer">Disclaimer<a href="#disclaimer" class="hash-link" aria-label="Direct link to Disclaimer" title="Direct link to Disclaimer">​</a></h3><p>The financial data provided here is accurate based on our own monitoring system and based on the $USD amount of the cryptocurrency involved at the time of the incident. Due to the fluctuating price nature of cryptocurrencies, the total amount loss might differ with the current token valuations.</p><p>Furthermore, the financial data might not fully reflect the true “exploited amount” of the incident. This is especially true for scams where the total scammed amount is usually mixed with an initial base amount injected by the scam project party.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2024-h1-in-focus">2024 H1 in focus<a href="#2024-h1-in-focus" class="hash-link" aria-label="Direct link to 2024 H1 in focus" title="Direct link to 2024 H1 in focus">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general">General<a href="#general" class="hash-link" aria-label="Direct link to General" title="Direct link to General">​</a></h3><p>In 2024 H1, approximately $17.29 million were lost to 73 security incidents on BSC. By observing the monthly chart below, the months with the top amount loss were May, March followed by January. The highest number of security incidents took place in April at 17.</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-673ee2e1685686537bfb6bed97390fdb.png" width="2876" height="1248" class="img_ev3q"></p><p align="center">Figure 1: Amount of stolen funds in dollars and number of incidents per month in 2024 H1</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="against-other-chains">Against other chains<a href="#against-other-chains" class="hash-link" aria-label="Direct link to Against other chains" title="Direct link to Against other chains">​</a></h3><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-34a0ee94a8e4c2c6e8ab46e2848035f4.png" width="2876" height="1008" class="img_ev3q"></p><p align="center">Figure 2: Financial Loss and number of exploits across chains for 2024 H1 (Smaller chain incidents are grouped under “Others”)</p><p>In the first half of 2024, BSC recorded $17.29 million in losses across 73 incidents, accounting for 1.4% of the total losses. Among all blockchains, BSC ranked 8th in terms of financial losses and 2nd in the number of exploits.</p><p>In contrast, Ethereum experienced the highest losses and the greatest number of attacks. Continuing the trend from 2023, Ethereum remained the blockchain with the largest loss amount in the first half of 2024. There were 208 exploits on Ethereum, resulting in $535 million in losses, which represented 43% of the total losses.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="with-h1-previous-years">With H1 previous years<a href="#with-h1-previous-years" class="hash-link" aria-label="Direct link to With H1 previous years" title="Direct link to With H1 previous years">​</a></h3><p>When we compare the data with H1 of previous years, there is a decreasing trend of financial losses (excluding 2020), which can signify that the security posture of BNB Chain has improved over the years. </p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-d3037d6e1d0c87adcf10071d5c0b95fc.png" width="2876" height="648" class="img_ev3q"></p><p align="center">Figure 3: Financial Loss across the previous H1 of 2020 - 2024</p><p>In 2021, the decentralized finance (DeFi) market experienced unprecedented growth, with numerous protocols launching without adequate security measures. This lack of security awareness allowed malicious actors to exploit vulnerabilities.</p><p>Since then, there has been a stronger emphasis on security for DeFi protocols, leading to a significant reduction in impactful exploits. As a result, financial losses in the first half of 2024 dropped by 83% compared to the same period in 2023 ($101 million), marking a substantial improvement.
Attack vectors analysis</p><p>Out of the 73 security incidents, hacks take up 80.82%, while 19.18% are scams.</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-8aef0a68baaf1deb5b17087438c919af.png" width="2876" height="848" class="img_ev3q"></p><p align="center">Figure 4: Proportion of different type of exploits</p><p>This correlates to the financial loss of hacks and scams in the first half of 2024. The total financial loss of hacks ($14.9m) is nearly 7x that of notable scams ($2.3m), as shown below in Figure 5 below.</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-cb4ecd720d58d0f50266af6c4551b98a.png" width="2876" height="848" class="img_ev3q"></p><p align="center">Figure 5: Financial impact measured in dollars comparing different types of incidents</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="specific-attack-vectors-analysis">Specific attack vectors analysis<a href="#specific-attack-vectors-analysis" class="hash-link" aria-label="Direct link to Specific attack vectors analysis" title="Direct link to Specific attack vectors analysis">​</a></h3><p>Figure 6 displays the specific attack vectors against its number of exploits in 2024 H1.</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-b6884198d720431641324cf500d08b65.png" width="2876" height="888" class="img_ev3q"></p><p align="center">Figure 6: Proportion of the funds lost comparing the different type of vulnerabilities</p><p>Looking at the breakdown of attack vectors, 35% of the attacks were attributed to price manipulation vulnerabilities. The second most common attack vector was due to a lack of validation, while the third most common attack vector was private key compromise, accounting for 8.15% of the attacks.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loss-by-project-type">Loss by Project Type<a href="#loss-by-project-type" class="hash-link" aria-label="Direct link to Loss by Project Type" title="Direct link to Loss by Project Type">​</a></h3><p>When focusing on the project type vs financial loss, 32.87% of financial loss are attributed to DeFi projects. </p><p>The 2nd most project type targeted was Bridge projects at 29.61%, followed by CEX or Centralized Exchanges at 9.57%.</p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-228e6bf5d7f82d39848160cfce56cb42.png" width="2876" height="888" class="img_ev3q"></p><p align="center">Figure 7: Proportion of funds lost comparing the type of project</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="top-10-incidents-in-2024-h1">Top 10 incidents in 2024 H1<a href="#top-10-incidents-in-2024-h1" class="hash-link" aria-label="Direct link to Top 10 incidents in 2024 H1" title="Direct link to Top 10 incidents in 2024 H1">​</a></h3><p>The following were the top 10 security incidents in terms of financial loss in 2024 H1. </p><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-4af1bfc11f42212b24b1008ed0dd4135.png" width="2876" height="1008" class="img_ev3q"></p><p align="center">Figure 8: Top exploits measured in dollars in 2024 H1 on the BNB Smart Chain</p><p>The top 10 exploits resulted in a total loss of $12.98 million. Notably, 7 out of these 10 incidents were due to private key compromises, which collectively accounted for $9.91 million, representing a significant 76% of the total losses. This highlights a concerning trend in the nature of exploits, emphasizing the critical need for enhanced security measures to protect private keys.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="alexlabbtc---43-million-loss">AlexLabBTC - $4.3 Million Loss<a href="#alexlabbtc---43-million-loss" class="hash-link" aria-label="Direct link to AlexLabBTC - $4.3 Million Loss" title="Direct link to AlexLabBTC - $4.3 Million Loss">​</a></h4><p>Attack type: Private key compromise </p><p>On May 15, the AlexLabBTC bridge on Binance Smart Chain (BSC) was compromised. The attacker gained control of the bridge upgrader role&#x27;s key and executed a malicious proxy upgrade. This upgrade introduced a harmful withdrawal method, which allowed the hacker to drain the bridge&#x27;s funds.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="user---154-million-loss">User - $1.54 Million Loss<a href="#user---154-million-loss" class="hash-link" aria-label="Direct link to User - $1.54 Million Loss" title="Direct link to User - $1.54 Million Loss">​</a></h4><p>Attack type: Social Engineering and Phishing </p><p>In the first half of the year, users on Binance Smart Chain (BSC) have incurred losses amounting to at least $1.54 million in cryptocurrency. These losses are predominantly attributed to social engineering and phishing attacks, which have been disseminated through fake social media accounts, fraudulent websites, and phishing emails. A significant contributor to these attacks is Inferno Drainer, a malicious wallet drainer that specifically targets and steals funds from ordinary users.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nfprompt---15-million-loss">NFPrompt - $1.5 Million Loss<a href="#nfprompt---15-million-loss" class="hash-link" aria-label="Direct link to NFPrompt - $1.5 Million Loss" title="Direct link to NFPrompt - $1.5 Million Loss">​</a></h4><p>Attack type: Private key compromise </p><p>On March 14, NFPrompt, a DeFi protocol, experienced a security breach. The attack targeted one of its Swap contracts containing USDT and NFP. The hacker compromised the owner&#x27;s private key, enabling them to invoke an owner-privileged withdrawal function. This allowed the attacker to retrieve all the funds held in the contract.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="duelbits---11-million-loss">Duelbits - $1.1 Million Loss<a href="#duelbits---11-million-loss" class="hash-link" aria-label="Direct link to Duelbits - $1.1 Million Loss" title="Direct link to Duelbits - $1.1 Million Loss">​</a></h4><p>Attack type: Hot wallet compromise</p><p>On February 14, the gambling platform Duelbits was attacked, resulting in the theft of approximately $1.1 million worth of cryptocurrency. The stolen funds were subsequently bridged to Ethereum and deposited into Tornado Cash. The primary cause of the breach was the compromise of a Duelbits hot wallet.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="coinspaid---10-million-loss">CoinsPaid - $1.0 Million Loss<a href="#coinspaid---10-million-loss" class="hash-link" aria-label="Direct link to CoinsPaid - $1.0 Million Loss" title="Direct link to CoinsPaid - $1.0 Million Loss">​</a></h4><p>Attack type: Hot wallet compromise </p><p>On January 6, the cryptocurrency exchange CoinsPaid was attacked, resulting in the theft of approximately $1 million worth of BNB funds.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xbridge---082-million-loss">XBridge - $0.82 Million Loss<a href="#xbridge---082-million-loss" class="hash-link" aria-label="Direct link to XBridge - $0.82 Million Loss" title="Direct link to XBridge - $0.82 Million Loss">​</a></h4><p>Attack type: Wrong Proxy Upgrade</p><p>On April 24, XBridge, a product of SaitaChainCoin, was attacked, resulting in a total loss of approximately $0.82 million. The breach occurred due to the project team introducing an incorrect mapping, which allowed anyone to assume a privileged role and withdraw tokens from the bridge contract.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="polyhedrazk---076-million-loss">PolyhedraZK - $0.76 Million Loss<a href="#polyhedrazk---076-million-loss" class="hash-link" aria-label="Direct link to PolyhedraZK - $0.76 Million Loss" title="Direct link to PolyhedraZK - $0.76 Million Loss">​</a></h4><p>Attack type: Private key compromise </p><p>On March 13, PolyhedraZK, an infrastructure project, was compromised, resulting in a loss of approximately $0.76 million. The hacker gained control of the key for the bridge upgrader role and executed a malicious proxy upgrade. This upgrade introduced a malicious withdrawal method, allowing the attacker to drain the bridge funds.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="financechainge---071-million-loss">FinanceChainge - $0.71 Million Loss<a href="#financechainge---071-million-loss" class="hash-link" aria-label="Direct link to FinanceChainge - $0.71 Million Loss" title="Direct link to FinanceChainge - $0.71 Million Loss">​</a></h4><p>Attack type: Lack of validation</p><p>On April 15, FinanceChainge was attacked, resulting in a loss of $0.71 million. The breach was primarily due to a validation bug in a contract, which allowed the hacker to steal approved funds.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="bitforex---066-million-loss">BitForex - $0.66 Million Loss<a href="#bitforex---066-million-loss" class="hash-link" aria-label="Direct link to BitForex - $0.66 Million Loss" title="Direct link to BitForex - $0.66 Million Loss">​</a></h4><p>Attack type: Hot wallet compromise</p><p>On February 26, the cryptocurrency exchange BitForex was compromised, resulting in the theft of approximately $0.66 million worth of funds.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="serenityshield---059-million-loss">SerenityShield - $0.59 Million Loss<a href="#serenityshield---059-million-loss" class="hash-link" aria-label="Direct link to SerenityShield - $0.59 Million Loss" title="Direct link to SerenityShield - $0.59 Million Loss">​</a></h4><p>Attack type: Private key compromise </p><p>On February 27, the infrastructure project SerenityShield had one of its hot wallets compromised, which resulted in approximately $0.59 million worth of funds stolen. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>In the first half of 2024, total losses caused by hacks, phishing scams, and rug pulls dropped to $17.2 million, compared to $101 million in the same period in 2023. This significant reduction indicates an overall improvement in the security situation on Binance Smart Chain (BSC).</p><p>In 2023, the most damaging attack vector was rug pulls. However, in 2024, the most damaging attacks have shifted to price manipulation. This change underscores the critical need for web3 projects to avoid reliance on the instantaneous price of liquidity pools and not depend solely on the balance of tokens in a contract. It is essential to consider the risks associated with flash loans and direct transfers that can impact token prices. To enhance security, projects should consider using entity oracles like Chainlink for a secure price feed.</p><p>Below we have some final tips for investors and developers:</p><p>For investors:</p><ol><li><strong>Understand What You&#x27;re Signing:</strong> Never blindly sign random signatures or transactions. Always ensure signatures are from official websites.</li><li><strong>Verify Official Websites:</strong> Double-check that you are on the official website of the DApp.</li><li><strong>Exercise Caution with New/Trending Projects:</strong> Be wary of projects that guarantee high APYs or use MEV bots. Always verify the project team’s authenticity.</li><li><strong>Use Multiple Wallets:</strong> Utilize different wallets for various activities—hot wallets for frequent transactions and cold wallets for storing high-value funds.</li><li><strong>Interact with Open-Source Contracts:</strong> Ensure you are interacting with open-source contracts and revoke approval once the interaction is complete.</li><li><strong>Check Risk Warnings:</strong> Use tools like Metamask Snaps and HashDit Extension to check risk warnings of transactions.</li><li><strong>Heed Warnings on Trust Wallet and PancakeSwap:</strong> Pay attention to warnings about phishing sites, malicious contracts, and dangerous tokens. If flagged as high risk, it is strongly advised to stay away.</li></ol><p>For developers:</p><ol><li><strong>Verify &amp; Open-Source Contracts:</strong> Ensure all relevant contracts are verified and open-sourced on-chain to maintain transparency and trust.</li><li><strong>Conduct Audits:</strong> Have the project audited by at least two well-known security companies and address all identified issues, including newly added code.</li><li><strong>Implement a Bug-Bounty Program:</strong> Encourage the community to help maintain the security of the code by offering rewards for identifying vulnerabilities.</li><li><strong>Prioritize Security:</strong> Run sufficient testing, stress-testing, and simulations for scenarios such as adverse token price fluctuations and edge cases.</li><li><strong>Prevent Centralization Risks:</strong> Use multi-signature wallets instead of a single EOA wallet for operations.</li><li><strong>Minimize Contract Upgradeability:</strong> Limit contract upgradeability and apply changes only when necessary.</li><li><strong>Secure Fund Storage:</strong> Ensure funds are stored securely through proper key management and fund distribution.</li><li><strong>Implement Safeguards:</strong> Formulate an incident response plan and introduce time locks or pausing mechanisms within smart contracts to mitigate the impact of hacks.</li><li><strong>Monitor System Parameters:</strong> Continuously monitor system parameters, such as the exchange rate of tokens.</li></ol><p>Hashdit is a leading Web3 security firm dedicated to monitoring and protecting against hacks and scams. Our mission is to deliver top-tier products that safeguard users and assist developers within the Web3 space.</p><p>If you have any doubts or concerns about a specific project, contract address, transaction, or risk score, please do not hesitate to reach out to our team for assistance.</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/smart-contract-security">smart-contract-security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/half-year-report">half-year-report</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/bsc">bsc</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-june-2024">Monthly Incident Sharing - June 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-07-17T00:00:00.000Z" itemprop="datePublished">July 17, 2024</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this June 2024 edition, the total losses amounted to $56.4 million, showing a 276% increase compared to June 2023 ($15 million). </p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="uwulend---237m---price-manipulation">Uwulend - $23.7m - Price Manipulation<a href="#uwulend---237m---price-manipulation" class="hash-link" aria-label="Direct link to Uwulend - $23.7m - Price Manipulation" title="Direct link to Uwulend - $23.7m - Price Manipulation">​</a></h3><p>Chain: Ethereum</p><p>Uwulend is a DeFi protocol where users can participate as depositors, borrowers or LP stakers. Depositors provide liquidity to the market to earn a passive income, while borrowers are able to borrow in an overcollateralized (perpetually) fashion. On June 10 2024, in this incident, the Market contracts used an unreliable averaged-out oracle which resulted in an initial compromise of $20 million.</p><p>After the project paused and unpaused the protocol, they were once again exploited for another $3.7 million just 3 days later.</p><p><strong>Root cause</strong>: The price oracle used took 11 different prices, and used the median price as the price oracle. However, 5 of these prices were spot prices and directly under the control of the attacker. This meant that only one EMA price needed to be manipulated.</p><p>The second issue is that the input prices are in USDE, but the oracle output is in sUSDE, which currently trades around 1.08. The oracle converts between them with an owner controlled conversion factor. This conversion was set to 1.03 three months ago, and has been steadily more wrong over time as the price of sUSDE goes up with yield.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x242a0fb4fde9de0dc2fd42e8db743cbc197ffa2bf6a036ba0bba303df296408b" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-521d400b06eb25a80b027e079131f900.png" width="1544" height="932" class="img_ev3q">
<img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-e9e353765ca1157e84369ad14d35c857.png" width="1548" height="494" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="velocore---68m---lack-of-validation">Velocore - $6.8m - Lack of validation<a href="#velocore---68m---lack-of-validation" class="hash-link" aria-label="Direct link to Velocore - $6.8m - Lack of validation" title="Direct link to Velocore - $6.8m - Lack of validation">​</a></h3><p>Chain: Linea &amp; Zksync</p><p>On the 2nd of June, 2024, Velocore is a Layer-2 protocol that leverages ZK technology to enhance Ethereum scalability. Due to a Lack of validation vulnerability in the smart contract, Velocore experienced a security breach on June 2nd, 2024, resulting in financial losses approximating $6.8 million in ETH.</p><p><strong>Root cause</strong>: The root cause of this compromise was due to vulnerabilities within the Balancer-style CPMM pool contract, specifically the ‘velocore__execute’ function. The vulnerability here is that <code>effectiveFee1e9</code> was allowed to exceed 100% - that is 1e18 (take note of the ‘unchecked’ block). This resulted in an underflow, changing a withdrawal into a large deposit.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x47e123af93add709bc2516f6a5db057dfbb1d66a75b693cd7980cd3eb28c7357" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><a href="https://www.bscscan.com/tx/0x55bb186c80834ffe00ac673b02fb1e70ac4fad56d4407afcf8bf4f1d716f579e" target="_blank" rel="noopener noreferrer">Malicious upgrade tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/6-6d6192dc3c4971ece4857bc657dca424.png" width="1528" height="414" class="img_ev3q">
<img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/7-dd63cc89045ad53f9372f219bc262f16.png" width="1546" height="278" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loopring---5m---social-engineering">Loopring - $5m - Social Engineering<a href="#loopring---5m---social-engineering" class="hash-link" aria-label="Direct link to Loopring - $5m - Social Engineering" title="Direct link to Loopring - $5m - Social Engineering">​</a></h3><p>Chain: Ethereum</p><p>Loopring is a zkRollup Layer 2. It allows for high-throughput, low-cost trading and payment on Ethereum. On June 9, 2024, in this attack, some Loopring Smart Wallets were targeted in a security breach. Subsequently, the attacker transferred assets out of the affected wallets. This resulted in a loss of approximately $5 million across the wallets.</p><p><strong>Root cause</strong>: The attack succeeded by compromising Loopring&#x27;s 2FA service, allowing the hacker to impersonate the wallet owner (by obtaining the right signature) and gain approval for the Recovery from the Official Guardian.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0xf0a02e3dc32e380f5fbc832981963277f7b2ce9345040ddf1f3016724b84e251" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/3-8d76f9de0fa69e36494aaed992946d18.png" width="1534" height="876" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bazaar---14m---lack-of-validation">Bazaar - $1.4m - Lack of Validation<a href="#bazaar---14m---lack-of-validation" class="hash-link" aria-label="Direct link to Bazaar - $1.4m - Lack of Validation" title="Direct link to Bazaar - $1.4m - Lack of Validation">​</a></h3><p>Chain: Blast</p><p>On June 10, 2024, Bazaar, a DeFi project, had its BazaarVaultBlast contract compromised, resulting in a loss of ~$1.4 million. In this attack, there was a lack of validation issue which allowed anyone to withdraw funds from the vulnerable contract.</p><p><strong>Root cause</strong>: The vulnerable function exitPool() did not validate its caller, which means that a malicious actor could invoke this method and parse another user’s balance to withdraw their funds to himself.</p><p><strong>Onchain information</strong>:</p><p><a href="https://blastscan.io/tx/0x7fdd140f7631f62d62f7256ee4a38af51a4723ad5d66adc9b9685bf78f750f2d" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/4-98059fd9b431f8f4353aec2aa9755ae4.png" width="1530" height="660" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="holograph---13m---insider-attack">Holograph - $1.3m - Insider Attack<a href="#holograph---13m---insider-attack" class="hash-link" aria-label="Direct link to Holograph - $1.3m - Insider Attack" title="Direct link to Holograph - $1.3m - Insider Attack">​</a></h3><p>Chain: Ethereum</p><p>Holograph is an omnichain tokenization protocol, enabling asset issuers to mint natively composable omnichain tokens. On June 13, 2024, the incident involved a misused HLG created on Mantle that was activated through Layerzero bridge. There was a Falsified packet that was executed on Mantle which resulted in a large mint of 1 billion HLG tokens on Ethereum, valued around $1.3 million at the time.</p><p><strong>Root cause</strong>: It was a private key compromise that was later on confirmed by Holograph, this was an insider attack. A former contractor exploited Holograph Protocol to mint additional HLG. The malicious actor deployed an unverified contract on Mantle, which was used to mint additional HLG.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x0cc143ccf3316d47b36a2e45577922f4ebe2374966bb22c1e9cf49c747d46396" target="_blank" rel="noopener noreferrer">Large mint tx</a></p><p><a href="https://explorer.mantle.xyz/tx/0x845dafdac3d55238e8cf005ae2daaac5f651ff4b3eaf56945377a7f6c8366449" target="_blank" rel="noopener noreferrer">Mantle packet tx</a></p><p>Transaction snippet:</p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/5-a80dd64e6f4b8191d0af5338b04f7fdc.png" width="1528" height="948" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>In light of potential insider compromises, it&#x27;s crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:</p><ul><li><p><strong>Preference for certain platforms:</strong> Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.</p></li><li><p><strong>Use of numbers:</strong> Both email addresses and Github usernames often contain numerical sequences. It&#x27;s suspected they use this as a method for tracking the identities they impersonate.</p></li><li><p><strong>Asian identities:</strong> There&#x27;s a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.</p></li><li><p><strong>Prominent educational background:</strong> The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.</p></li><li><p><strong>Codebase theft:</strong> While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.</p></li><li><p><strong>Multiple applications:</strong> They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.</p></li><li><p><strong>Premature expertise:</strong> They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Input validation is a crucial process - it&#x27;s essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:</p><ul><li><p><strong>Calldata Parameters:</strong> Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.</p></li><li><p><strong>User Approvals:</strong> During the process where the protocol contract manages users&#x27; approvals, meticulous input checks are paramount to prevent potential malicious activities.</p></li></ul></li><li><p>Here are five key tips to protect against social engineering attacks that compromise 2FA for Web3 protocol teams:</p><ul><li><p><strong>Educate and Train Team Members</strong> </p><ul><li><p><strong>Awareness Programs</strong>: Regularly conduct training sessions to educate team members about the various types of social engineering attacks, such as phishing, vishing (voice phishing), and smishing (SMS phishing).</p></li><li><p><strong>Simulated Attacks</strong>: Perform simulated social engineering attacks to test and improve the team&#x27;s response to real threats.</p></li></ul></li><li><p><strong>Use Strong 2FA Mechanisms</strong> </p><ul><li><p><strong>Hardware Tokens</strong>: Encourage the use of hardware-based 2FA tokens (e.g., YubiKey) instead of SMS-based 2FA, which is more susceptible to SIM swapping attacks.</p></li><li><p><strong>App-Based 2FA</strong>: If hardware tokens are not feasible, use app-based 2FA solutions like Google Authenticator or Authy, which are more secure than SMS.</p></li></ul></li><li><p><strong>Monitor and Respond to Suspicious Activity</strong> </p><ul><li><p><strong>Anomaly Detection</strong>: Implement systems to detect and alert on unusual login attempts or behavior that could indicate a compromised account.</p></li><li><p><strong>Immediate Response</strong>: Have a clear incident response plan in place to quickly address and mitigate any suspected social engineering attacks.</p></li></ul></li><li><p><strong>Secure Communication Channels</strong> </p><ul><li><p><strong>Encrypted Communication</strong>: Use encrypted communication channels for sensitive information and authentication processes.</p></li><li><p><strong>Verification Protocols</strong>: Establish protocols for verifying the identity of individuals before sharing sensitive information or performing critical actions.</p></li></ul></li><li><p><strong>Limit Access and Permissions</strong> </p><ul><li><p><strong>Role-Based Access Control (RBAC)</strong>: Implement RBAC to ensure that team members only have access to the information and systems necessary for their role.</p></li><li><p><strong>Regular Audits</strong>: Conduct regular audits of access permissions to ensure they are up-to-date and appropriate.</p></li></ul></li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/june">June</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-may-2024">Monthly Incident Sharing - May 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-06-04T00:00:00.000Z" itemprop="datePublished">June 4, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this May 2024 edition, the total losses mounted up to $92.3 million, showing a 16% increase compared to May 2023. </p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gogalagames---217m---private-key-compromise">GoGalaGames - $21.7m - Private Key Compromise<a href="#gogalagames---217m---private-key-compromise" class="hash-link" aria-label="Direct link to GoGalaGames - $21.7m - Private Key Compromise" title="Direct link to GoGalaGames - $21.7m - Private Key Compromise">​</a></h3><p>GoGalaGames is a GameFi protocol that allows players to earn cryptocurrencies and non-fungible tokens (NFTs) through gameplay. In this incident, its minting role’s private key was compromised, leading to a mint of 5,000,000,001 GALA tokens, an estimated loss of ~$222m on ETH. Interestingly, only a portion of GALA tokens were swapped for ETH, amounting to an estimate of 5913 ETH or $22m USD.</p><p>Thankfully, funds have since been returned and sent to an address termed as Gala Fund Recovery. Also, the excess GALA tokens have been burned. </p><p><strong>Root cause</strong>: The hacker was able to compromise the private key of the original Minter account. It is unclear if it was an internal or external attack.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0xa6d90abe17d17743a9cecab84bcefb0fd0bbfa0c61bba60fd2f680b0a2f077fe" target="_blank" rel="noopener noreferrer">Mint tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-f8343487a70d36fd7127bbcea4718661.png" width="2172" height="312" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sonnefinance---20m---empty-market-attack">SonneFinance - $20m - Empty Market Attack<a href="#sonnefinance---20m---empty-market-attack" class="hash-link" aria-label="Direct link to SonneFinance - $20m - Empty Market Attack" title="Direct link to SonneFinance - $20m - Empty Market Attack">​</a></h3><p>Sonne Finance is a decentralized lending protocol for individuals, institutions and protocols to access financial services. It is a permissionless, open source and Optimistic protocol serving users on Optimism. Users can deposit their assets, use them as collateral and borrow against them. In this attack, the hacker made use of a mislapse in the protocol’s market configuration to execute an empty market attack.</p><p><strong>Root cause</strong>: Sonne was aware of the empty market bug, and planned to:</p><ul><li>timelock add a market</li><li>user add funds</li><li>timelock open up the market for use.</li></ul><p>It would work, as long as the order was followed. However, they scheduled the supportMarket operation independently, instead of using scheduleBatch. Additionally, they opened the EXECUTOR_ROLE to everyone. This essentially allowed anyone to execute the operations in any order.</p><p>The exploited solVELO market was deployed 4 days ago without any liquidity, and added to the Unitroller 2 days later after timelock. As such, this empty market was abused with direct donation to borrow funds from other markets with liquidity.  </p><p><strong>Onchain information</strong>:</p><p><a href="https://optimistic.etherscan.io/tx/0xb43748ed668c1e44cf0a3e829ca0fe24eceaee7d33d06072bb11ca99afa7f448" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://optimistic.etherscan.io/tx/0x9312ae377d7ebdf3c7c3a86f80514878deb5df51aad38b6191d55db53e42b7f0" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-10733d4f188adf37459b33ca33ed5b39.png" width="2160" height="754" class="img_ev3q">
<img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-ff9fb31399ddb561be7a1e48584e9f55.png" width="1660" height="1120" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="alexlabbtc---43m---private-key-compromise">ALEXLabBTC - $4.3m - Private Key Compromise<a href="#alexlabbtc---43m---private-key-compromise" class="hash-link" aria-label="Direct link to ALEXLabBTC - $4.3m - Private Key Compromise" title="Direct link to ALEXLabBTC - $4.3m - Private Key Compromise">​</a></h3><p>On May 15, 2024, ALEXLabBTC, a DeFi project, had an unverified contract compromised, after a malicious upgrade. The potential loss was ~$12m, however the attacker was thankfully inexperienced. The attacker was successfully able to transfer around 13.8 million STX (~$2 million) on the Stack BTC layer-2 chain. </p><p>However, on BSC where the potential damage was $4.3m, a white hat was able to secure funds, and eventually returned all 100% to the project team. On ETH, the exploiter tried to steal assets notionally worth around $5 million, but failed to do so. ALEX Lab later announced they were able to recover or secure around $4.5 million of those assets (through CEX).</p><p><strong>Root cause</strong>: Using compromised private keys obtained via a phishing attack. The exploiter was able to upgrade the code to a malicious logic contract and drain some assets from the ALEX protocol.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x47e123af93add709bc2516f6a5db057dfbb1d66a75b693cd7980cd3eb28c7357" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><a href="https://www.bscscan.com/tx/0x55bb186c80834ffe00ac673b02fb1e70ac4fad56d4407afcf8bf4f1d716f579e" target="_blank" rel="noopener noreferrer">Malicious upgrade tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-dfaeb441be11b8e35fea3a17dbb0c864.png" width="2310" height="850" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pumpfun---19m---insider-attack">Pump.fun - $1.9m - Insider Attack<a href="#pumpfun---19m---insider-attack" class="hash-link" aria-label="Direct link to Pump.fun - $1.9m - Insider Attack" title="Direct link to Pump.fun - $1.9m - Insider Attack">​</a></h3><p>Pump.fun is a Solana Based Memecoin Launchpad that allows users to deploy their own Solana tokens. The incident involved a former employee gaining pump.fun&#x27;s admin privileges, resulting in the misappropriation of approximately 12,300 SOL, valued around $1.9 million at the time.</p><p><strong>Root cause</strong>: A former employee, illegitimately taken access of the withdraw authority using their privileged position at the company, used flash loans on a Solana lending protocol.</p><p>The loans were used to borrow SOL to buy out as many memecoins until they hit 100% on their bonding curves, which allowed the exploiter to gain liquidity to repay the flash loans. This affected roughly $1.9 million out of a total of $45 million in liquidity within the bonding curve contracts during a specific timeframe.</p><p><strong>Onchain information</strong>:</p><p><a href="https://solscan.io/tx/4i1BarkRVtU1RU7eaaTBKrbeDPPVD2D2LcyGFWu1tqCJUsGfkQc61YfsCWz1mQdhknjvP862EoGhs8dgpCVShoED" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-a450da23c0d270fb4f461760884dcff8.png" width="1328" height="894" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="normie---800k---price-manipulation">NORMIE - $800k - Price Manipulation<a href="#normie---800k---price-manipulation" class="hash-link" aria-label="Direct link to NORMIE - $800k - Price Manipulation" title="Direct link to NORMIE - $800k - Price Manipulation">​</a></h3><p>On the 26th of May, 2024, the Base network suffered a damaging exploit targeted at the memecoin, NORMIE. Due to a vulnerability in the smart contract, there was an unfortunate loss of approximately 224.98 ETH.</p><p><strong>Root cause</strong>: The fundamental catalyst for the exploit was a flaw in the smart contract logic. This flaw granted the attacker the capability to trick the contract into acknowledging their address as a privileged one. This deceptive maneuver allowed them to mint tokens without authorization, circumventing crucial security measures, and consequently leading to a significant financial loss.</p><p><strong>Onchain information</strong>:</p><p><a href="https://basescan.org/tx/0xa618933a0e0ffd0b9f4f0835cc94e523d0941032821692c01aa96cd6f80fc3fd" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-9d28598704993ee0a39445212b1799bc.png" width="1314" height="280" class="img_ev3q">
<img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-7686de921cb59a4c11cf6e2651ac067f.png" width="1294" height="370" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>In light of potential insider compromises, it&#x27;s crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:</p><ul><li><p><strong>Preference for certain platforms:</strong> Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.</p></li><li><p><strong>Use of numbers:</strong> Both email addresses and Github usernames often contain numerical sequences. It&#x27;s suspected they use this as a method for tracking the identities they impersonate.</p></li><li><p><strong>Asian identities:</strong> There&#x27;s a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.</p></li><li><p><strong>Prominent educational background:</strong> The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.</p></li><li><p><strong>Codebase theft:</strong> While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.</p></li><li><p><strong>Multiple applications:</strong> They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.</p></li><li><p><strong>Premature expertise:</strong> They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Keys should be properly secured, are rotated regularly and have some level of decentralization. Adopt a <strong>zero-trust</strong> model. </p></li><li><p>For projects utilizing lending protocols:</p><ul><li>When deploying a new market (especially for Compound / Aave v2 forks), ensure that it is first <strong>initialized with 0 Collateral Factor</strong> and <strong>deploy with small deposit to lock dead shares</strong>.</li><li>Disallow deposits when the pool price is out of the base range of liquidity.</li><li>Increase precision on price change thresholds and deposit ratios.</li><li>For those allowing single-sided pool deposits, add a conditional statement to <strong>prevent deposits of any ratio of assets</strong> so long as vault is single-sided.</li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/may">May</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/bridge-scan-report">Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-16T00:00:00.000Z" itemprop="datePublished">May 16, 2024</time> · <!-- -->16 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">Chris</span></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-scan-summary-report-for-cross-chain-bridges-on-the-bnb-chain">Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain<a href="#security-scan-summary-report-for-cross-chain-bridges-on-the-bnb-chain" class="hash-link" aria-label="Direct link to Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain" title="Direct link to Security Scan Summary Report for Cross-Chain Bridges on the BNB Chain">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a href="#background" class="hash-link" aria-label="Direct link to Background" title="Direct link to Background">​</a></h3><p>A cross-chain bridge is a decentralized application that helps to transfer assets from one blockchain to another. The cross-chain bridge is a core component of Web3 infrastructure. For users, the cross-chain bridge can facilitate the seamless movement of tokens and messages between chains. Undeniably, while cross-chain bridges are vital for unleashing exponential innovation in Web3, they simultaneously open up potential avenues for exploitation by malicious entities. Bridges have become a new target for cryptocurrency crime. Vulnerabilities in these bridges are under attack, and hacking incidents are becoming increasingly notable.</p><p>To ensure the safety of users on the BNB chain, we have conducted security scans on 37 active bridge projects on the BNB chain. The scans mainly focus on two aspects:</p><ol><li>The degree of centralization in the privileged roles of the project.</li><li>The open-source status of the project&#x27;s smart contracts.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1degree-of-centralization-in-the-projects-privileged-roles">1.Degree of Centralization in the Project’s Privileged Roles<a href="#1degree-of-centralization-in-the-projects-privileged-roles" class="hash-link" aria-label="Direct link to 1.Degree of Centralization in the Project’s Privileged Roles" title="Direct link to 1.Degree of Centralization in the Project’s Privileged Roles">​</a></h4><p>The main focus here is on whether privileged role management follows good security practices. The examination includes whether a privileged role is an EOA (Externally Owned Account). When an EOA is used in a privileged role, it exposes an attack surface. If the corresponding private key is exposed, the attacker may gain control over the privileged functions, endangering the project&#x27;s economic ecosystem and user funds. Therefore, it is generally considered a better practice with a higher degree of decentralization to use multi-signature wallets, MPC (multi-party computation), or time lock contracts as privileged addresses. Using an EOA as a privileged role in a smart contract signifies a higher degree of centralization in the project.
The assessment also checks whether the threshold or other parameters for privileged roles that have already used multi-signature wallets are set reasonably. If the threshold is not set properly, the multi-signature wallet cannot reduce the degree of centralization and still carries a centralization risk.</p><p>In the real world, notable cross-chain bridge vulnerabilities due to poor security practices for privileged roles are common:</p><ul><li>Harmony Bridge (June 2022) - Two out of five private keys required to promote, approve, and execute transactions on the Harmony Bridge multi-signature were exposed. Here, the mult-sig wallet threshold is less than 51%, which is relatively low.</li><li>Multichain Bridge Hack (July 2023) - The bridge&#x27;s private key was exposed, leading to unauthorized withdrawals, all under the control of the Multichain CEO.</li><li>QANplatform (October 2022) - The cross-chain bridge project was attacked, suspected to be due to a private key leak. It resulted in a loss of approximately $1.9 million, causing the price of the QANX token to plummet.</li></ul><p>Centralized bridge projects are not only vulnerable to attacks but also enable centralized participants to unilaterally control all funds. Decentralized privileged roles help mitigate centralization risks by requiring any potential attacker (including the bridge operator) to compromise the private keys of multiple independent entities to carry out any malicious activity, thus serving as an effective form of security.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-the-open-source-status-of-the-projects-smart-contracts">2. The Open-Source Status of the Project&#x27;s Smart Contracts<a href="#2-the-open-source-status-of-the-projects-smart-contracts" class="hash-link" aria-label="Direct link to 2. The Open-Source Status of the Project&#x27;s Smart Contracts" title="Direct link to 2. The Open-Source Status of the Project&#x27;s Smart Contracts">​</a></h4><p>This scan primarily focuses on the open-source nature of a project&#x27;s smart contracts. </p><p>Since the principal function of cross-chain bridges is the transfer of value from one blockchain to another, all cross-chain protocols necessarily involve smart contracts. In most cross-chain use case scenarios, smart contracts across multiple chains are employed to facilitate functions like token minting, burning, locking, or unlocking – all crucial to efficient cross-chain movement.</p><p>Smart contracts function as both a safeguard against vulnerabilities and a potential technical risk in the event of flawed implementation. Usually, smart contracts provide a valuable mechanism for cross-chain bridges to perform integral security checks, such as ensuring the amount a user withdraws doesn&#x27;t exceed their deposits and enforcing rate limitations. On the other hand, poorly written, or unaudited smart contract code can have a substantially adverse effect: vulnerabilities within the smart contract code can be exploited by malicious hackers, who could potentially steal massive volumes of data from the cross-chain bridge.</p><p>If a cross-chain bridge smart contract on a blockchain explorer is closed source, users would not be able to understand the cross-chain logic by examining the smart contract. Similarly, it would be more difficult for users to judge the quality of the code or identify potential vulnerabilities within the smart contract. Even worse, nefarious project parties may potentially create backdoor functions within closed-source bridge smart contracts, which could lead to user funds becoming irretrievably locked. Using or approving unverified smart contracts inherently exposes users to significant financial risk.</p><p>Contrary to what some project teams may believe, failing to open-source project contracts does not necessarily prevent potential hacker attacks. In truth, experienced hackers can still make attempts on closed source project smart contracts, which impedes normal user interaction and breeds mistrust. Open-sourcing contract code not only promotes project transparency, but also helps prevent the inclusion of malicious code, ultimately fostering increased user trust. Hence, open-sourcing smart contracts is often considered to be best practice in the industry.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-check-results">Security Check Results<a href="#security-check-results" class="hash-link" aria-label="Direct link to Security Check Results" title="Direct link to Security Check Results">​</a></h3><p>The scan results show:</p><ul><li>Out of 37 projects, 12 (32%) were found to have no apparent security risks in these two aspects;</li><li>15 (41%) out of 37 projects had issues of privileged roles centralization; 9 (24%) out of 37 projects had issues related to closed-source smart contracts.</li><li>5 (13%) projects had security issues in both aspects;</li><li>The remaining 6 (16%) projects are not applicable to our scanning. 2 of the projects do not use smart contracts, instead they use Externally Owned Accounts (EOA) to transfer tokens on the chain combined with off-chain programs for cross-chain transfers. The other four projects did not develop their own cross-chain bridges, they simply provide routing selection for multiple cross-chain bridges, so our scanning doesn&#x27;t hold much significance for these types of bridge aggregators.</li></ul><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-f8f378185e8e4baba73d5d2c53bcc282.png" width="1084" height="702" class="img_ev3q"></p><p>We found a total of 239 issues with the centralization of privileged roles and 67 issues with closed-source smart contracts.</p><p>We have identified the below types of risks, which include:</p><ol><li>In some bridge projects, closed-source smart contracts exist on BSCSCAN.</li><li>In some bridge projects, the smart contracts have applied the proxy pattern. While their proxy contracts are open-source, the corresponding logic contracts are closed-source.</li><li>In some bridge projects, closed-source smart contracts are used as privileged roles in certain smart contracts.</li><li>In some bridge projects, Externally Owned Accounts (EOAs) are used as key privileged roles in smart contracts, possessing various privileged functions.</li><li>In some bridge projects, although multi-signature wallets have been used as privileged roles in smart contracts, the multi-signature wallets have set unreasonable/low thresholds (&lt;51%).</li><li>In some bridge projects, despite the use of multi-signature wallets as privileged roles in smart contracts, the number of owners set for the multi-signature wallet is unreasonable, such as only consisting of one owner. This essentially means that the degree of centralization is equivalent to that of an EOA.</li></ol><p>Through our communication and initiatives, thus far, at least four project teams have completely or partially addressed the existing issues. Therefore, currently, there are 16 projects that have implemented good security practices in these two respects. We are still actively communicating with the remaining projects.</p><p>In general, nearly 50% of the cross-chain bridge projects on the BSC chain currently have a good degree of on-chain code openness and a high level of decentralization of privileged roles. In the remaining projects, most project teams have actively responded to our scanning results, showing a willingness to continuously optimize and improve in these two aspects, and are already taking steps to do so. Therefore, the security situation of bridge projects on the BSC chain is quite optimistic. Comparatively speaking, in many other blockchains, the BSC ecosystem has a relatively high overall security for its bridges.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="best-practice-recommendations">Best Practice Recommendations<a href="#best-practice-recommendations" class="hash-link" aria-label="Direct link to Best Practice Recommendations" title="Direct link to Best Practice Recommendations">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices-for-addressing-centralization-in-privileged-roles">Best Practices for Addressing Centralization in Privileged Roles<a href="#best-practices-for-addressing-centralization-in-privileged-roles" class="hash-link" aria-label="Direct link to Best Practices for Addressing Centralization in Privileged Roles" title="Direct link to Best Practices for Addressing Centralization in Privileged Roles">​</a></h4><p>Decentralization is critical for providing security against single points of failure. We recommend solutions such as multi-signature wallets, time-lock contracts, and MPC wallets for use as privileged roles in smart contracts to reduce the level of centralization. </p><ul><li>Multi-signature is abbreviated as multisig and requires multiple private key holders to sign a transaction, usually used to prevent one party from controlling the wallet.  </li><li>A time-lock can lock certain functions of a smart contract for a specified period. It can significantly improve the security of smart contracts. For example, consider a scenario where a hacker has compromised a bridge project&#x27;s multi-signature wallet and is preparing to withdraw money from the vault, but the vault contract has a two-day lock period. Thus, from the initiation of the withdrawal transaction to the actual withdrawal of funds, the attacker will need to abide by this two-day lock period. During this period, the project team can find countermeasures, and investors can sell out their tokens preemptively to reduce losses.</li><li>MPC wallets are a subset of crypto wallets created using multi-party computation methods. They allow multiple users to create a joint wallet to store digital assets without any single point of failure. In this way, MPC wallets can ensure safety and mitigate risks, because compromising the system requires substantial effort from multiple parties. </li></ul><p>We suggest combining one or more of the above solutions as privileged roles. However, please note that whether it is a multisig wallet, a timelock contract, or an MPC wallet, reasonable parameter settings must be applied in order to truly play a role and reduce the level of centralization.</p><ul><li><p>The popular/industry standard interface currently employed for multi-signature wallets is <a href="https://hashdit.github.io/hashdit/blog/smart-wallet-migration-guide/" target="_blank" rel="noopener noreferrer">GnosisSafe</a>. When using a multi-signature wallet, it&#x27;s important to ensure a reasonable threshold is applied. The appropriate threshold for a multi-sig wallet should depend on the number of share owners and their level of trust, and it can vary based on various practical situations. There&#x27;s always a balance between absolute security and convenience. If you set an overly high signature requirement, wallet operation can become overly complex and cumbersome. On the other hand, setting too low of a signature requirement may invite risks of wallet misappropriation.
Common settings include a 2-3-4 mode (a 3-person wallet requiring 2 signatures or a 4-person wallet requiring 3 signatures), which can ensure that, in the case of a participant&#x27;s private key being stolen or the participant being inaccessible, others can continue to operate the wallet without reducing the wallet&#x27;s financial security. Generally speaking, the threshold should not be lower than 51% of the total number of owners, but the total number of owners should not be less than 2.</p></li><li><p>Determining a reasonable lock time for a time lock contract depends on several factors, such as the specific needs of the project, the level of risk tolerance, and functionality requirements.
However, it&#x27;s important to remember that the right lock time for a specific project may vary. For high-risk operations or projects in volatile markets, longer lock times may be necessary. Conversely, for lower-risk operations or stable markets, a shorter lock time might suffice. If the lock time is too short, say a few minutes, the project team may not have enough time to take any action, and then this locking procedure would be essentially in vain.
Typically, the length of lock time chosen should provide sufficient time for the contract&#x27;s stakeholders to react to changes in the contract. Popular choices are often between 24 to 72 hours for many DeFi projects, as this provides an acceptable trade-off between security and operational efficiency.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices-for-smart-contract-codes">Best Practices for Smart Contract Codes<a href="#best-practices-for-smart-contract-codes" class="hash-link" aria-label="Direct link to Best Practices for Smart Contract Codes" title="Direct link to Best Practices for Smart Contract Codes">​</a></h4><p>When using cross-chain protocols, risks associated with smart contracts are practical. The safest cross-chain bridges continuously test their codebases through private and competitive audits, along with various internal security tests such as fuzzing, static analysis, formal verification, symbolic execution, etc.</p><p>Assessing the times of a codebase has been audited and by whom can serve as a reliable signal that the cross-chain bridge in use has protection against technical attacks. Additionally, layered security measures (like enabling emergency pauses and updates, and implementing rate limits) can mitigate the impact of any smart contract errors. </p><p>With all these measures in place, open-source code benefits the project by enhancing transparency and boosting user trust. Typically, closed-source project contracts imply potential risks or even hidden malicious code, backdoor functions, and a risk of rug pulling.</p><p>It&#x27;s best to open source all contracts within the project ecosystem. This is to ensure transparency for users and to allow code auditors/white hats to verify the security of the code.</p><p>An often overlooked case of an unverified contract is when a smart contract uses a proxy pattern. A proxy contract is a contract which delegates calls to another contract. To interact with the actual(logic) contract users have to go through the proxy, and the proxy knows which contract to delegate the call to (the logic).
A proxy pattern is often used when project parities want upgradability for their contracts. This way the proxy contract stays immutable, but they can deploy a new logic contract behind the proxy contract - simply change the logic address inside the proxy contract. So that the proxy contract indeed delegates its functionality to the logic contract. Therefore, it&#x27;s dangerous when only the proxy contract is verified and the logic contract isn&#x27;t as it can&#x27;t be guaranteed that the logic contract isn&#x27;t malicious. As a best security practice, it&#x27;s better to open source not only the proxy contract but also the logic contract.</p><p>When the privileged roles of a smart contract are unverified contracts, the unverified contracts might hold some potential backdoors or malicious external interactions, it&#x27;s best to open source that smart contract code of the privileged role.</p><p>How to open source contracts:</p><ul><li>On BNB chain: <a href="https://bscscan.com/verifyContract" target="_blank" rel="noopener noreferrer">https://bscscan.com/verifyContract</a>   </li><li>On opBNB chain: <a href="https://opbnbscan.com/verifyContract" target="_blank" rel="noopener noreferrer">https://opbnbscan.com/verifyContract</a>  </li></ul><p>Furthermore, always maintain transparency with your investors - for example, create Medium articles, informing users of the addresses or updates of key contracts, etc.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recommendation-for-users">Recommendation for users<a href="#recommendation-for-users" class="hash-link" aria-label="Direct link to Recommendation for users" title="Direct link to Recommendation for users">​</a></h3><p>Before using a cross-chain bridge, users also need to conduct due diligence to ensure that they choose a bridge with effective security measures. Here are some key points:</p><ol><li><strong>Security</strong>: Check whether the cross-chain bridge has passed multiple in-depth security audits, and whether the audit results didn&#x27;t show any major issues. Also, consider how they have responded to and rectified any identified issues.</li><li><strong>Transparency</strong>: It&#x27;s important that the bridge protocol&#x27;s source code is open source and easily accessible. This can help users understand how the protocol works and identify any potential issues.</li><li><strong>Decentralization</strong>: If you have a certain understanding of smart contracts, you can check whether privileged roles in the smart contract use highly decentralized multi-signature wallets or time-lock contracts; and whether the threshold of the multi-signature wallet or the lock duration of the time-lock contract is rationally set.</li><li><strong>Community support</strong>: An active and engaged community can help keep the bridge protocol updated, adaptable to market changes, and capable of solving any problems that may arise.</li><li><strong>Performance</strong>: Observing the performance of the cross-chain bridge, including transaction speeds and costs, is also an important step. A bridge with strong performance and low cost ensures a better user experience.</li><li><strong>User Experience</strong>: User experience is another significant factor, including the usability of the interface, whether there is a comprehensive user guide, and customer support availability.</li><li><strong>Partnerships and ecosystem</strong>: It&#x27;s beneficial for users to check whether the cross-chain bridge has many partners and supports many chains, to assess the extent and maturity of its ecosystem.</li></ol><p>For cross-chain investments, due diligence is essential. You should look at official documents, white papers, security audit reports, consider community reviews, listen to expert opinions, and if possible, test their services. Find out more about it from forums, communities, or Q&amp;A websites, and conduct a comprehensive evaluation from all aspects. Don&#x27;t lightly believe in unverified information.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="glossary">Glossary<a href="#glossary" class="hash-link" aria-label="Direct link to Glossary" title="Direct link to Glossary">​</a></h3><ul><li><p><strong>EOA</strong>: Externally Owned Accounts are accounts that are controlled by a private key and have no coding associated with them. If you hold the private key associated with an EOA, you can send coins and messages from it. (E.g a Metamask account).</p></li><li><p><strong>Rugpull</strong>: A rugpull in the crypto industry is when a development team suddenly abandons a project and sells or removes all its liquidity. The name comes from the phrase to pull the rug out from under (someone), meaning to withdraw support unexpectedly.</p></li><li><p><strong>Privileged Role</strong>: In smart contracts, &quot;privileged roles&quot; often refer to certain roles or accounts within the contract that have special permissions. These accounts have the authority to perform actions that regular users cannot execute in the contract. For example, privileged roles might be able to change contract parameters, upgrade the contract, or pause the contract in emergency situations.
When designing and deploying smart contracts, these privileged roles should be managed and controlled very carefully, as they have potential risks that may be misused or abused. For instance, if a bad actor gets control of a privileged role, they might have the ability to cause abnormal contract behavior or make destructive operations, such as stealing assets stored in the contract.
Sometimes, privileged roles in a smart contract may be assigned to a multi-signature wallet, controlled collectively by multiple entities, increasing complexity and security.</p></li><li><p><strong>Multi-Sig Wallet</strong>: A multi-signature (multi-sig) wallet is a type of digital wallet that requires approval from multiple parties to authorize a cryptocurrency transaction. This type of wallet is designed to provide increased security, as it minimizes the risk of single-point failures or attacks. The &#x27;multi-signature&#x27; aspect refers to the multiple cryptographic keys involved: each co-owner of the wallet has a unique key, and a preset number (the &#x27;threshold&#x27;) of these keys must be used in concert to authorize a transaction.</p></li><li><p><strong>MPC(Multi-Party Computation)</strong>: A Multi-Party Computation (MPC) wallet utilizes multi-party computation technology, in which each party holds a piece of the private key, and computations are collaboratively concluded without revealing individual inputs. This introduces a new level of security as no single party has access to the entire private key, and transactions require authorization from multiple parties, making it extremely difficult for attackers. MPC is used in various applications such as privacy-preserving data analytics, secure voting, secret sharing, etc., including enhancing the security of crypto wallets and transactions.
Compared to multi-signature wallets, the method provided by MPC for ensuring security is different; an MPC wallet offers security through private key sharing without needing to execute a multi-party transaction on the blockchain, while multi-signature wallets offer security by approving transactions with multiple keys executed on the blockchain (leading to typically higher gas fees).</p></li></ul></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/bridge">Bridge</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/scan">Scan</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Getting Started with HashDit Snaps: A Step-by-Step Guide"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/hashdit-snaps-guide">Getting Started with HashDit Snaps - A Step-by-Step Guide</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-15T00:00:00.000Z" itemprop="datePublished">May 15, 2024</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started-with-hashdit-snaps-a-step-by-step-guide">Getting Started with HashDit Snaps: A Step-by-Step Guide<a href="#getting-started-with-hashdit-snaps-a-step-by-step-guide" class="hash-link" aria-label="Direct link to Getting Started with HashDit Snaps: A Step-by-Step Guide" title="Direct link to Getting Started with HashDit Snaps: A Step-by-Step Guide">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3><p>Meet HashDit Snaps, a revolutionary MetaMask extension designed to dramatically boost your security when interacting with smart contracts.
HashDit snap aims to protect users by screening transactions before they are executed through transaction insights. This include warnings against interactions with:</p><ul><li>Ponzi Schemes</li><li>Risky Smart Contract Interactions</li><li>Phishing Websites and Addresses</li><li>Scam Websites and Addresses</li></ul><p>HashDit snap also provides clear details about the function and arguments invoked during a smart contract interaction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h3><p><strong>Installing MetaMask</strong></p><p>As a pre-requisite, MetaMask must be installed on your browser before installing HashDit Snaps. </p><u> Metamask Installation Link </u><p>MetaMask Snaps is currently only supported on the browser version, and not the mobile version.</p><p>Installing The Snap
On the HashDit Snap website, start the installation process by clicking the Add to MetaMask button.</p><p><strong>Installing The Snap</strong></p><p>On the HashDit Snap website, start the installation process by clicking the <strong>Add to MetaMask</strong> button.</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-ae67cfa06a63c4b5209511457887c9d7.png" width="1328" height="444" class="img_ev3q"></p><p><strong>Permissions</strong>
Continue through the install and accept the requested permissions. The requested permissions are required to allow HashDit Snap to work properly.</p><ul><li>Access the internet: Allow HashDit Snap to access the internet. This is used to both send and receive data with the HashDit API.</li><li>Access the Ethereum provider: Allow HashDit Snap to communicate with MetaMask directly, in order for it to read data from the blockchain and suggest messages and transactions.</li><li>Allow websites to communicate directly with HashDit Security: Allow websites to send messages to HashDit Security and receive a response from HashDit Security.</li><li>Fetch and display transaction insights:  Allow HashDit Snap to decode transactions and show insights within the MetaMask UI. This is used for all the security features.</li><li>See the origins of websites that suggest transactions: Allow HashDit Security to see the origin (URL) of websites that suggest transactions. This is used by the URL screening feature.</li><li>Store and manage its data on your device: Allow HashDit Security to store, update, and retrieve data securely with encryption. Other snaps cannot access this information. The only data stored is the signed hash of the security message (see below). </li></ul><p>The HashDit snap does not have access to the user&#x27;s private keys. Furthermore, the only transaction initiated by the Snap is a signature request dispatched during installation.</p><p><strong>Signature Request</strong></p><p>Upon completion of the installation process, the user will be prompted to sign a security message. Note that this is only used to authenticate the HashDit API. Rejecting the signature request will <strong>prevent</strong> HashDit&#x27;s features from working. </p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-baf1cb990ded54ca2f4ec98be863bd47.png" width="674" height="1068" class="img_ev3q"></p><p>If the signature request is rejected, it can be re-prompted by just reinstalling the snap.</p><p>If you attempt to use HashDit snap without signing the security message, an error screen will be displayed.</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-4185076a57beaef5406b6559eaccd99c.png" width="850" height="854" class="img_ev3q"></p><p>Reinstalling the snap will resolve this issue.</p><p><strong>Reinstalling The Snap</strong></p><p>To update the snap or re-sign the signature request, users simply need to click the &#x27;Reconnect&#x27; button, which triggers a new installation prompt.</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-db793506acc5b4ea6cbe0e3c4d02a2ce.png" width="1096" height="480" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-hashdit-snap">How To Use HashDit Snap<a href="#how-to-use-hashdit-snap" class="hash-link" aria-label="Direct link to How To Use HashDit Snap" title="Direct link to How To Use HashDit Snap">​</a></h3><p>Using HashDit Snap is simple!
Once the HashDit Snap is installed, the security features are entirely automatic. The HashDit Snap will provide transaction insights before a transaction is executed by a user. In the transaction screen, a user can switch to the <strong>HashDit Security tab</strong> to view the risks involved with their transaction.</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-3b274a3795704e2b854db0c95e7b1385.png" width="834" height="832" class="img_ev3q"></p><p>The features of HashDit Snap are currently supported on the <strong>Binance Smart Chain Mainnet</strong> and <strong>Ethereum Mainnet</strong>. Other networks will only support URL screening.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="features">Features<a href="#features" class="hash-link" aria-label="Direct link to Features" title="Direct link to Features">​</a></h3><p><strong>Transaction Screening and Destination Screening</strong></p><p><strong>Transaction Screening</strong></p><p>The <strong>Transaction Screening</strong> insight offers a risk assessment before interacting with a smart contract. This assessment provides users with three values that shed light on potential risks associated with their transaction:
<strong>Overall Risk</strong> - The overall risk level of the transaction, which can be one of three levels
·	Low Risk
·	Medium Risk
·	High Risk
<strong>Risk Overview</strong> - The recommended action
<strong>Risk Details</strong> - Details explaining the output of the overall risk</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-7a3a7537998b6b1366f6c6f0c7a9bf28.png" width="1340" height="894" class="img_ev3q"></p><p><strong>Destination Screening</strong></p><p>The <strong>Destination Screening</strong> insight scans a transaction&#x27;s destination address against HashDit&#x27;s database of blacklisted and whitelisted addresses. This database encompasses known scamming, phishing, and trusted addresses. This assessment provides users with three values that shed light on potential risks of interaction:</p><p><strong>Overall Risk</strong> - The overall risk level of the transaction can be one of three levels
·	Low Risk
·	Medium Risk
·	High Risk
<strong>Risk Overview</strong> - The recommended action
<strong>Risk Details</strong> - Details explaining the output of the overall risk</p><p><img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-9124c6fc114f244f7e46463cd25ba317.png" width="1352" height="902" class="img_ev3q"></p><p><strong>URL Screening</strong></p><p>The URL Screening insight scans the website origin of the transaction and compares it against HashDit&#x27;s database of whitelisted and blacklisted URLs. Our database includes sites flagged as scams, deemed high-risk, and whitelisted. The insight will provide users with a risk level, ranging from -1 to 4.</p><table><thead><tr><th>Risk Level</th><th>Risk Explanation</th></tr></thead><tbody><tr><td>-1</td><td>Unknown Risk</td></tr><tr><td>0</td><td>No Risk</td></tr><tr><td>1</td><td>Low Risk</td></tr><tr><td>2</td><td>Medium Risk - Suspicious Website</td></tr><tr><td>3</td><td>Medium Risk - Dangerous Website</td></tr><tr><td>4</td><td>High Risk - Dangerous Website</td></tr></tbody></table><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-d43aabfdfba2c89aec367b15f4a0713b.png" width="1344" height="338" class="img_ev3q"></p><p><strong>Function Call Information</strong></p><p>The Function Call insight provides clear and explicit details about the function and arguments invoked during a smart contract interaction. The aim is to offer more readable parameters than Metamask&#x27;s current &#x27;Hex&#x27; tab. This is achieved by displaying each function argument, its type, and its corresponding value.</p><p><img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-9d0e275ccdddd31ed6df1df67adc1280.png" width="1350" height="986" class="img_ev3q">
<img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-e4a927ad519e394b51d285dc88ee9a52.png" width="1298" height="1576" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="links">Links<a href="#links" class="hash-link" aria-label="Direct link to Links" title="Direct link to Links">​</a></h3><p>Official Website: <a href="https://www.hashdit.io/en/snap" target="_blank" rel="noopener noreferrer">https://www.hashdit.io/en/snap</a> </p><p>Documentation and FAQ: <a href="https://hashdit.gitbook.io/hashdit-snap" target="_blank" rel="noopener noreferrer">https://hashdit.gitbook.io/hashdit-snap</a></p><p>GitHub Repo: <a href="https://github.com/hashdit/metamask-snap" target="_blank" rel="noopener noreferrer">https://github.com/hashdit/metamask-snap</a></p><p>MetaMask Snap Page: <a href="https://snaps.metamask.io/snap/npm/hashdit-snap-security/" target="_blank" rel="noopener noreferrer">https://snaps.metamask.io/snap/npm/hashdit-snap-security/</a></p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/api">API</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/integration">Integration</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-apr-2024">Monthly Incident Sharing - April 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-05-14T00:00:00.000Z" itemprop="datePublished">May 14, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this Apr 2024 edition, the total losses mounted up to $2.7 million, showing a 54% decrease compared to April 2023. </p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xbridge---103m---wrong-proxy-upgrade">XBridge - $1.03m - Wrong Proxy Upgrade<a href="#xbridge---103m---wrong-proxy-upgrade" class="hash-link" aria-label="Direct link to XBridge - $1.03m - Wrong Proxy Upgrade" title="Direct link to XBridge - $1.03m - Wrong Proxy Upgrade">​</a></h3><p>XBridge is a Bridge / Cross-Chain protocol that allows users to bridge funds from one chain to another. In this attack, a vulnerable logic contract was introduced in a proxy contract upgrade, allowing the attacker to drain 466,490,205 STC tokens, 511,424,527 SRLTY tokens and 11,165,018 Mazi tokens, amounting to ~$1.03m. Interestingly, the attacker did not liquidate all tokens, and only swapped ~$192k to BNB and deposited it into Tornado Cash, leaving some tokens in his wallet.</p><p><strong>Root cause</strong>: The listToken function in the target contract does not verify msg.sender and _tokenOwner. Essentially, as long as _baseToken==_correspondingToken, the attacker can set the key variable _tokenOwner to msg.sender which is himself, and subsequently call withdrawTokens to extract the baseToken funds directly.</p><p>The upgrade introduced a wrong mapping _tokenOwner instead of using TokenOwner (which was correctly set up in the old logic contract), anyone can thus assume _tokenOwner and withdraw tokens.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x26b1c65526a0d932c1e5589e1ec31341cf918e77247ef49d3036810c0cbb09ad" target="_blank" rel="noopener noreferrer">Bug introduced in Upgrade tx</a></p><p><a href="https://bscscan.com/tx/0xcf8aa3b9dfcf9250a5da5e9571f98374f1d649024a81b8d5f7da2f7d92f313f9" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-a49b6e7bdafe035e7269f604fc05f2c5.png" width="1302" height="1328" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="financechainge---710k---lack-of-validation">FinanceChainge - $710k - Lack of Validation<a href="#financechainge---710k---lack-of-validation" class="hash-link" aria-label="Direct link to FinanceChainge - $710k - Lack of Validation" title="Direct link to FinanceChainge - $710k - Lack of Validation">​</a></h3><p>FinanceChainge is a DeFi protocol, which is known as a liquid cross-chain aggregator. In this attack, the hackers exploited the swap function with a malicious payload. The hack amount is ~ $710k. Interestingly, the sole victim is 0x8a4aa176007196d48d39c89402d3753c39ae64c1, which is linked to the project team and hence likely funds belonging to the project.</p><p><strong>Root cause</strong>: The swap() function had a bug which allowed hackers to exploit users’ allowance given to this victim contract.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0xd348b5fc00b26fc1457b70d02f9cb5e5a66a564cc4eba2136a473866a47dac08" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://bscscan.com/tx/0x051276afa96f2a2bd2ac224339793d82f6076f76ffa8d1b9e6febd49a4ec11b2" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-8050db9e770d0b9bc69fc9e2b8fdc6b8.png" width="960" height="1182" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="openleverage---226k---internal-accounting">OpenLeverage - $226k - Internal accounting<a href="#openleverage---226k---internal-accounting" class="hash-link" aria-label="Direct link to OpenLeverage - $226k - Internal accounting" title="Direct link to OpenLeverage - $226k - Internal accounting">​</a></h3><p>OpenLeverage is a DeFi protocol which operates as a DEX, allowing users to swap tokens. In this rather complicated attack, the attacker was able to compromise the OpenLev contract on BSC. The exploit consisted of a sequence of arbitrary external calls, taking advantage of inconsistency in the accounting for borrowers.</p><p><strong>Root cause</strong>: The attack occurred due to a discrepancy in the accounting process, which comprised two separate transactions. </p><p>Firstly, the attacker set up a &quot;margin position&quot; in the OpenLevV1 contract using the marginTrade function. This function call permitted an additional position creation with minimal collateral through an untrusted external call to the OpBorrowing contract. This position was ultimately liquidated. </p><p>However, both OpenLevV1 and OpBorrowing contracts use the LToken contract for their transactions. Consequently, the debt of the margin position was unintentionally cleared in the liquidation process. </p><p>In the second transaction, the attacker exploited this situation. They used the payoffTrade function, bypassing the health check, and drained all the collateral from the margin positions.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0xf08b6d36dc6f650c030344b6307ae94528f77a01db11d1284ed966e7e44337d3" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://bscscan.com/tx/0x0434bf08a63d70b84fad033d38d8b645498016b3931af4d13f6c11e86848876b" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-ceac19bc84d78f73b52ec8694e1ef8c1.png" width="1302" height="734" class="img_ev3q">
<img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-2a96f75182efb00fbd548a43bb174d6f.png" width="1302" height="820" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ngfs---190k---lack-of-validation">NGFS - $190k - Lack of Validation<a href="#ngfs---190k---lack-of-validation" class="hash-link" aria-label="Direct link to NGFS - $190k - Lack of Validation" title="Direct link to NGFS - $190k - Lack of Validation">​</a></h3><p>NGFS is a DeFi token on BSC. In this attack, the attacker was able to manipulate his own token balance due to a lack of validation for a privileged function. As such, he could simply increase his balance and dump the tokens on the open market.</p><p><strong>Root cause</strong>: The function delegateCallReserves() can be called only once, and is supposed to be set up during the initialization phase, however it was left untouched. As such, anyone could assume _uniswapV2Proxy position and then call the setProxySync() method to set an arbitrary _uniswapV2Library. Lastly, within the reserveMultiSync() function, the attacker could set a large balance for himself since he has _uniswapV2Library privilege.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x8ff764dde572928c353716358e271638fa05af54be69f043df72ad9ad054de25" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-3c256dc651a0b813d3338eddf738c0e7.png" width="1260" height="1010" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="atm---180k---price-manipulation">ATM - $180k - Price Manipulation<a href="#atm---180k---price-manipulation" class="hash-link" aria-label="Direct link to ATM - $180k - Price Manipulation" title="Direct link to ATM - $180k - Price Manipulation">​</a></h3><p>ATM is a DeFi token on BSC. In this attack, the attacker was able to make use of the funds in the ATM contract to add liquidity to the pool. At the same time, he could invoke the skim function to drain excess funds from the pair.</p><p><strong>Root cause</strong>: The _transfer routine can be exploited by directly transferring funds to the pair contract. This triggers the distributeCurrency function, adding liquidity from the perspective of the ATM contract. The attacker could then profit by simply calling skim on the pair.</p><p><strong>Onchain information</strong>:</p><p><a href="https://bscscan.com/tx/0x458ea2d7e6c5953b0d927aabc1c6a144df276d6ffa55b236087763396ee57067" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://bscscan.com/tx/0xee10553c26742bec9a4761fd717642d19012bab1704cbced048425070ee21a8a" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p>Code snippet:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-d3a3ebc82aa15b51bf05481314118f56.png" width="1112" height="1158" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>Input validation is a crucial process - it&#x27;s essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:</p><ul><li><p><strong>Calldata Parameters:</strong> Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.</p></li><li><p><strong>User Approvals:</strong> During the process where the protocol contract manages users&#x27; approvals, meticulous input checks are paramount to prevent potential malicious activities.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Upgrading proxy code should be taken very seriously and should require several checks such as:</p><ul><li><p><strong>Thorough Testing</strong>: Conduct rigorous testing before deploying any updates to ensure that the changes will not disrupt existing functionalities or introduce new vulnerabilities.</p></li><li><p><strong>Code Audits</strong>: Always get your code audited by a third party. It&#x27;s crucial to have another set of eyes inspect your code, as they may spot issues that you&#x27;ve overlooked.</p></li><li><p><strong>Pause Functionality</strong>: Make sure that your contract has a &#x27;pause&#x27; functionality. In case something goes wrong, this function allows halting the operations until the issue is fixed.</p></li></ul></li><li><p>Addressing internal accounting errors and effectively handling external arbitrary calls are critical for crypto developers, especially for lending projects which involve complex financial transactions. Here are some recommendations:</p><ul><li><p><strong>Sequencing Transactions</strong>: Consider sequencing transactions appropriately. Generally, it&#x27;s safer to make state changes before conducting external calls.</p></li><li><p><strong>External Calls</strong>: Be extremely careful while interacting with third-party contracts. They should be treated as potentially malicious. Avoid state changes after making a call to an external contract.</p></li><li><p><strong>Precise Accounting</strong>: Keep accurate and precise accounting to make sure all balances tally at the end of each operation. This is primarily to ensure that no tokens are lost or mistakenly created during transactions.</p></li><li><p><strong>Debt and Collateral Management</strong>: Carefully track and manage computational handling of debt and collateral. Errors in management or calculation can lead to vulnerabilities such as unforeseen liquidations or insolvency.</p></li><li><p><strong>Limit Permissions</strong>: Limit the permissions of the contract that makes external calls to only what&#x27;s necessary to reduce your contract&#x27;s attack surface.</p></li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/apr">Apr</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Introduction"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/hashdit/blog/monthly-incident-sharing-mar-2024">Monthly Incident Sharing - March 2024</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-04-09T00:00:00.000Z" itemprop="datePublished">April 9, 2024</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/slim115.png" alt="Sebastian Lim" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/slim115" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sebastian Lim</span></a></div><small class="avatar__subtitle" itemprop="description">SCS@HashDit</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this Mar 2024 edition, the total losses mounted up to $146 million, showing a 50% decrease compared to March 2023. </p><p>Of which, they are split across 2 sections: DApps ($114m) and Phishing ($32m).</p><p>In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="top-5-dapps-incidents">Top 5 DApps incidents<a href="#top-5-dapps-incidents" class="hash-link" aria-label="Direct link to Top 5 DApps incidents" title="Direct link to Top 5 DApps incidents">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="munchables---625m---insider-attack">Munchables - $62.5m - Insider Attack<a href="#munchables---625m---insider-attack" class="hash-link" aria-label="Direct link to Munchables - $62.5m - Insider Attack" title="Direct link to Munchables - $62.5m - Insider Attack">​</a></h3><p>Munchables is a GameFi and NFT protocol. In this attack, it was confirmed to be an Insider Attack where a rogue employee was malicious, gaining access to a privileged account. After malicious logic was introduced in a proxy contract upgrade, 62M funds were transferred out by the attacker. Thankfully, after some negotiation and investigation, the funds were eventually returned.</p><p><strong>Root cause</strong>: Malicious developer was hired and suspected to be linked to DPRK, and had bad intentions right from the start. It was found that the malicious logic was already introduced during deployment and the bad actor used manual manipulation of the getLocked storage slot to assign himself an enormous Ether balance in the contract, so that his locked amount would bypass the withdrawal checks.</p><p><strong>Onchain information</strong>:</p><p><a href="https://blastscan.io/tx/0x9a7e4d16ed15b0367b8ad677eaf1db6a2a54663610696d69e1b4aa1a08f55c95" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><a href="https://blastscan.io/tx/0xea1d9c0d8de4280b538b6fe6dbc3636602075184651dfeb837cb03f8a19ffc4f" target="_blank" rel="noopener noreferrer">Malicious contract upgrade</a></p><p><strong>Code snippet</strong>:</p><p>Unverified contract</p><p><img loading="lazy" alt="IMG-1" src="/hashdit/assets/images/1-21ba244362c94bac7527ea374c136625.png" width="2472" height="1166" class="img_ev3q">
<img loading="lazy" alt="IMG-2" src="/hashdit/assets/images/2-e496156fb5b1ac071ec742d2a03f1ff2.png" width="1548" height="1480" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prismafi---12m---lack-of-validation">PrismaFi - $12m - Lack of Validation<a href="#prismafi---12m---lack-of-validation" class="hash-link" aria-label="Direct link to PrismaFi - $12m - Lack of Validation" title="Direct link to PrismaFi - $12m - Lack of Validation">​</a></h3><p>PrismaFi is a DeFi protocol, which is known as a non-custodial and decentralized Ethereum LST &amp; LRT backed stablecoins. In this attack, the hackers bypassed the migrate function and called the flash loan directly with carefully crafted input data.</p><p>The flash loan&#x27;s callback function, onFlashloan(), was called. The lack of proper checks allowed the hackers to close a trove owner&#x27;s Trove and immediately reopen it within the same TroveManager. The transaction caused the owner&#x27;s position to be closed and reopened, resulting in the trove owner having a new position with the same debt but less collateral and the difference in collateral sitting in the zap contract.</p><p>The hackers then opened a new Trove and used the MigrateTroveZap contract to migrate it, effectively using the remaining collateral for their own Trove.
Finally, the hackers closed their Trove and took the profits.</p><p><strong>Root cause</strong>: The root cause of the vulnerability was twofold:</p><ol><li>By directly calling the onFlashloan() function, the user could manipulate other trove managers positions.</li><li>The contract allowed for a mismatch between the collateral in the initial position and the collateral in the new position, with the difference being susceptible to being taken.</li></ol><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0x00c503b595946bccaea3d58025b5f9b3726177bbdc9674e634244135282116c7" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://etherscan.io/tx/0xce3cdc7c29eb7dfc565f5d99034789e80c1cd3278adafa26af6f3d21c8412c59" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p><a href="https://etherscan.io/tx/0x0e38dd693ddbc2f62282932f36a4b8de75f8ea1da530532af26698b4eda9a110" target="_blank" rel="noopener noreferrer">Hack tx 3</a></p><p><strong>Code snippet</strong>:</p><p><img loading="lazy" alt="IMG-3" src="/hashdit/assets/images/3-cbabf4825b46c1c9e8c20b58a1f94190.png" width="2434" height="1276" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="woofi---87m---price-manipulation">WooFi - $8.7m - Price Manipulation<a href="#woofi---87m---price-manipulation" class="hash-link" aria-label="Direct link to WooFi - $8.7m - Price Manipulation" title="Direct link to WooFi - $8.7m - Price Manipulation">​</a></h3><p>WooFi is a DeFi protocol which operates as a DEX, allowing users to swap tokens. In this attack, the attacker was able to compromise the WooPPV2 contract on Arbitrum. The exploit consisted of a sequence of flash loans that took advantage of low liquidity to manipulate the price of WOO in order to repay the flash loans at a cheaper price.</p><p><strong>Root cause</strong>: There were 2 configuration issues. </p><ol><li>A previously unidentified error resulted in the price being adjusted far outside of the expected range ($0.00000009) </li><li>The fallback check, normally executed against Chain Link, didn’t cover the WOO token price.</li></ol><p><strong>Onchain information</strong>:</p><p><a href="https://arbiscan.io/tx/0x40e1b8c78083fc666cb7598efcecd0ae0af313fc41441386e4db716c2808ce07" target="_blank" rel="noopener noreferrer">Hack tx 1</a></p><p><a href="https://arbiscan.io/tx/0xe80a16678b5008d5be1484ec6e9e77dc6307632030553405863ffb38c1f94266" target="_blank" rel="noopener noreferrer">Hack tx 2</a></p><p><strong>Code snippet</strong>:</p><p><img loading="lazy" alt="IMG-4" src="/hashdit/assets/images/4-9678ce02d5bf2abb832d9be16732cda9.png" width="2446" height="1288" class="img_ev3q">
<img loading="lazy" alt="IMG-5" src="/hashdit/assets/images/5-89d68fb5f280af92d3312ae8bb18efda.png" width="2500" height="1122" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sss_hq---48m---function-wrongly-implemented">SSS_HQ - $4.8m - Function wrongly implemented<a href="#sss_hq---48m---function-wrongly-implemented" class="hash-link" aria-label="Direct link to SSS_HQ - $4.8m - Function wrongly implemented" title="Direct link to SSS_HQ - $4.8m - Function wrongly implemented">​</a></h3><p>SSS_HQ or Super Sushi Samurai is a GameFi platform on Blast chain. In this attack, thankfully a White Hat was able to spot the bug before any malicious actor, where he increased his own balance by repeatedly transferring to himself. He subsequently swapped these tokens in the liquidity pool and protected the liquidity of ~$4.8m.</p><p><strong>Root cause</strong>: The tax transfer logic is wrongly implemented in the _update method of the SSS.sol code. The _balances<!-- -->[to]<!-- --> value is incremented before the _balances<!-- -->[from]<!-- --> value is updated (done within the _postCheck method), seen in the first picture. As such, the balance of the to address uses the stale value i.e original balance, seen in the second picture. This is summed with the amount variable, stored in the toBalance variable and subsequently overwriting the _balances<!-- -->[from]<!-- --> in the last statement, almost doubling the sender’s balance.</p><p><strong>Onchain information</strong>:</p><p><a href="https://blastscan.io/tx/0x62e6b906bb5aafdc57c72cd13e20a18d2de3a4a757cd2f24fde6003ce5c9f2c6" target="_blank" rel="noopener noreferrer">White-hat Hack tx</a></p><p><strong>Code snippet</strong>:</p><p><img loading="lazy" alt="IMG-6" src="/hashdit/assets/images/6-0ba50f8dd2cc93d2d34703751344e355.png" width="2450" height="1296" class="img_ev3q">
<img loading="lazy" alt="IMG-7" src="/hashdit/assets/images/7-a6035a7c2c90673517a3ee25d667449e.png" width="2482" height="580" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unizen---21m---lack-of-validation">Unizen - $2.1m - Lack of Validation<a href="#unizen---21m---lack-of-validation" class="hash-link" aria-label="Direct link to Unizen - $2.1m - Lack of Validation" title="Direct link to Unizen - $2.1m - Lack of Validation">​</a></h3><p>Unizen is a DeFi protocol which operates as a DEX across multiple chains. In this instance, the attack happened on Ethereum, just 5 hours after the victim proxy was upgraded to a vulnerable logic contract. The vulnerable contract introduced a function 0x1ef29a02 which allowed arbitrary calldata to be sent. </p><p><strong>Root cause</strong>: Lack of validation in a Swap related function (which allowed arbitrary transferFrom calls, specifying the From, To and Amount parameters). As such, victims that have approved their funds to this contract will be affected.</p><p><strong>Onchain information</strong>:</p><p><a href="https://etherscan.io/tx/0xc12a4155c2c90707138e4aef8883c8f724371145823e2f661f19b93e5b3a9d6e" target="_blank" rel="noopener noreferrer">Hack tx</a></p><p><strong>Code snippet</strong>:
Unverified contract</p><p><img loading="lazy" alt="IMG-8" src="/hashdit/assets/images/8-931334844f2e49da8fee7bc0e18989e6.png" width="2066" height="164" class="img_ev3q">
<img loading="lazy" alt="IMG-9" src="/hashdit/assets/images/9-15da38e5b70cc0081ac666cdf6c3c690.png" width="576" height="146" class="img_ev3q">
<img loading="lazy" alt="IMG-10" src="/hashdit/assets/images/10-8bca9882db94438e55423645b10e359f.png" width="2764" height="212" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-for-developers">Key lessons for developers<a href="#key-lessons-for-developers" class="hash-link" aria-label="Direct link to Key lessons for developers" title="Direct link to Key lessons for developers">​</a></h2><ol><li><p>In light of potential insider compromises, it&#x27;s crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:</p><ul><li><p><strong>Preference for certain platforms:</strong> Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.</p></li><li><p><strong>Use of numbers:</strong> Both email addresses and Github usernames often contain numerical sequences. It&#x27;s suspected they use this as a method for tracking the identities they impersonate.</p></li><li><p><strong>Asian identities:</strong> There&#x27;s a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.</p></li><li><p><strong>Prominent educational background:</strong> The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.</p></li><li><p><strong>Codebase theft:</strong> While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.</p></li><li><p><strong>Multiple applications:</strong> They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.</p></li><li><p><strong>Premature expertise:</strong> They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.</p></li></ul></li><li><p>Input validation is a crucial process - it&#x27;s essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:</p><ul><li><p><strong>Calldata Parameters:</strong> Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.</p></li><li><p><strong>User Approvals:</strong> During the process where the protocol contract manages users&#x27; approvals, meticulous input checks are paramount to prevent potential malicious activities.</p></li></ul></li><li><p>To guard against price manipulation, it&#x27;s essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here&#x27;s how:</p><ul><li><p><strong>Set Boundaries:</strong> Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.</p></li><li><p><strong>Fallback Oracle:</strong> Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.</p></li></ul></li><li><p>Ensuring that the deployed function aligns with the intended objective is a critical requirement, especially for high-stakes operations such as accounting. This assurance can be achieved through:</p><ul><li><p><strong>Thorough Testing:</strong> Execute comprehensive fuzz testing and edge case analysis. This doesn&#x27;t solely ensure correct function logic, it also helps to identify potential flaws and security vulnerabilities that might otherwise be overlooked.</p></li><li><p><strong>Use Trusted Templates:</strong> Consider using trusted codebases, such as Openzeppelin, as a foundation for your code. These established libraries have been vetted extensively by the developer community, reducing the likelihood of introduction of unexpected bugs or issues.</p></li></ul></li></ol><p>Feel free to contact us at <a href="mailto:support@hashdit.io" target="_blank" rel="noopener noreferrer">support@hashdit.io</a> for any support needed! Stay safe!</p><p>*Unverified contracts screenshots courtesy of Dedaub’s decompiler!</p></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/mar">Mar</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/incidents">Incidents</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/sharing">Sharing</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/hashdit/blog/tags/2024">2024</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/hashdit/blog/page/2"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Introduction</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/hashdit/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/hashdit/docs/hashdit-api/api-access">API Documentations</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/HashDit" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/hashdit/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/hashdit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Hashdit Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/hashdit/assets/js/runtime~main.d84112fb.js"></script>
<script src="/hashdit/assets/js/main.4868fa04.js"></script>
</body>
</html>